import{a as xe}from"./chunk-ZOBY7D7V.js";import{a as V}from"./chunk-MZK3AGMY.js";import{a as he}from"./chunk-2IJB273A.js";import{a as _e}from"./chunk-TNOIS3Y3.js";import{h as D}from"./chunk-NFMIVN66.js";import{a as pe,b as ue,c as fe,d as be}from"./chunk-AICVXWQ6.js";import{a as me}from"./chunk-I3SZ5FME.js";import{a as se}from"./chunk-HYOWEGV7.js";import{a as de}from"./chunk-3HEW5RTP.js";import{b as re}from"./chunk-4366GPH2.js";import{a as le,d as ce}from"./chunk-HDKAZCIU.js";import{$b as L,Ca as E,Ea as _,Fa as m,I as y,Ka as z,La as Q,Ma as R,Na as A,Nb as J,O as x,Oa as a,P as v,Pa as h,Pb as b,Qb as M,Ra as U,Rb as K,Sb as X,Tb as Y,Ua as F,Va as k,Vb as Z,W as j,Wa as $,Wb as ee,Xa as H,Xb as ie,Ya as w,Yb as te,Zb as oe,_b as ae,ac as ne,ca as s,cb as I,da as u,eb as O,l as B,la as C,na as g,sa as f,sb as T,ta as q,ua as G,va as W,wa as t,xa as o,ya as p}from"./chunk-OWJSVT4P.js";function Pe(n,c){if(n&1&&p(0,"input-select",2),n&2){let l=m();g("data$",l.policiais$)}}function Ee(n,c){if(n&1&&p(0,"input-select",3),n&2){let l=m();g("data$",l.publicacoesTipos$)}}var N=(()=>{let c=class c{constructor(e,i,r,d,P){this.formBuilder=e,this.policiaisPublicacoesService=i,this.policiaisService=r,this.publicacoesTiposService=d,this.toastr=P,this.refresh=new j}ngOnInit(){this.form=this.formBuilder.group({id:[null],policial:[null,b.compose([b.required])],publicacao_tipo:[null,b.compose([b.required])],texto:[null,b.compose([b.required])],boletim:[null,b.compose([b.maxLength(30),b.required])]}),this.subscription=this.policiaisService.disponiveis().subscribe({next:e=>{e.forEach(i=>{i.numeral?i.nome=`${i.graduacao.abreviatura} ${i.numeral} ${i.nome_guerra}, ${i.matricula}`:i.nome=`${i.graduacao.abreviatura} ${i.nome_guerra}, ${i.matricula}`}),this.policiais$=B(e)}}),this.publicacoesTipos$=this.publicacoesTiposService.index()}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}cadastrar(){this.form.value.id?this.policiaisPublicacoesService.update(this.form.value.id,this.form.value).subscribe({next:e=>{this.toastr.success("Edi\xE7\xE3o realizada com sucesso!"),this.form.reset(),this.refresh.emit()},error:e=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}):this.policiaisPublicacoesService.create(this.form.value).subscribe({next:e=>{this.toastr.success("Cadastro realizado com sucesso!"),this.form.reset(),this.refresh.emit()},error:e=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}})}editar(e){this.form.patchValue(e),this.form.get("policial")?.patchValue(e.policial.id),this.form.get("publicacao_tipo")?.patchValue(e.publicacao_tipo.id)}};c.\u0275fac=function(i){return new(i||c)(u(ae),u(V),u(he),u(xe),u(D))},c.\u0275cmp=y({type:c,selectors:[["app-policiais-publicacoes-form"]],outputs:{refresh:"refresh"},standalone:!0,features:[w],decls:12,vars:4,consts:[[3,"formGroup"],[1,"row"],["label","Policial","id","policial","formControlName","policial",1,"col-sm-4",3,"data$"],["label","Tipo","id","publicacao_tipo","formControlName","publicacao_tipo",1,"col-sm-4",3,"data$"],["formControlName","boletim","label","Boletim","id","boletim","tipo","text",1,"col-sm-4"],[1,"row",2,"height","350px"],["formControlName","texto","label","Texto","id","texto",1,"col-sm-12"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click","disabled"]],template:function(i,r){i&1&&(t(0,"form",0)(1,"div",1),C(2,Pe,1,1,"input-select",2)(3,Ee,1,1,"input-select",3),p(4,"input-text",4),o(),t(5,"div",5),p(6,"input-textarea",6),o(),t(7,"div",7)(8,"a",8),_("click",function(){return r.form.reset()}),a(9,"Cancelar"),o(),t(10,"button",9),_("click",function(){return r.cadastrar()}),a(11,"Cadastrar"),o()()()),i&2&&(g("formGroup",r.form),s(2),f(2,r.policiais$?2:-1),s(),f(3,r.publicacoesTipos$?3:-1),s(7),g("disabled",r.form.invalid))},dependencies:[T,L,Y,M,K,ne,Z,ee,se,me,_e]});let n=c;return n})();function ye(n,c){n&1&&(t(0,"button",7),p(1,"i",39),o())}function we(n,c){if(n&1&&(a(0),I(1,"mask")),n&2){let l=m().$implicit;h(O(1,1,l.policial.numeral,"00.000"))}}function Te(n,c){if(n&1){let l=E();t(0,"a",43),_("click",function(){x(l);let i=m().$implicit,r=m(2);return v(r.editar(i))}),p(1,"i",44),o()}}function Me(n,c){if(n&1){let l=E();t(0,"a",45),_("click",function(){x(l);let i=m().$implicit,r=m(2);return v(r.delete(i))}),p(1,"i",46),o()}}function Le(n,c){if(n&1&&(t(0,"tr",40)(1,"td"),a(2),o(),t(3,"td"),a(4),o(),t(5,"td"),a(6),o(),t(7,"td"),C(8,we,2,4),o(),t(9,"td"),a(10),o(),t(11,"td"),a(12),I(13,"mask"),o(),t(14,"td"),a(15),o(),t(16,"td"),a(17),o(),t(18,"td"),C(19,Te,2,0,"a",41)(20,Me,2,0,"a",42),o()()),n&2){let l=c.$implicit,e=m(2);s(2),h(l.id),s(2),U("",l.policial.setor.subunidade.abreviatura," - ",l.policial.setor.subunidade.unidade.abreviatura,""),s(2),h(l.policial.graduacao.nome),s(2),f(8,l.policial.numeral?8:-1),s(2),h(l.policial.nome_guerra),s(2),h(O(13,11,l.policial.matricula,"000.000-0-A")),s(3),h(l.publicacao_tipo.nome),s(2),h(l.boletim),s(2),f(19,e.user.perfil.policiais_publicacoes_edt?19:-1),s(),f(20,e.user.perfil.policiais_publicacoes_del?20:-1)}}function De(n,c){n&1&&(t(0,"tr")(1,"td",26),a(2,"Sem informa\xE7\xE3o"),o()())}function Ve(n,c){if(n&1&&(t(0,"tbody"),G(1,Le,21,14,"tr",40,q,!1,De,3,0,"tr"),o()),n&2){m();let l=A(21);s(),W(l.data)}}function Fe(n,c){if(n&1){let l=E();a(0," Tem certeza que deseja excluir: "),t(1,"b"),a(2),o(),t(3,"div",47)(4,"a",48),a(5,"Cancelar"),o(),t(6,"button",49),_("click",function(){x(l);let i=m();return v(i.confirm())}),a(7," Excluir "),o()()}if(n&2){let l=m();s(2),h(l.excluir.policial.nome)}}var ei=(()=>{let c=class c{constructor(e,i,r){this.policiaisPublicacoesService=e,this.toastr=i,this.sessionService=r,this.quant=10}ngOnInit(){this.user=this.sessionService.getUser(),this.sessionService.checkPermission("policiais_publicacoes"),this.subscription=this.policiaisPublicacoesService.index().subscribe({next:e=>{this.data$=e,this.temp=e}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}refresh(){this.policiaisPublicacoesService.index().subscribe({next:e=>{this.data$=e}})}editar(e){this.child.editar(e)}delete(e){this.excluir=e}confirm(){this.policiaisPublicacoesService.remove(this.excluir.id||0).subscribe({next:e=>{this.toastr.success("Exclus\xE3o realizada com sucesso!"),this.refresh()},error:e=>{this.toastr.error("Erro ao excluir, tente novamente mais tarde!")}})}pesquisar(){if(this.data$=this.temp,this.pesquisa.length>0){var e=this.pesquisa.toLocaleLowerCase();this.data$=this.data$.filter(i=>i.policial.numeral?i.policial.numeral.toLocaleLowerCase().indexOf(e)!==-1||i.policial.nome.toLocaleLowerCase().indexOf(e)!==-1||i.policial.nome_guerra.toLocaleLowerCase().indexOf(e)!==-1||i.policial.matricula.toLocaleLowerCase().indexOf(e)!==-1||i.policial.graduacao.nome.toLocaleLowerCase().indexOf(e)!==-1||i.publicacao_tipo.nome.toLocaleLowerCase().indexOf(e)!==-1||i.boletim||!e:i.policial.nome.toLocaleLowerCase().indexOf(e)!==-1||i.policial.nome_guerra.toLocaleLowerCase().indexOf(e)!==-1||i.policial.matricula.toLocaleLowerCase().indexOf(e)!==-1||i.policial.graduacao.nome.toLocaleLowerCase().indexOf(e)!==-1||i.publicacao_tipo.nome.toLocaleLowerCase().indexOf(e)!==-1||i.boletim||!e)}}};c.\u0275fac=function(i){return new(i||c)(u(V),u(D),u(re))},c.\u0275cmp=y({type:c,selectors:[["app-policiais-publicacoes"]],viewQuery:function(i,r){if(i&1&&z(N,5),i&2){let d;Q(d=R())&&(r.child=d.first)}},standalone:!0,features:[H([le()]),w],decls:78,vars:9,consts:[["mf","mfDataTable"],[1,"content-wrapper"],["titulo","Publica\xE7\xF5es"],[1,"content"],[1,"card"],[1,"card-header","border-0"],[1,"card-title"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary"],[1,"card-tools"],[1,"input-group","input-group-sm",2,"width","250px"],[1,"form-control","float-right",2,"width","50px",3,"ngModelChange","ngModel"],["value","10"],["value","25"],["value","50"],["value","100"],["type","text","name","table_search","placeholder","Pesquisar...",1,"form-control","float-right",2,"width","200px",3,"ngModelChange","ngModel"],[1,"card-body","table-responsive","p-1"],[1,"table","table-hover","table-head-fixed","text-nowrap",3,"mfData","mfRowsOnPage","mfSortBy","mfSortOrder"],["by","id"],["by","policial.setor.subunidade.abreviatura"],["by","policial.graduacao.nome"],["by","policial.numeral"],["by","policial.nome_guerra"],["by","policial.matricula"],["by","publicacao_tipo.nome"],["by","boletim"],["colspan","100%"],[2,"display","flex","align-items","center","justify-content","center"],["id","modalcad","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header","border-0"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"refresh"],["id","modaldel","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog"],[1,"fa","fa-plus"],[1,"optionshover"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-edit","text-primary"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-danger","ml-1"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-primary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"]],template:function(i,r){if(i&1){let d=E();t(0,"div",1),p(1,"app-title",2),t(2,"section",3)(3,"div",4)(4,"div",5)(5,"h3",6),C(6,ye,2,0,"button",7),o(),t(7,"div",8)(8,"div",9)(9,"select",10),$("ngModelChange",function(S){return x(d),k(r.quant,S)||(r.quant=S),v(S)}),t(10,"option",11),a(11,"10"),o(),t(12,"option",12),a(13,"25"),o(),t(14,"option",13),a(15,"50"),o(),t(16,"option",14),a(17,"100"),o()(),t(18,"input",15),$("ngModelChange",function(S){return x(d),k(r.pesquisa,S)||(r.pesquisa=S),v(S)}),_("ngModelChange",function(){return x(d),v(r.pesquisar())}),o()()()(),t(19,"div",16)(20,"table",17,0)(22,"thead")(23,"tr")(24,"th")(25,"mfDefaultSorter",18),a(26,"#"),o()(),t(27,"th")(28,"mfDefaultSorter",19),a(29,"Subunidade"),o()(),t(30,"th")(31,"mfDefaultSorter",20),a(32,"Gradua\xE7\xE3o"),o()(),t(33,"th")(34,"mfDefaultSorter",21),a(35,"Numeral"),o()(),t(36,"th")(37,"mfDefaultSorter",22),a(38,"Nome Guerra"),o()(),t(39,"th")(40,"mfDefaultSorter",23),a(41,"Matr\xEDcula"),o()(),t(42,"th")(43,"mfDefaultSorter",24),a(44,"Tipo"),o()(),t(45,"th")(46,"mfDefaultSorter",25),a(47,"Boletim"),o()(),t(48,"th"),a(49,"Op\xE7\xF5es"),o()()(),C(50,Ve,4,1,"tbody"),t(51,"tfoot")(52,"tr")(53,"td",26)(54,"div",27),p(55,"mfBootstrapPaginator"),o()()()()()()()(),t(56,"div",28)(57,"div",29)(58,"div",30)(59,"div",31)(60,"h4",32),a(61,"Cadastrar"),o(),t(62,"button",33)(63,"span",34),a(64,"\xD7"),o()()(),t(65,"div",35)(66,"app-policiais-publicacoes-form",36),_("refresh",function(){return x(d),v(r.refresh())}),o()()()()(),t(67,"div",37)(68,"div",38)(69,"div",30)(70,"div",31)(71,"h4",32),a(72,"Excluir"),o(),t(73,"button",33)(74,"span",34),a(75,"\xD7"),o()()(),t(76,"div",35),C(77,Fe,8,1),o()()()()()}i&2&&(s(6),f(6,r.user.perfil.policiais_publicacoes_cad?6:-1),s(3),F("ngModel",r.quant),s(9),F("ngModel",r.pesquisa),s(2),g("mfData",r.data$)("mfRowsOnPage",r.quant)("mfSortBy","id")("mfSortOrder","desc"),s(30),f(50,r.data$?50:-1),s(27),f(77,r.excluir?77:-1))},dependencies:[T,de,N,be,pe,fe,ue,L,te,oe,J,ie,M,X,ce]});let n=c;return n})();export{ei as PoliciaisPublicacoesComponent};
