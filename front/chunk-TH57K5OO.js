import{a as ye}from"./chunk-S3XXDZC3.js";import{a as N}from"./chunk-3O7W2CGL.js";import{a as Ee}from"./chunk-GOTAZHJ7.js";import{a as ge}from"./chunk-EUAPVJTU.js";import{a as Ce}from"./chunk-HMKSEIRC.js";import{a as be}from"./chunk-JKRXANFS.js";import{a as Se}from"./chunk-P4DI7BWX.js";import{a as xe}from"./chunk-A6GCQO25.js";import{h as L}from"./chunk-NFMIVN66.js";import{a as fe,b as ve,c as _e,d as he}from"./chunk-AICVXWQ6.js";import{a as ue}from"./chunk-I3SZ5FME.js";import{a as ce}from"./chunk-HYOWEGV7.js";import{a as pe}from"./chunk-3HEW5RTP.js";import{b as I}from"./chunk-UKCOEVIY.js";import"./chunk-HDKAZCIU.js";import{$b as T,Ca as y,Ea as _,Fa as x,Fb as X,I as V,Ib as Y,Ka as W,La as z,Ma as G,Mb as Z,Na as Q,Nb as M,O as S,Oa as i,P as b,Pa as p,Pb as s,Qb as D,Ra as U,Rb as ee,Sb as te,Tb as ie,Ua as F,Ub as oe,Va as O,Vb as ae,W as R,Wa as $,Wb as ne,Xb as re,Ya as w,Yb as le,Zb as me,_a as H,_b as se,ac as de,ca as n,cb as j,da as u,eb as B,la as g,na as v,rb as J,sa as C,sb as k,ta as q,ua as A,va as K,wa as e,xa as t,ya as c}from"./chunk-OWJSVT4P.js";var P=(()=>{let d=class d{constructor(o,a,r,f,E,h,Ve,we,ke,Me){this.formBuilder=o,this.veiculosService=a,this.veiculosTiposService=r,this.coresService=f,this.unidadesService=E,this.subunidadesService=h,this.marcasService=Ve,this.modelosService=we,this.toastr=ke,this.sessionService=Me,this.refresh=new R}ngOnInit(){this.form=this.formBuilder.group({id:[null],placa:[null,s.compose([s.required,s.minLength(7),s.maxLength(7)])],placa_especial:[null,s.compose([s.minLength(7),s.maxLength(7)])],chassi:[null],renavam:[null],ano:[null,s.compose([s.min(2e3),s.max(2050),s.required])],blindado:[null],organico:["0",s.compose([s.required])],km_inicial:[null,s.compose([s.required,s.min(0)])],km_atual:[null],km_troca_oleo:[null,s.compose([s.min(0)])],km_revisao:[null,s.compose([s.min(0)])],data_revisao:[null],marca:[null,s.compose([s.required])],modelo:[null,s.compose([s.required])],cor:[null,s.compose([s.required])],veiculo_tipo:[null,s.compose([s.required])],observacoes:[null],data_baixa:[null],subunidade:[null],nao_disponivel:[null]}),this.marcas$=this.marcasService.marcasTransporte(),this.veiculostipos$=this.veiculosTiposService.index(),this.cores$=this.coresService.index()}cadastrar(){this.form.value.organico=="1"?this.form.get("organico")?.patchValue(!0):this.form.get("organico")?.patchValue(!1),this.form.value.nao_disponivel||this.form.get("nao_disponivel")?.patchValue(null),this.form.value.data_baixa||this.form.get("data_baixa")?.patchValue(null),this.form.value.data_revisao||this.form.get("data_revisao")?.patchValue(null),this.form.value.placa=this.form.value.placa.toUpperCase(),this.form.value.placa_especial&&(this.form.value.placa_especial=this.form.value.placa_especial.toUpperCase()),delete this.form.value.marca,this.form.value.id?this.veiculosService.update(this.form.value.id,this.form.value).subscribe({next:o=>{this.toastr.success("Edi\xE7\xE3o realizada com sucesso!"),this.form.reset(),this.refresh.emit()},error:o=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}):(this.sessionService.getSubunidade()?this.form.get("subunidade")?.patchValue(this.sessionService.getSubunidade()):this.toastr.error("Selecione uma subunidade!"),this.veiculosService.create(this.form.value).subscribe({next:o=>{this.toastr.success("Cadastro realizado com sucesso!"),this.form.reset(),this.refresh.emit()},error:o=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}))}editar(o){this.form.patchValue(o),o.organico?this.form.get("organico")?.patchValue("1"):this.form.get("organico")?.patchValue("0"),o.modelo&&(this.form.get("marca")?.patchValue(o.modelo.marca.id),this.form.get("modelo")?.patchValue(o.modelo.id),this.getModelos()),o.veiculo_tipo&&this.form.get("veiculo_tipo")?.patchValue(o.veiculo_tipo.id),o.cor&&this.form.get("cor")?.patchValue(o.cor.id)}getModelos(){this.modelos$=this.modelosService.whereMarca(this.form.get("marca")?.value)}};d.\u0275fac=function(a){return new(a||d)(u(se),u(N),u(ye),u(ge),u(Ee),u(Ce),u(Se),u(be),u(L),u(I))},d.\u0275cmp=V({type:d,selectors:[["app-veiculos-form"]],outputs:{refresh:"refresh"},standalone:!0,features:[w],decls:47,vars:6,consts:[[3,"formGroup"],[1,"row"],["label","Tipo de Ve\xEDculo","id","veiculo_tipo","formControlName","veiculo_tipo",1,"col-sm-2",3,"data$"],["label","Marca","id","marca","formControlName","marca",1,"col-sm-2",3,"ngModelChange","data$"],["label","Modelo","id","modelo","formControlName","modelo",1,"col-sm-2",3,"data$"],["label","Cor","id","cor","formControlName","cor",1,"col-sm-2",3,"data$"],["formControlName","ano","label","Ano","id","ano","tipo","number",1,"col-sm-2"],["formControlName","placa","label","Placa","id","placa","tipo","text","mascara","SSS0A00",1,"col-sm-2"],["formControlName","placa_especial","label","Placa Especial","id","placa_especial","tipo","text","mascara","SSS0A00",1,"col-sm-2"],["formControlName","chassi","label","Chassi","id","chassi","tipo","text",1,"col-sm-2"],["formControlName","renavam","label","Renavam","id","renavam","tipo","text",1,"col-sm-2"],["formControlName","km_inicial","label","KM Inicial","id","km_inicial","tipo","number",1,"col-sm-2"],["formControlName","km_troca_oleo","label","KM Troca \xD3leo","id","km_troca_oleo","tipo","number",1,"col-sm-2"],["formControlName","km_revisao","label","KM Revis\xE3o","id","km_revisao","tipo","number",1,"col-sm-2"],["formControlName","data_revisao","label","Data Revis\xE3o","id","data_revisao","tipo","date",1,"col-sm-2"],[1,"col-sm-2"],["for","organico"],[1,"form-check"],["type","radio","id","organico","formControlName","organico","value","1","name","organico",1,"form-check-input"],[1,"form-check-label"],["type","radio","id","organico","formControlName","organico","value","0","name","organico",1,"form-check-input"],["type","checkbox","checked","","id","blindado","formControlName","blindado",1,"form-check-input"],["for","blindado",1,"form-check-label"],["type","checkbox","checked","","id","nao_disponivel","formControlName","nao_disponivel",1,"form-check-input"],["for","nao_disponivel",1,"form-check-label"],["formControlName","data_baixa","label","Data Baixa","id","data_baixa","tipo","date",1,"col-sm-2"],[1,"row",2,"height","350px"],["formControlName","observacoes","label","Observa\xE7\xF5es","id","observacoes",1,"col-sm-12"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click","disabled"]],template:function(a,r){a&1&&(e(0,"form",0)(1,"div",1),c(2,"input-select",2),e(3,"input-select",3),_("ngModelChange",function(){return r.getModelos()}),t(),c(4,"input-select",4)(5,"input-select",5)(6,"input-text",6),t(),e(7,"div",1),c(8,"input-text",7)(9,"input-text",8)(10,"input-text",9)(11,"input-text",10)(12,"input-text",11),t(),e(13,"div",1),c(14,"input-text",12)(15,"input-text",13)(16,"input-text",14),e(17,"div",15)(18,"label",16),i(19,"Propriet\xE1rio"),t(),e(20,"div",17),c(21,"input",18),e(22,"label",19),i(23,"Org\xE2nico"),t()(),e(24,"div",17),c(25,"input",20),e(26,"label",19),i(27,"Locado"),t()()(),e(28,"div",15)(29,"div",17),c(30,"input",21),e(31,"label",22),i(32,"Blindado"),t()()(),e(33,"div",15)(34,"div",17),c(35,"input",23),e(36,"label",24),i(37,"N\xE3o Dispon\xEDvel"),t()()()(),e(38,"div",1),c(39,"input-text",25),t(),e(40,"div",26),c(41,"input-textarea",27),t(),e(42,"div",28)(43,"a",29),_("click",function(){return r.form.reset()}),i(44,"Cancelar"),t(),e(45,"button",30),_("click",function(){return r.cadastrar()}),i(46," Cadastrar "),t()()()),a&2&&(v("formGroup",r.form),n(2),v("data$",r.veiculostipos$),n(),v("data$",r.marcas$),n(),v("data$",r.modelos$),n(),v("data$",r.cores$),n(40),v("disabled",r.form.invalid))},dependencies:[k,T,ie,M,Z,oe,D,ee,de,ae,ne,ce,ue,xe]});let l=d;return l})();var Fe=l=>["/Veiculo",l];function Oe(l,d){l&1&&(e(0,"button",7),c(1,"i",47),t())}function $e(l,d){l&1&&i(0," Org\xE2nico ")}function je(l,d){l&1&&i(0," Locado ")}function Be(l,d){l&1&&c(0,"i",50)}function Pe(l,d){if(l&1){let m=y();e(0,"a",53),_("click",function(){S(m);let a=x().$implicit,r=x(2);return b(r.editar(a))}),c(1,"i",54),t()}}function Re(l,d){if(l&1){let m=y();e(0,"a",55),_("click",function(){S(m);let a=x().$implicit,r=x(2);return b(r.delete(a))}),c(1,"i",56),t()}}function qe(l,d){if(l&1&&(e(0,"tr",48)(1,"td"),i(2),t(),e(3,"td"),i(4),t(),e(5,"td"),i(6),t(),e(7,"td"),i(8),t(),e(9,"td"),i(10),t(),e(11,"td"),i(12),t(),e(13,"td"),g(14,$e,1,0)(15,je,1,0),t(),e(16,"td")(17,"a",49),i(18),t()(),e(19,"td"),i(20),t(),e(21,"td"),i(22),t(),e(23,"td"),i(24),t(),e(25,"td"),i(26),t(),e(27,"td"),i(28),t(),e(29,"td"),i(30),j(31,"date"),t(),e(32,"td"),g(33,Be,1,0,"i",50),t(),e(34,"td"),i(35),j(36,"date"),t(),e(37,"td"),g(38,Pe,2,0,"a",51)(39,Re,2,0,"a",52),t()()),l&2){let m=d.$implicit,o=x(2);n(2),p(m.id),n(2),U("",m.subunidade.abreviatura," - ",m.subunidade.unidade.abreviatura,""),n(2),p(m.veiculo_tipo.nome),n(2),p(m.modelo.marca.nome),n(2),p(m.modelo.nome),n(2),p(m.cor.nome),n(2),C(14,m.organico?14:15),n(3),v("routerLink",H(26,Fe,m.id)),n(),p(m.placa),n(2),p(m.placa_especial),n(2),p(m.km_inicial),n(2),p(m.km_atual),n(2),p(m.km_troca_oleo),n(2),p(m.km_revisao),n(2),p(B(31,20,m.data_revisao,"dd/MM/yyyy")),n(3),C(33,m.nao_disponivel?33:-1),n(2),p(B(36,23,m.data_baixa,"dd/MM/yyyy")),n(3),C(38,o.user.perfil.veiculos_edt&&!m.data_baixa?38:-1),n(),C(39,o.user.perfil.veiculos_del?39:-1)}}function Ae(l,d){l&1&&(e(0,"tr")(1,"td",34),i(2,"Sem informa\xE7\xE3o"),t()())}function Ke(l,d){if(l&1&&(e(0,"tbody"),A(1,qe,40,28,"tr",48,q,!1,Ae,3,0,"tr"),t()),l&2){x();let m=Q(21);n(),K(m.data)}}function We(l,d){if(l&1){let m=y();i(0," Tem certeza que deseja excluir: "),e(1,"b"),i(2),t(),e(3,"div",57)(4,"a",58),i(5,"Cancelar"),t(),e(6,"button",59),_("click",function(){S(m);let a=x();return b(a.confirm())}),i(7," Excluir "),t()()}if(l&2){let m=x();n(2),p(m.excluir.placa)}}var vt=(()=>{let d=class d{constructor(o,a,r){this.veiculosService=o,this.toastr=a,this.sessionService=r,this.quant=10}ngOnInit(){this.user=this.sessionService.getUser(),this.sessionService.checkPermission("veiculos"),this.subscription=this.veiculosService.index().subscribe({next:o=>{this.data$=o,this.temp=o}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}refresh(){this.veiculosService.index().subscribe({next:o=>{this.data$=o}})}editar(o){this.child.editar(o)}delete(o){this.excluir=o}confirm(){this.veiculosService.remove(this.excluir.id||0).subscribe({next:o=>{this.toastr.success("Exclus\xE3o realizada com sucesso!"),this.refresh()},error:o=>{this.toastr.error("Erro ao excluir, tente novamente mais tarde!")}})}pesquisar(){if(this.data$=this.temp,this.pesquisa.length>0){var o=this.pesquisa.toLocaleLowerCase();this.data$=this.data$.filter(a=>a.placa_especial?a.placa.toLocaleLowerCase().indexOf(o)!==-1||a.placa_especial.toLocaleLowerCase().indexOf(o)!==-1||a.modelo.nome.toLocaleLowerCase().indexOf(o)!==-1||a.modelo.marca.nome.toLocaleLowerCase().indexOf(o)!==-1||a.veiculo_tipo.nome.toLocaleLowerCase().indexOf(o)!==-1||a.cor.nome.toLocaleLowerCase().indexOf(o)!==-1||!o:a.placa.toLocaleLowerCase().indexOf(o)!==-1||a.modelo.nome.toLocaleLowerCase().indexOf(o)!==-1||a.modelo.marca.nome.toLocaleLowerCase().indexOf(o)!==-1||a.veiculo_tipo.nome.toLocaleLowerCase().indexOf(o)!==-1||a.cor.nome.toLocaleLowerCase().indexOf(o)!==-1||!o)}}};d.\u0275fac=function(a){return new(a||d)(u(N),u(L),u(I))},d.\u0275cmp=V({type:d,selectors:[["app-veiculos"]],viewQuery:function(a,r){if(a&1&&W(P,5),a&2){let f;z(f=G())&&(r.child=f.first)}},standalone:!0,features:[w],decls:102,vars:9,consts:[["mf","mfDataTable"],[1,"content-wrapper"],["titulo","Ve\xEDculos"],[1,"content"],[1,"card"],[1,"card-header","border-0"],[1,"card-title"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary"],[1,"card-tools"],[1,"input-group","input-group-sm",2,"width","250px"],[1,"form-control","float-right",2,"width","50px",3,"ngModelChange","ngModel"],["value","10"],["value","25"],["value","50"],["value","100"],["type","text","name","table_search","placeholder","Pesquisar...",1,"form-control","float-right",2,"width","200px",3,"ngModelChange","ngModel"],[1,"card-body","table-responsive","p-1"],[1,"table","table-hover","table-head-fixed","text-nowrap",3,"mfData","mfRowsOnPage","mfSortBy","mfSortOrder"],["by","id"],["by","subunidade.abreviatura"],["by","veiculo.tipo"],["by","modelo.marca.nome"],["by","modelo.nome"],["by","cor?.nome"],["by","organico"],["by","placa"],["by","placa_especial"],["by","km_inicial"],["by","km_atual"],["by","km_troca_oleo"],["by","km_revisao"],["by","data_revisao"],["by","nao_disponivel"],["by","data_baixa"],["colspan","100%"],[2,"display","flex","align-items","center","justify-content","center"],["id","modalcad","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header","border-0"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"refresh"],["id","modaldel","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog"],[1,"fa","fa-plus"],[1,"optionshover"],[3,"routerLink"],["aria-hidden","true",1,"fa","fa-ban","text-danger"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-edit","text-primary"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-danger","ml-1"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-primary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"]],template:function(a,r){if(a&1){let f=y();e(0,"div",1),c(1,"app-title",2),e(2,"section",3)(3,"div",4)(4,"div",5)(5,"h3",6),g(6,Oe,2,0,"button",7),t(),e(7,"div",8)(8,"div",9)(9,"select",10),$("ngModelChange",function(h){return S(f),O(r.quant,h)||(r.quant=h),b(h)}),e(10,"option",11),i(11,"10"),t(),e(12,"option",12),i(13,"25"),t(),e(14,"option",13),i(15,"50"),t(),e(16,"option",14),i(17,"100"),t()(),e(18,"input",15),$("ngModelChange",function(h){return S(f),O(r.pesquisa,h)||(r.pesquisa=h),b(h)}),_("ngModelChange",function(){return S(f),b(r.pesquisar())}),t()()()(),e(19,"div",16)(20,"table",17,0)(22,"thead")(23,"tr")(24,"th")(25,"mfDefaultSorter",18),i(26,"#"),t()(),e(27,"th")(28,"mfDefaultSorter",19),i(29,"Subunidade"),t()(),e(30,"th")(31,"mfDefaultSorter",20),i(32,"Tipo"),t()(),e(33,"th")(34,"mfDefaultSorter",21),i(35,"Marca"),t()(),e(36,"th")(37,"mfDefaultSorter",22),i(38,"Modelo"),t()(),e(39,"th")(40,"mfDefaultSorter",23),i(41,"Cor"),t()(),e(42,"th")(43,"mfDefaultSorter",24),i(44,"Propiet\xE1rio"),t()(),e(45,"th")(46,"mfDefaultSorter",25),i(47,"Placa"),t()(),e(48,"th")(49,"mfDefaultSorter",26),i(50,"Placa Esp."),t()(),e(51,"th")(52,"mfDefaultSorter",27),i(53,"KM Inicial"),t()(),e(54,"th")(55,"mfDefaultSorter",28),i(56,"KM Atual"),t()(),e(57,"th")(58,"mfDefaultSorter",29),i(59,"KM Troca O."),t()(),e(60,"th")(61,"mfDefaultSorter",30),i(62,"KM Revis\xE3o"),t()(),e(63,"th")(64,"mfDefaultSorter",31),i(65,"Data Revis\xE3o"),t()(),e(66,"th")(67,"mfDefaultSorter",32),i(68,"\xD1 Disp."),t()(),e(69,"th")(70,"mfDefaultSorter",33),i(71,"Data Baixa"),t()(),e(72,"th"),i(73,"Op\xE7\xF5es"),t()()(),g(74,Ke,4,1,"tbody"),e(75,"tfoot")(76,"tr")(77,"td",34)(78,"div",35),c(79,"mfBootstrapPaginator"),t()()()()()()()(),e(80,"div",36)(81,"div",37)(82,"div",38)(83,"div",39)(84,"h4",40),i(85,"Cadastrar"),t(),e(86,"button",41)(87,"span",42),i(88,"\xD7"),t()()(),e(89,"div",43)(90,"app-veiculos-form",44),_("refresh",function(){return S(f),b(r.refresh())}),t()()()()(),e(91,"div",45)(92,"div",46)(93,"div",38)(94,"div",39)(95,"h4",40),i(96,"Excluir"),t(),e(97,"button",41)(98,"span",42),i(99,"\xD7"),t()()(),e(100,"div",43),g(101,We,8,1),t()()()()()}a&2&&(n(6),C(6,r.user.perfil.veiculos_cad?6:-1),n(3),F("ngModel",r.quant),n(9),F("ngModel",r.pesquisa),n(2),v("mfData",r.data$)("mfRowsOnPage",r.quant)("mfSortBy","placa")("mfSortOrder","asc"),n(54),C(74,r.data$?74:-1),n(27),C(101,r.excluir?101:-1))},dependencies:[k,J,pe,P,he,fe,_e,ve,T,le,me,M,re,D,te,Y,X]});let l=d;return l})();export{vt as VeiculosComponent};
