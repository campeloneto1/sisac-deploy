import{a as Ee}from"./chunk-S3XXDZC3.js";import{a as L}from"./chunk-3O7W2CGL.js";import{a as ge}from"./chunk-GOTAZHJ7.js";import{a as Ce}from"./chunk-EUAPVJTU.js";import{a as be}from"./chunk-HMKSEIRC.js";import{a as Se}from"./chunk-JKRXANFS.js";import{a as xe}from"./chunk-P4DI7BWX.js";import{a as he}from"./chunk-A6GCQO25.js";import{h as I}from"./chunk-NFMIVN66.js";import{a as pe,b as fe,c as ve,d as _e}from"./chunk-AICVXWQ6.js";import{a as ce}from"./chunk-I3SZ5FME.js";import{a as de}from"./chunk-HYOWEGV7.js";import{a as ue}from"./chunk-3HEW5RTP.js";import{b as D}from"./chunk-UKCOEVIY.js";import"./chunk-HDKAZCIU.js";import{$b as T,Ca as y,Ea as _,Fa as x,Fb as J,I as V,Ib as X,Ka as K,La as W,Ma as z,Mb as Y,Na as G,Nb as Z,O as S,Oa as o,P as b,Pa as p,Pb as s,Qb as M,Ra as Q,Rb as ee,Sb as te,Tb as ie,Ua as N,Va as O,Vb as oe,W as P,Wa as F,Wb as ae,Xb as ne,Ya as w,Yb as re,Zb as le,_a as U,_b as me,ac as se,ca as r,cb as $,da as c,eb as j,la as g,na as v,rb as H,sa as C,sb as k,ta as R,ua as q,va as A,wa as e,xa as t,ya as u}from"./chunk-OWJSVT4P.js";var B=(()=>{let d=class d{constructor(i,a,n,f,E,h,ye,Ve,we,ke){this.formBuilder=i,this.veiculosService=a,this.veiculosTiposService=n,this.coresService=f,this.unidadesService=E,this.subunidadesService=h,this.marcasService=ye,this.modelosService=Ve,this.toastr=we,this.sessionService=ke,this.refresh=new P}ngOnInit(){this.form=this.formBuilder.group({id:[null],placa:[null,s.compose([s.required,s.minLength(7),s.maxLength(7)])],placa_especial:[null,s.compose([s.minLength(7),s.maxLength(7)])],chassi:[null],renavam:[null],ano:[null,s.compose([s.min(2e3),s.max(2050),s.required])],blindado:[null],organico:[null],km_inicial:[null,s.compose([s.required,s.min(0)])],km_atual:[null],km_troca_oleo:[null,s.compose([s.min(0)])],km_revisao:[null,s.compose([s.min(0)])],data_revisao:[null],marca:[null,s.compose([s.required])],modelo:[null,s.compose([s.required])],cor:[null,s.compose([s.required])],veiculo_tipo:[null,s.compose([s.required])],observacoes:[null],data_baixa:[null],subunidade:[null]}),this.marcas$=this.marcasService.marcasTransporte(),this.veiculostipos$=this.veiculosTiposService.index(),this.cores$=this.coresService.index()}cadastrar(){this.form.value.data_baixa||this.form.get("data_baixa")?.patchValue(null),this.form.value.data_revisao||this.form.get("data_revisao")?.patchValue(null),this.form.value.placa=this.form.value.placa.toUpperCase(),this.form.value.placa_especial&&(this.form.value.placa_especial=this.form.value.placa_especial.toUpperCase()),delete this.form.value.marca,this.form.value.id?this.veiculosService.update(this.form.value.id,this.form.value).subscribe({next:i=>{this.toastr.success("Edi\xE7\xE3o realizada com sucesso!"),this.form.reset(),this.refresh.emit()},error:i=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}):(this.sessionService.getSubunidade()?this.form.get("subunidade")?.patchValue(this.sessionService.getSubunidade()):this.toastr.error("Selecione uma subunidade!"),this.veiculosService.create(this.form.value).subscribe({next:i=>{this.toastr.success("Cadastro realizado com sucesso!"),this.form.reset(),this.refresh.emit()},error:i=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}))}editar(i){this.form.patchValue(i),i.modelo&&(this.form.get("marca")?.patchValue(i.modelo.marca.id),this.form.get("modelo")?.patchValue(i.modelo.id),this.getModelos()),i.veiculo_tipo&&this.form.get("veiculo_tipo")?.patchValue(i.veiculo_tipo.id),i.cor&&this.form.get("cor")?.patchValue(i.cor.id)}getModelos(){this.modelos$=this.modelosService.whereMarca(this.form.get("marca")?.value)}};d.\u0275fac=function(a){return new(a||d)(c(me),c(L),c(Ee),c(Ce),c(ge),c(be),c(xe),c(Se),c(I),c(D))},d.\u0275cmp=V({type:d,selectors:[["app-veiculos-form"]],outputs:{refresh:"refresh"},standalone:!0,features:[w],decls:36,vars:6,consts:[[3,"formGroup"],[1,"row"],["label","Tipo de Ve\xEDculo","id","veiculo_tipo","formControlName","veiculo_tipo",1,"col-sm-2",3,"data$"],["label","Marca","id","marca","formControlName","marca",1,"col-sm-2",3,"ngModelChange","data$"],["label","Modelo","id","modelo","formControlName","modelo",1,"col-sm-2",3,"data$"],["label","Cor","id","cor","formControlName","cor",1,"col-sm-2",3,"data$"],["formControlName","ano","label","Ano","id","ano","tipo","number",1,"col-sm-2"],["formControlName","placa","label","Placa","id","placa","tipo","text","mascara","SSS0A00",1,"col-sm-2"],["formControlName","placa_especial","label","Placa Especial","id","placa_especial","tipo","text","mascara","SSS0A00",1,"col-sm-2"],["formControlName","chassi","label","Chassi","id","chassi","tipo","text",1,"col-sm-2"],["formControlName","renavam","label","Renavam","id","renavam","tipo","text",1,"col-sm-2"],["formControlName","km_inicial","label","KM Inicial","id","km_inicial","tipo","number",1,"col-sm-2"],["formControlName","km_troca_oleo","label","KM Troca \xD3leo","id","km_troca_oleo","tipo","number",1,"col-sm-2"],["formControlName","km_revisao","label","KM Revis\xE3o","id","km_revisao","tipo","number",1,"col-sm-2"],["formControlName","data_revisao","label","Data Revis\xE3o","id","data_revisao","tipo","date",1,"col-sm-2"],[1,"col-sm-2"],[1,"form-check"],["type","checkbox","checked","","id","organico","formControlName","organico",1,"form-check-input"],["for","organico",1,"form-check-label"],["type","checkbox","checked","","id","blindado","formControlName","blindado",1,"form-check-input"],["for","blindado",1,"form-check-label"],["formControlName","data_baixa","label","Data Baixa","id","data_baixa","tipo","date",1,"col-sm-2"],[1,"row",2,"height","350px"],["formControlName","observacoes","label","Observa\xE7\xF5es","id","observacoes",1,"col-sm-12"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click","disabled"]],template:function(a,n){a&1&&(e(0,"form",0)(1,"div",1),u(2,"input-select",2),e(3,"input-select",3),_("ngModelChange",function(){return n.getModelos()}),t(),u(4,"input-select",4)(5,"input-select",5)(6,"input-text",6),t(),e(7,"div",1),u(8,"input-text",7)(9,"input-text",8)(10,"input-text",9)(11,"input-text",10)(12,"input-text",11),t(),e(13,"div",1),u(14,"input-text",12)(15,"input-text",13)(16,"input-text",14),e(17,"div",15)(18,"div",16),u(19,"input",17),e(20,"label",18),o(21,"Org\xE2nico"),t()()(),e(22,"div",15)(23,"div",16),u(24,"input",19),e(25,"label",20),o(26,"Blindado"),t()()()(),e(27,"div",1),u(28,"input-text",21),t(),e(29,"div",22),u(30,"input-textarea",23),t(),e(31,"div",24)(32,"a",25),_("click",function(){return n.form.reset()}),o(33,"Cancelar"),t(),e(34,"button",26),_("click",function(){return n.cadastrar()}),o(35," Cadastrar "),t()()()),a&2&&(v("formGroup",n.form),r(2),v("data$",n.veiculostipos$),r(),v("data$",n.marcas$),r(),v("data$",n.modelos$),r(),v("data$",n.cores$),r(29),v("disabled",n.form.invalid))},dependencies:[k,T,ie,Y,M,ee,se,oe,ae,de,ce,he]});let l=d;return l})();var Ne=l=>["/Veiculo",l];function Oe(l,d){l&1&&(e(0,"button",7),u(1,"i",46),t())}function Fe(l,d){l&1&&o(0," Org\xE2nico ")}function $e(l,d){l&1&&o(0," Locado ")}function je(l,d){if(l&1){let m=y();e(0,"a",51),_("click",function(){S(m);let a=x().$implicit,n=x(2);return b(n.editar(a))}),u(1,"i",52),t()}}function Be(l,d){if(l&1){let m=y();e(0,"a",53),_("click",function(){S(m);let a=x().$implicit,n=x(2);return b(n.delete(a))}),u(1,"i",54),t()}}function Pe(l,d){if(l&1&&(e(0,"tr",47)(1,"td"),o(2),t(),e(3,"td"),o(4),t(),e(5,"td"),o(6),t(),e(7,"td"),o(8),t(),e(9,"td"),o(10),t(),e(11,"td"),o(12),t(),e(13,"td"),g(14,Fe,1,0)(15,$e,1,0),t(),e(16,"td")(17,"a",48),o(18),t()(),e(19,"td"),o(20),t(),e(21,"td"),o(22),t(),e(23,"td"),o(24),t(),e(25,"td"),o(26),t(),e(27,"td"),o(28),t(),e(29,"td"),o(30),$(31,"date"),t(),e(32,"td"),o(33),$(34,"date"),t(),e(35,"td"),g(36,je,2,0,"a",49)(37,Be,2,0,"a",50),t()()),l&2){let m=d.$implicit,i=x(2);r(2),p(m.id),r(2),Q("",m.subunidade.abreviatura," - ",m.subunidade.unidade.abreviatura,""),r(2),p(m.veiculo_tipo.nome),r(2),p(m.modelo.marca.nome),r(2),p(m.modelo.nome),r(2),p(m.cor.nome),r(2),C(14,m.organico?14:15),r(3),v("routerLink",U(25,Ne,m.id)),r(),p(m.placa),r(2),p(m.placa_especial),r(2),p(m.km_inicial),r(2),p(m.km_atual),r(2),p(m.km_troca_oleo),r(2),p(m.km_revisao),r(2),p(j(31,19,m.data_revisao,"dd/MM/yyyy")),r(3),p(j(34,22,m.data_baixa,"dd/MM/yyyy")),r(3),C(36,i.user.perfil.veiculos_edt&&!m.data_baixa?36:-1),r(),C(37,i.user.perfil.veiculos_del?37:-1)}}function Re(l,d){l&1&&(e(0,"tr")(1,"td",33),o(2,"Sem informa\xE7\xE3o"),t()())}function qe(l,d){if(l&1&&(e(0,"tbody"),q(1,Pe,38,27,"tr",47,R,!1,Re,3,0,"tr"),t()),l&2){x();let m=G(21);r(),A(m.data)}}function Ae(l,d){if(l&1){let m=y();o(0," Tem certeza que deseja excluir: "),e(1,"b"),o(2),t(),e(3,"div",55)(4,"a",56),o(5,"Cancelar"),t(),e(6,"button",57),_("click",function(){S(m);let a=x();return b(a.confirm())}),o(7," Excluir "),t()()}if(l&2){let m=x();r(2),p(m.excluir.placa)}}var pt=(()=>{let d=class d{constructor(i,a,n){this.veiculosService=i,this.toastr=a,this.sessionService=n,this.quant=10}ngOnInit(){this.user=this.sessionService.getUser(),this.sessionService.checkPermission("veiculos"),this.subscription=this.veiculosService.index().subscribe({next:i=>{this.data$=i,this.temp=i}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}refresh(){this.veiculosService.index().subscribe({next:i=>{this.data$=i}})}editar(i){this.child.editar(i)}delete(i){this.excluir=i}confirm(){this.veiculosService.remove(this.excluir.id||0).subscribe({next:i=>{this.toastr.success("Exclus\xE3o realizada com sucesso!"),this.refresh()},error:i=>{this.toastr.error("Erro ao excluir, tente novamente mais tarde!")}})}pesquisar(){if(this.data$=this.temp,this.pesquisa.length>0){var i=this.pesquisa.toLocaleLowerCase();this.data$=this.data$.filter(a=>a.placa_especial?a.placa.toLocaleLowerCase().indexOf(i)!==-1||a.placa_especial.toLocaleLowerCase().indexOf(i)!==-1||a.modelo.nome.toLocaleLowerCase().indexOf(i)!==-1||a.modelo.marca.nome.toLocaleLowerCase().indexOf(i)!==-1||a.veiculo_tipo.nome.toLocaleLowerCase().indexOf(i)!==-1||a.cor.nome.toLocaleLowerCase().indexOf(i)!==-1||!i:a.placa.toLocaleLowerCase().indexOf(i)!==-1||a.modelo.nome.toLocaleLowerCase().indexOf(i)!==-1||a.modelo.marca.nome.toLocaleLowerCase().indexOf(i)!==-1||a.veiculo_tipo.nome.toLocaleLowerCase().indexOf(i)!==-1||a.cor.nome.toLocaleLowerCase().indexOf(i)!==-1||!i)}}};d.\u0275fac=function(a){return new(a||d)(c(L),c(I),c(D))},d.\u0275cmp=V({type:d,selectors:[["app-veiculos"]],viewQuery:function(a,n){if(a&1&&K(B,5),a&2){let f;W(f=z())&&(n.child=f.first)}},standalone:!0,features:[w],decls:99,vars:9,consts:[["mf","mfDataTable"],[1,"content-wrapper"],["titulo","Ve\xEDculos"],[1,"content"],[1,"card"],[1,"card-header","border-0"],[1,"card-title"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary"],[1,"card-tools"],[1,"input-group","input-group-sm",2,"width","250px"],[1,"form-control","float-right",2,"width","50px",3,"ngModelChange","ngModel"],["value","10"],["value","25"],["value","50"],["value","100"],["type","text","name","table_search","placeholder","Pesquisar...",1,"form-control","float-right",2,"width","200px",3,"ngModelChange","ngModel"],[1,"card-body","table-responsive","p-1"],[1,"table","table-hover","table-head-fixed","text-nowrap",3,"mfData","mfRowsOnPage","mfSortBy","mfSortOrder"],["by","id"],["by","subunidade.abreviatura"],["by","veiculo.tipo"],["by","modelo.marca.nome"],["by","modelo.nome"],["by","cor?.nome"],["by","organico"],["by","placa"],["by","placa_especial"],["by","km_inicial"],["by","km_atual"],["by","km_troca_oleo"],["by","km_revisao"],["by","data_revisao"],["by","data_baixa"],["colspan","100%"],[2,"display","flex","align-items","center","justify-content","center"],["id","modalcad","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header","border-0"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"refresh"],["id","modaldel","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog"],[1,"fa","fa-plus"],[1,"optionshover"],[3,"routerLink"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-edit","text-primary"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-danger","ml-1"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-primary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"]],template:function(a,n){if(a&1){let f=y();e(0,"div",1),u(1,"app-title",2),e(2,"section",3)(3,"div",4)(4,"div",5)(5,"h3",6),g(6,Oe,2,0,"button",7),t(),e(7,"div",8)(8,"div",9)(9,"select",10),F("ngModelChange",function(h){return S(f),O(n.quant,h)||(n.quant=h),b(h)}),e(10,"option",11),o(11,"10"),t(),e(12,"option",12),o(13,"25"),t(),e(14,"option",13),o(15,"50"),t(),e(16,"option",14),o(17,"100"),t()(),e(18,"input",15),F("ngModelChange",function(h){return S(f),O(n.pesquisa,h)||(n.pesquisa=h),b(h)}),_("ngModelChange",function(){return S(f),b(n.pesquisar())}),t()()()(),e(19,"div",16)(20,"table",17,0)(22,"thead")(23,"tr")(24,"th")(25,"mfDefaultSorter",18),o(26,"#"),t()(),e(27,"th")(28,"mfDefaultSorter",19),o(29,"Subunidade"),t()(),e(30,"th")(31,"mfDefaultSorter",20),o(32,"Tipo"),t()(),e(33,"th")(34,"mfDefaultSorter",21),o(35,"Marca"),t()(),e(36,"th")(37,"mfDefaultSorter",22),o(38,"Modelo"),t()(),e(39,"th")(40,"mfDefaultSorter",23),o(41,"Cor"),t()(),e(42,"th")(43,"mfDefaultSorter",24),o(44,"Propiet\xE1rio"),t()(),e(45,"th")(46,"mfDefaultSorter",25),o(47,"Placa"),t()(),e(48,"th")(49,"mfDefaultSorter",26),o(50,"Placa Esp."),t()(),e(51,"th")(52,"mfDefaultSorter",27),o(53,"KM Inicial"),t()(),e(54,"th")(55,"mfDefaultSorter",28),o(56,"KM Atual"),t()(),e(57,"th")(58,"mfDefaultSorter",29),o(59,"KM Troca O."),t()(),e(60,"th")(61,"mfDefaultSorter",30),o(62,"KM Revis\xE3o"),t()(),e(63,"th")(64,"mfDefaultSorter",31),o(65,"Data Revis\xE3o"),t()(),e(66,"th")(67,"mfDefaultSorter",32),o(68,"Data Baixa"),t()(),e(69,"th"),o(70,"Op\xE7\xF5es"),t()()(),g(71,qe,4,1,"tbody"),e(72,"tfoot")(73,"tr")(74,"td",33)(75,"div",34),u(76,"mfBootstrapPaginator"),t()()()()()()()(),e(77,"div",35)(78,"div",36)(79,"div",37)(80,"div",38)(81,"h4",39),o(82,"Cadastrar"),t(),e(83,"button",40)(84,"span",41),o(85,"\xD7"),t()()(),e(86,"div",42)(87,"app-veiculos-form",43),_("refresh",function(){return S(f),b(n.refresh())}),t()()()()(),e(88,"div",44)(89,"div",45)(90,"div",37)(91,"div",38)(92,"h4",39),o(93,"Excluir"),t(),e(94,"button",40)(95,"span",41),o(96,"\xD7"),t()()(),e(97,"div",42),g(98,Ae,8,1),t()()()()()}a&2&&(r(6),C(6,n.user.perfil.veiculos_cad?6:-1),r(3),N("ngModel",n.quant),r(9),N("ngModel",n.pesquisa),r(2),v("mfData",n.data$)("mfRowsOnPage",n.quant)("mfSortBy","placa")("mfSortOrder","asc"),r(51),C(71,n.data$?71:-1),r(27),C(98,n.excluir?98:-1))},dependencies:[k,H,ue,B,_e,pe,ve,fe,T,re,le,Z,ne,M,te,X,J]});let l=d;return l})();export{pt as VeiculosComponent};
