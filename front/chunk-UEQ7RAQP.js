import{a as ce}from"./chunk-OZ5D2PH7.js";import{a as F}from"./chunk-HXQBKJLI.js";import{a as ue}from"./chunk-ZTDIW4XP.js";import{h as V}from"./chunk-NFMIVN66.js";import{a as se,b as le,c as de,d as me}from"./chunk-AICVXWQ6.js";import{a as ae}from"./chunk-I3SZ5FME.js";import{a as ne}from"./chunk-HYOWEGV7.js";import{a as oe}from"./chunk-3HEW5RTP.js";import{b as re}from"./chunk-4366GPH2.js";import"./chunk-HDKAZCIU.js";import{$b as T,Ca as y,Ea as p,Fa as _,I as C,Ka as B,La as W,Ma as z,Na as A,Nb as R,O as h,Oa as a,P as b,Pa as x,Pb as l,Qb as M,Ra as G,Rb as U,Sb as H,Tb as J,Ua as L,Va as I,Vb as K,W as q,Wa as N,Wb as X,Xb as Y,Ya as E,Yb as Z,Za as Q,Zb as ee,_b as te,ac as ie,ca as d,da as c,la as k,na as v,sa as D,sb as w,ta as $,ua as j,va as P,wa as t,xa as i,ya as f}from"./chunk-OWJSVT4P.js";var O=(()=>{let s=class s{constructor(e,n,r,u,g){this.formBuilder=e,this.setoresService=n,this.unidadesService=r,this.subunidadesService=u,this.toastr=g,this.refresh=new q}ngOnInit(){this.form=this.formBuilder.group({id:[null],nome:[null,l.compose([l.required,l.minLength(5),l.maxLength(100)])],abreviatura:[null,l.compose([l.minLength(2),l.maxLength(10)])],telefone:[null,l.compose([l.minLength(11),l.maxLength(11)])],email:[null,l.compose([l.maxLength(100),l.email])],unidade:[null,l.compose([l.required])],subunidade:[null,l.compose([l.required])]}),this.unidades$=this.unidadesService.index()}cadastrar(){delete this.form.value.pais,delete this.form.value.estado,delete this.form.value.unidade,this.form.value.id?this.setoresService.update(this.form.value.id,this.form.value).subscribe({next:e=>{this.toastr.success("Edi\xE7\xE3o realizada com sucesso!"),this.form.reset(),this.refresh.emit()},error:e=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}):this.setoresService.create(this.form.value).subscribe({next:e=>{this.toastr.success("Cadastro realizado com sucesso!"),this.form.reset(),this.refresh.emit()},error:e=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}})}editar(e){this.form.patchValue(e),e.subunidade&&(this.form.get("unidade")?.patchValue(e.subunidade.unidade.id),this.form.get("subunidade")?.patchValue(e.subunidade.id))}getSubunidades(){this.subunidades$=this.subunidadesService.whereUnidade(this.form.get("unidade")?.value)}};s.\u0275fac=function(n){return new(n||s)(c(te),c(F),c(ce),c(ue),c(V))},s.\u0275cmp=C({type:s,selectors:[["app-setores-form"]],outputs:{refresh:"refresh"},standalone:!0,features:[E],decls:14,vars:4,consts:[[3,"formGroup"],[1,"row"],["label","Unidade","id","unidade","formControlName","unidade",1,"col-sm-4",3,"ngModelChange","data$"],["label","Subunidade","id","subunidade","formControlName","subunidade",1,"col-sm-4",3,"data$"],["formControlName","nome","label","Nome","id","nome","tipo","text",1,"col-sm-4"],["formControlName","abreviatura","label","Abreviatura","id","abreviatura","tipo","text",1,"col-sm-2"],["mascara","(00) 00000-0000","formControlName","telefone","label","Telefone","id","telefone","tipo","text",1,"col-sm-2"],["formControlName","email","label","E-mail","id","email","tipo","email",1,"col-sm-4"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click","disabled"]],template:function(n,r){n&1&&(t(0,"form",0)(1,"div",1)(2,"input-select",2),p("ngModelChange",function(){return r.getSubunidades()}),i(),f(3,"input-select",3),i(),t(4,"div",1),f(5,"input-text",4)(6,"input-text",5)(7,"input-text",6)(8,"input-text",7),i(),t(9,"div",8)(10,"a",9),p("click",function(){return r.form.reset()}),a(11,"Cancelar"),i(),t(12,"button",10),p("click",function(){return r.cadastrar()}),a(13," Cadastrar "),i()()()),n&2&&(v("formGroup",r.form),d(2),v("data$",r.unidades$),d(),v("data$",r.subunidades$),d(9),v("disabled",r.form.invalid))},dependencies:[w,T,J,M,U,ie,K,X,ne,ae]});let o=s;return o})();var ve=()=>[5,10,25];function Se(o,s){if(o&1){let m=y();t(0,"tr",37)(1,"td"),a(2),i(),t(3,"td"),a(4),i(),t(5,"td"),a(6),i(),t(7,"td"),a(8),i(),t(9,"td")(10,"a",38),p("click",function(){let n=h(m).$implicit,r=_(2);return b(r.editar(n))}),f(11,"i",39),i(),t(12,"a",40),p("click",function(){let n=h(m).$implicit,r=_(2);return b(r.delete(n))}),f(13,"i",41),i()()()}if(o&2){let m=s.$implicit;d(2),x(m.id),d(2),G("",m.subunidade.abreviatura," - ",m.subunidade.unidade.abreviatura,""),d(2),x(m.nome),d(2),x(m.abreviatura)}}function _e(o,s){o&1&&(t(0,"tr")(1,"td",23),a(2,"Sem informa\xE7\xE3o"),i()())}function ge(o,s){if(o&1&&(t(0,"tbody"),j(1,Se,14,5,"tr",37,$,!1,_e,3,0,"tr"),i()),o&2){_();let m=A(22);d(),P(m.data)}}function xe(o,s){if(o&1){let m=y();a(0," Tem certeza que deseja excluir: "),t(1,"b"),a(2),i(),t(3,"div",42)(4,"a",43),a(5,"Cancelar"),i(),t(6,"button",44),p("click",function(){h(m);let n=_();return b(n.confirm())}),a(7," Excluir "),i()()}if(o&2){let m=_();d(2),x(m.excluir.nome)}}var Pe=(()=>{let s=class s{constructor(e,n,r){this.setoresService=e,this.toastr=n,this.sessionService=r,this.quant=10}ngOnInit(){this.sessionService.checkPermission("administrador"),this.subscription=this.setoresService.index().subscribe({next:e=>{this.data$=e,this.temp=e}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}refresh(){this.setoresService.index().subscribe({next:e=>{this.data$=e}})}editar(e){this.child.editar(e)}delete(e){this.excluir=e}confirm(){this.setoresService.remove(this.excluir.id||0).subscribe({next:e=>{this.toastr.success("Exclus\xE3o realizada com sucesso!"),this.refresh()},error:e=>{this.toastr.error("Erro ao excluir, tente novamente mais tarde!")}})}pesquisar(){if(this.data$=this.temp,this.pesquisa.length>0){var e=this.pesquisa.toLocaleLowerCase();this.data$=this.data$.filter(n=>n.nome.toLocaleLowerCase().indexOf(e)!==-1||n.abreviatura?.toLocaleLowerCase().indexOf(e)!==-1||n.subunidade.nome.toLocaleLowerCase().indexOf(e)!==-1||n.subunidade.abreviatura.toLocaleLowerCase().indexOf(e)!==-1||!e)}}};s.\u0275fac=function(n){return new(n||s)(c(F),c(V),c(re))},s.\u0275cmp=C({type:s,selectors:[["app-setores"]],viewQuery:function(n,r){if(n&1&&B(O,5),n&2){let u;W(u=z())&&(r.child=u.first)}},standalone:!0,features:[E],decls:67,vars:8,consts:[["mf","mfDataTable"],[1,"content-wrapper"],["titulo","Setores"],[1,"content"],[1,"card"],[1,"card-header","border-0"],[1,"card-title"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary"],[1,"fa","fa-plus"],[1,"card-tools"],[1,"input-group","input-group-sm",2,"width","250px"],[1,"form-control","float-right",2,"width","50px",3,"ngModelChange","ngModel"],["value","10"],["value","25"],["value","50"],["value","100"],["type","text","name","table_search","placeholder","Pesquisar...",1,"form-control","float-right",2,"width","200px",3,"ngModelChange","ngModel"],[1,"card-body","table-responsive","p-1"],[1,"table","table-hover","table-head-fixed","text-nowrap",3,"mfData","mfRowsOnPage"],["by","id"],["by","subunidade.abreviatura"],["by","nome"],["by","abreviatura"],["colspan","100%"],[2,"display","flex","align-items","center","justify-content","center"],[3,"rowsOnPageSet"],["id","modalcad","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header","border-0"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"refresh"],["id","modaldel","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog"],[1,"optionshover"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-edit","text-primary"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-danger","ml-1"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-primary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"]],template:function(n,r){if(n&1){let u=y();t(0,"div",1),f(1,"app-title",2),t(2,"section",3)(3,"div",4)(4,"div",5)(5,"h3",6)(6,"button",7),f(7,"i",8),i()(),t(8,"div",9)(9,"div",10)(10,"select",11),N("ngModelChange",function(S){return h(u),I(r.quant,S)||(r.quant=S),b(S)}),t(11,"option",12),a(12,"10"),i(),t(13,"option",13),a(14,"25"),i(),t(15,"option",14),a(16,"50"),i(),t(17,"option",15),a(18,"100"),i()(),t(19,"input",16),N("ngModelChange",function(S){return h(u),I(r.pesquisa,S)||(r.pesquisa=S),b(S)}),p("ngModelChange",function(){return h(u),b(r.pesquisar())}),i()()()(),t(20,"div",17)(21,"table",18,0)(23,"thead")(24,"tr")(25,"th")(26,"mfDefaultSorter",19),a(27,"#"),i()(),t(28,"th")(29,"mfDefaultSorter",20),a(30,"Subunidade"),i()(),t(31,"th")(32,"mfDefaultSorter",21),a(33,"Nome"),i()(),t(34,"th")(35,"mfDefaultSorter",22),a(36,"Abreviatura"),i()(),t(37,"th"),a(38,"Op\xE7\xF5es"),i()()(),k(39,ge,4,1,"tbody"),t(40,"tfoot")(41,"tr")(42,"td",23)(43,"div",24),f(44,"mfBootstrapPaginator",25),i()()()()()()()(),t(45,"div",26)(46,"div",27)(47,"div",28)(48,"div",29)(49,"h4",30),a(50,"Cadastrar"),i(),t(51,"button",31)(52,"span",32),a(53,"\xD7"),i()()(),t(54,"div",33)(55,"app-setores-form",34),p("refresh",function(){return h(u),b(r.refresh())}),i()()()()(),t(56,"div",35)(57,"div",36)(58,"div",28)(59,"div",29)(60,"h4",30),a(61,"Excluir"),i(),t(62,"button",31)(63,"span",32),a(64,"\xD7"),i()()(),t(65,"div",33),k(66,xe,8,1),i()()()()()}n&2&&(d(10),L("ngModel",r.quant),d(9),L("ngModel",r.pesquisa),d(2),v("mfData",r.data$)("mfRowsOnPage",r.quant),d(18),D(39,r.data$?39:-1),d(5),v("rowsOnPageSet",Q(7,ve)),d(22),D(66,r.excluir?66:-1))},dependencies:[w,oe,O,me,se,de,le,T,Z,ee,R,Y,M,H]});let o=s;return o})();export{Pe as SetoresComponent};
