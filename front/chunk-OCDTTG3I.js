import{a as k}from"./chunk-7KOX2I3V.js";import{a as xe}from"./chunk-WAJO5RIQ.js";import{a as ve}from"./chunk-7UROPAQM.js";import{a as Ce}from"./chunk-R4NLVNIH.js";import{a as he}from"./chunk-TNOIS3Y3.js";import{h as I}from"./chunk-NFMIVN66.js";import{a as ue,b as pe,c as fe,d as _e}from"./chunk-AICVXWQ6.js";import{a as de}from"./chunk-I3SZ5FME.js";import{a as me}from"./chunk-HYOWEGV7.js";import{a as ce}from"./chunk-3HEW5RTP.js";import{b as F}from"./chunk-4366GPH2.js";import"./chunk-HDKAZCIU.js";import{$b as D,Ca as M,Ea as _,Fa as p,Fb as K,I as y,Ib as X,Ka as W,La as z,Ma as A,Na as G,Nb as Y,O as C,Oa as a,P as v,Pa as h,Pb as d,Qb as V,Ra as U,Rb as Z,Sb as ee,Tb as te,Ua as q,Va as N,Vb as ie,W as L,Wa as $,Wb as ae,Xb as oe,Ya as w,Yb as ne,Zb as re,_a as H,_b as se,ac as le,ca as s,cb as O,da as c,eb as j,la as g,na as b,rb as J,sa as S,sb as T,ta as P,ua as Q,va as R,wa as e,xa as t,ya as u}from"./chunk-OWJSVT4P.js";function we(r,m){r&1&&u(0,"input-text",6)}var B=(()=>{let m=class m{constructor(i,o,n,f,E,x,be){this.formBuilder=i,this.materiaisConsumoService=o,this.materiaisConsumoTiposService=n,this.marcasService=f,this.modelosService=E,this.sessionService=x,this.toastr=be,this.editando=!1,this.refresh=new L,this.cancel=new L}ngOnInit(){this.user=this.sessionService.getUser(),this.form=this.formBuilder.group({id:[null],serial:[null,d.compose([d.minLength(5),d.maxLength(100)])],quantidade:[null,d.compose([d.min(1),d.required])],quantidade_alerta:[null,d.compose([d.min(1)])],data_validade:[null],data_baixa:[null],observacoes:[null],marca:[null,d.compose([d.required])],modelo:[null,d.compose([d.required])],material_consumo_tipo:[null,d.compose([d.required])],subunidade:[null]}),this.marcas$=this.marcasService.marcasLogistica(),this.materiaisconsumotipos$=this.materiaisConsumoTiposService.index()}cadastrar(){this.form.value.id?(this.form.value.data_baixa||this.form.get("data_baixa")?.patchValue(null),this.form.value.data_validade||this.form.get("data_validade")?.patchValue(null),delete this.form.value.marca,this.materiaisConsumoService.update(this.form.value.id,this.form.value).subscribe({next:i=>{this.toastr.success("Edi\xE7\xE3o realizada com sucesso!"),this.form.reset(),this.refresh.emit(),this.editando=!1},error:i=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}})):(delete this.form.value.marca,this.sessionService.getSubunidade()?this.form.get("subunidade")?.patchValue(this.sessionService.getSubunidade()):this.toastr.error("Selecione uma subunidade!"),this.materiaisConsumoService.create(this.form.value).subscribe({next:i=>{this.toastr.success("Cadastro realizado com sucesso!"),this.form.reset(),this.refresh.emit()},error:i=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}))}editar(i){this.editando=!0,this.form.patchValue(i),i.modelo&&(this.form.get("marca")?.patchValue(i.modelo.marca.id),this.form.get("modelo")?.patchValue(i.modelo.id),this.getModelos()),i.material_consumo_tipo&&this.form.get("material_consumo_tipo")?.patchValue(i.material_consumo_tipo.id)}cancelar(){this.form.reset(),this.editando=!1,this.cancel.emit()}resetForm(){this.editando=!1,this.form.reset()}getModelos(){this.modelos$=this.modelosService.whereMarca(this.form.get("marca")?.value)}};m.\u0275fac=function(o){return new(o||m)(c(se),c(k),c(xe),c(Ce),c(ve),c(F),c(I))},m.\u0275cmp=y({type:m,selectors:[["app-materiais-consumo-form"]],outputs:{refresh:"refresh",cancel:"cancel"},standalone:!0,features:[w],decls:19,vars:6,consts:[[3,"formGroup"],[1,"row"],["label","Marca","id","marca","formControlName","marca",1,"col-sm-2",3,"ngModelChange","data$"],["label","Modelo","id","modelo","formControlName","modelo",1,"col-sm-2",3,"data$"],["label","Tipo","id","material_consumo_tipo","formControlName","material_consumo_tipo",1,"col-sm-2",3,"data$"],["formControlName","serial","label","Serial","id","serial","tipo","text",1,"col-sm-2"],["formControlName","quantidade","label","Quantidade","id","quantidade","tipo","number",1,"col-sm-2"],["formControlName","quantidade_alerta","label","Quantidade Alerta","id","quantidade_alerta","tipo","number",1,"col-sm-2"],["formControlName","data_validade","label","Data Validade","id","data_validade","tipo","date",1,"col-sm-2"],["formControlName","data_baixa","label","Data Baixa","id","data_baixa","tipo","date",1,"col-sm-2"],[1,"row",2,"height","350px"],["formControlName","observacoes","label","Observa\xE7\xF5es","id","observacoes",1,"col-sm-12"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click","disabled"]],template:function(o,n){o&1&&(e(0,"form",0)(1,"div",1)(2,"input-select",2),_("ngModelChange",function(){return n.getModelos()}),t(),u(3,"input-select",3)(4,"input-select",4)(5,"input-text",5),t(),e(6,"div",1),g(7,we,1,0,"input-text",6),u(8,"input-text",7),t(),e(9,"div",1),u(10,"input-text",8)(11,"input-text",9),t(),e(12,"div",10),u(13,"input-textarea",11),t(),e(14,"div",12)(15,"a",13),_("click",function(){return n.form.reset()}),a(16,"Cancelar"),t(),e(17,"button",14),_("click",function(){return n.cadastrar()}),a(18," Cadastrar "),t()()()),o&2&&(b("formGroup",n.form),s(2),b("data$",n.marcas$),s(),b("data$",n.modelos$),s(),b("data$",n.materiaisconsumotipos$),s(3),S(7,n.editando?-1:7),s(10),b("disabled",n.form.invalid))},dependencies:[T,D,te,V,Z,le,ie,ae,me,de,he]});let r=m;return r})();var Te=r=>["/MaterialConsumo",r];function Ve(r,m){if(r&1){let l=M();e(0,"button",40),_("click",function(){C(l);let o=p();return v(o.cadastrar())}),u(1,"i",41),t()}}function De(r,m){if(r&1){let l=M();e(0,"a",46),_("click",function(){C(l);let o=p().$implicit,n=p(2);return v(n.editar(o))}),u(1,"i",47),t()}}function Fe(r,m){if(r&1){let l=M();e(0,"a",48),_("click",function(){C(l);let o=p().$implicit,n=p(2);return v(n.delete(o))}),u(1,"i",49),t()}}function Ie(r,m){if(r&1&&(e(0,"tr",42)(1,"td"),a(2),t(),e(3,"td"),a(4),t(),e(5,"td")(6,"a",43),a(7),t()(),e(8,"td"),a(9),t(),e(10,"td"),a(11),t(),e(12,"td"),a(13),t(),e(14,"td"),a(15),t(),e(16,"td"),a(17),t(),e(18,"td"),a(19),O(20,"date"),t(),e(21,"td"),a(22),O(23,"date"),t(),e(24,"td"),g(25,De,2,0,"a",44)(26,Fe,2,0,"a",45),t()()),r&2){let l=m.$implicit,i=p(2);s(2),h(l.id),s(2),U("",l.subunidade.abreviatura," - ",l.subunidade.unidade.abreviatura,""),s(2),b("routerLink",H(20,Te,l.id)),s(),h(l.material_consumo_tipo.nome),s(2),h(l.modelo.marca.nome),s(2),h(l.modelo.nome),s(2),h(l.serial),s(2),h(l.quantidade),s(2),h(l.quantidade_alerta),s(2),h(j(20,14,l.data_validade,"dd/MM/yyyy")),s(3),h(j(23,17,l.data_baixa,"dd/MM/yyyy")),s(3),S(25,i.user.perfil.materiais_consumo_edt?25:-1),s(),S(26,i.user.perfil.materiais_consumo_del?26:-1)}}function ke(r,m){r&1&&(e(0,"tr")(1,"td",28),a(2,"Sem informa\xE7\xE3o"),t()())}function Le(r,m){if(r&1&&(e(0,"tbody"),Q(1,Ie,27,22,"tr",42,P,!1,ke,3,0,"tr"),t()),r&2){p();let l=G(21);s(),R(l.data)}}function qe(r,m){if(r&1){let l=M();e(0,"app-materiais-consumo-form",50),_("refresh",function(){C(l);let o=p();return v(o.refresh())})("cancel",function(){C(l);let o=p();return v(o.resetForm())}),t()}}function Ne(r,m){if(r&1){let l=M();a(0," Tem certeza que deseja excluir: "),e(1,"b"),a(2),t(),e(3,"div",51)(4,"a",52),a(5,"Cancelar"),t(),e(6,"button",53),_("click",function(){C(l);let o=p();return v(o.confirm())}),a(7," Excluir "),t()()}if(r&2){let l=p();s(2),h(l.excluir.material_consumo_tipo.nome)}}var at=(()=>{let m=class m{constructor(i,o,n){this.materiaisConsumoService=i,this.toastr=o,this.sessionService=n,this.quant=10,this.cadastrando=!1}ngOnInit(){this.user=this.sessionService.getUser(),this.sessionService.checkPermission("materiais_consumo"),this.subscription=this.materiaisConsumoService.index().subscribe({next:i=>{this.data$=i,this.temp=i}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}refresh(){this.materiaisConsumoService.index().subscribe({next:i=>{this.data$=i}})}editar(i){this.cadastrando=!0,setTimeout(()=>{this.child.editar(i)},100)}cadastrar(){this.cadastrando=!0,setTimeout(()=>{this.child.resetForm()},100)}resetForm(){this.child.resetForm(),this.cadastrando=!1}delete(i){this.excluir=i}confirm(){this.materiaisConsumoService.remove(this.excluir.id||0).subscribe({next:i=>{this.toastr.success("Exclus\xE3o realizada com sucesso!"),this.refresh()},error:i=>{this.toastr.error("Erro ao excluir, tente novamente mais tarde!")}})}pesquisar(){if(this.data$=this.temp,this.pesquisa.length>0){var i=this.pesquisa.toLocaleLowerCase();this.data$=this.data$.filter(o=>o.serial?o.serial.toLocaleLowerCase().indexOf(i)!==-1||o.modelo.nome.toLocaleLowerCase().indexOf(i)!==-1||o.modelo.marca.nome.toLocaleLowerCase().indexOf(i)!==-1||o.material_consumo_tipo.nome.toLocaleLowerCase().indexOf(i)!==-1||!i:o.modelo.nome.toLocaleLowerCase().indexOf(i)!==-1||o.modelo.marca.nome.toLocaleLowerCase().indexOf(i)!==-1||o.material_consumo_tipo.nome.toLocaleLowerCase().indexOf(i)!==-1||!i)}}};m.\u0275fac=function(o){return new(o||m)(c(k),c(I),c(F))},m.\u0275cmp=y({type:m,selectors:[["app-materiais-consumo"]],viewQuery:function(o,n){if(o&1&&W(B,5),o&2){let f;z(f=A())&&(n.child=f.first)}},standalone:!0,features:[w],decls:84,vars:8,consts:[["mf","mfDataTable"],[1,"content-wrapper"],["titulo","Materiais de Consumo"],[1,"content"],[1,"card"],[1,"card-header","border-0"],[1,"card-title"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary"],[1,"card-tools"],[1,"input-group","input-group-sm",2,"width","250px"],[1,"form-control","float-right",2,"width","50px",3,"ngModelChange","ngModel"],["value","10"],["value","25"],["value","50"],["value","100"],["type","text","name","table_search","placeholder","Pesquisar...",1,"form-control","float-right",2,"width","200px",3,"ngModelChange","ngModel"],[1,"card-body","table-responsive","p-1"],[1,"table","table-hover","table-head-fixed","text-nowrap",3,"mfData","mfRowsOnPage"],["by","id"],["by","subunidade.abreviatura"],["by","material_consumo_tipo.nome"],["by","modelo.marca.nome"],["by","modelo.nome"],["by","serial"],["by","quantidade"],["by","quantidade_alerta"],["by","data_validade"],["by","data_baixa"],["colspan","100%"],[2,"display","flex","align-items","center","justify-content","center"],["id","modalcad","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header","border-0"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["id","modaldel","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary",3,"click"],[1,"fa","fa-plus"],[1,"optionshover"],[3,"routerLink"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-edit","text-primary"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-danger","ml-1"],[3,"refresh","cancel"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-primary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"]],template:function(o,n){if(o&1){let f=M();e(0,"div",1),u(1,"app-title",2),e(2,"section",3)(3,"div",4)(4,"div",5)(5,"h3",6),g(6,Ve,2,0,"button",7),t(),e(7,"div",8)(8,"div",9)(9,"select",10),$("ngModelChange",function(x){return C(f),N(n.quant,x)||(n.quant=x),v(x)}),e(10,"option",11),a(11,"10"),t(),e(12,"option",12),a(13,"25"),t(),e(14,"option",13),a(15,"50"),t(),e(16,"option",14),a(17,"100"),t()(),e(18,"input",15),$("ngModelChange",function(x){return C(f),N(n.pesquisa,x)||(n.pesquisa=x),v(x)}),_("ngModelChange",function(){return C(f),v(n.pesquisar())}),t()()()(),e(19,"div",16)(20,"table",17,0)(22,"thead")(23,"tr")(24,"th")(25,"mfDefaultSorter",18),a(26,"#"),t()(),e(27,"th")(28,"mfDefaultSorter",19),a(29,"Subunidade"),t()(),e(30,"th")(31,"mfDefaultSorter",20),a(32,"Tipo"),t()(),e(33,"th")(34,"mfDefaultSorter",21),a(35,"Marca"),t()(),e(36,"th")(37,"mfDefaultSorter",22),a(38,"Modelo"),t()(),e(39,"th")(40,"mfDefaultSorter",23),a(41,"Serial"),t()(),e(42,"th")(43,"mfDefaultSorter",24),a(44,"Quantidade"),t()(),e(45,"th")(46,"mfDefaultSorter",25),a(47,"Quantidade Alerta"),t()(),e(48,"th")(49,"mfDefaultSorter",26),a(50,"Dt. Validade"),t()(),e(51,"th")(52,"mfDefaultSorter",27),a(53,"Dt. Baixa"),t()(),e(54,"th"),a(55,"Op\xE7\xF5es"),t()()(),g(56,Le,4,1,"tbody"),e(57,"tfoot")(58,"tr")(59,"td",28)(60,"div",29),u(61,"mfBootstrapPaginator"),t()()()()()()()(),e(62,"div",30)(63,"div",31)(64,"div",32)(65,"div",33)(66,"h4",34),a(67,"Cadastrar"),t(),e(68,"button",35)(69,"span",36),a(70,"\xD7"),t()()(),e(71,"div",37),g(72,qe,1,0,"app-materiais-consumo-form"),t()()()(),e(73,"div",38)(74,"div",39)(75,"div",32)(76,"div",33)(77,"h4",34),a(78,"Excluir"),t(),e(79,"button",35)(80,"span",36),a(81,"\xD7"),t()()(),e(82,"div",37),g(83,Ne,8,1),t()()()()()}o&2&&(s(6),S(6,n.user.perfil.materiais_consumo_cad?6:-1),s(3),q("ngModel",n.quant),s(9),q("ngModel",n.pesquisa),s(2),b("mfData",n.data$)("mfRowsOnPage",n.quant),s(36),S(56,n.data$?56:-1),s(16),S(72,n.cadastrando?72:-1),s(11),S(83,n.excluir?83:-1))},dependencies:[T,J,ce,B,_e,ue,fe,pe,D,ne,re,Y,oe,V,ee,X,K]});let r=m;return r})();export{at as MateriaisConsumoComponent};
