import{a as T}from"./chunk-OZ5D2PH7.js";import{a as fe}from"./chunk-VOV5UOCH.js";import{a as ue}from"./chunk-DTE4J6WV.js";import{a as pe}from"./chunk-5OALEDWI.js";import{a as ce}from"./chunk-2IJB273A.js";import{h as V}from"./chunk-NFMIVN66.js";import{a as se,b as de,c as le,d as me}from"./chunk-AICVXWQ6.js";import{a as re}from"./chunk-I3SZ5FME.js";import{a as ne}from"./chunk-HYOWEGV7.js";import{a as oe}from"./chunk-3HEW5RTP.js";import{b as ae}from"./chunk-4366GPH2.js";import"./chunk-HDKAZCIU.js";import{$b as M,Ca as E,Ea as h,Fa as _,I as S,Ka as B,La as W,Ma as A,Na as R,Nb as G,O as b,Oa as o,P as g,Pa as x,Pb as r,Qb as $,Rb as Q,Sb as H,Tb as J,Ua as D,Va as U,Vb as K,W as q,Wa as k,Wb as X,Xb as Y,Ya as y,Yb as Z,Za as z,Zb as ee,_b as te,ac as ie,ca as s,da as u,l as L,la as N,na as p,sa as F,sb as w,ta as j,ua as O,va as P,wa as t,xa as i,ya as f}from"./chunk-OWJSVT4P.js";var I=(()=>{let l=class l{constructor(e,a,n,m,C,v,he){this.formBuilder=e,this.unidadesService=a,this.paisesService=n,this.estadosService=m,this.cidadesService=C,this.policiaisService=v,this.toastr=he,this.refresh=new q}ngOnInit(){this.form=this.formBuilder.group({id:[null],nome:[null,r.compose([r.required,r.minLength(5),r.maxLength(100)])],abreviatura:[null,r.compose([r.required,r.minLength(2),r.maxLength(10)])],telefone:[null,r.compose([r.minLength(11),r.maxLength(11)])],email:[null,r.compose([r.maxLength(100),r.email])],rua:[null,r.compose([r.maxLength(100)])],numero:[null,r.compose([r.maxLength(20)])],bairro:[null,r.compose([r.maxLength(100)])],cep:[null,r.compose([r.maxLength(8)])],pais:[null],estado:[null],cidade:[null],comandante:[null,r.compose([r.required])],subcomandante:[null,r.compose([r.required])]}),this.paises$=this.paisesService.index(),this.subscription=this.policiaisService.disponiveis().subscribe({next:e=>{e.forEach(a=>{a.numeral?a.nome=`${a.graduacao.abreviatura} ${a.numeral} ${a.nome_guerra}, ${a.matricula}`:a.nome=`${a.graduacao.abreviatura} ${a.nome_guerra}, ${a.matricula}`}),this.policiais$=L(e)}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}cadastrar(){delete this.form.value.pais,delete this.form.value.estado,this.form.value.id?this.unidadesService.update(this.form.value.id,this.form.value).subscribe({next:e=>{this.toastr.success("Edi\xE7\xE3o realizada com sucesso!"),this.form.reset(),this.refresh.emit()},error:e=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}):this.unidadesService.create(this.form.value).subscribe({next:e=>{this.toastr.success("Cadastro realizado com sucesso!"),this.form.reset(),this.refresh.emit()},error:e=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}})}editar(e){this.form.patchValue(e),e.cidade&&(this.form.get("pais")?.patchValue(e.cidade.estado.pais.id),this.form.get("estado")?.patchValue(e.cidade.estado.id),this.form.get("cidade")?.patchValue(e.cidade.id),this.getEstados(),this.getCidades()),e.comandante&&this.form.get("comandante")?.patchValue(e.comandante.id),e.subcomandante&&this.form.get("subcomandante")?.patchValue(e.subcomandante.id)}getEstados(){this.estados$=this.estadosService.wherePais(this.form.get("pais")?.value)}getCidades(){this.cidades$=this.cidadesService.whereEstado(this.form.get("estado")?.value)}};l.\u0275fac=function(a){return new(a||l)(u(te),u(T),u(fe),u(pe),u(ue),u(ce),u(V))},l.\u0275cmp=S({type:l,selectors:[["app-unidades-form"]],outputs:{refresh:"refresh"},standalone:!0,features:[y],decls:22,vars:7,consts:[[3,"formGroup"],[1,"row"],["formControlName","nome","label","Nome","id","nome","tipo","text",1,"col-sm-4"],["formControlName","abreviatura","label","Abreviatura","id","abreviatura","tipo","text",1,"col-sm-2"],["mascara","(00) 00000-0000","formControlName","telefone","label","Telefone","id","telefone","tipo","text",1,"col-sm-2"],["formControlName","email","label","E-mail","id","email","tipo","email",1,"col-sm-4"],["label","Comandante","id","comandate","formControlName","comandante",1,"col-sm-6",3,"data$"],["label","subcomandante","id","subcomandate","formControlName","subcomandante",1,"col-sm-6",3,"data$"],["formControlName","rua","label","Rua","id","rua","tipo","text",1,"col-sm-4"],["formControlName","numero","label","N\xFAmero","id","numero","tipo","text",1,"col-sm-2"],["formControlName","bairro","label","Bairro","id","bairro","tipo","text",1,"col-sm-4"],["label","Pa\xEDs","id","pais","formControlName","pais",1,"col-sm-2",3,"ngModelChange","data$"],["label","Estado","id","estado","formControlName","estado",1,"col-sm-2",3,"ngModelChange","data$"],["label","Cidade","id","cidade","formControlName","cidade",1,"col-sm-2",3,"data$"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click","disabled"]],template:function(a,n){a&1&&(t(0,"form",0)(1,"div",1),f(2,"input-text",2)(3,"input-text",3)(4,"input-text",4)(5,"input-text",5),i(),t(6,"div",1),f(7,"input-select",6)(8,"input-select",7),i(),t(9,"div",1),f(10,"input-text",8)(11,"input-text",9)(12,"input-text",10),i(),t(13,"div",1)(14,"input-select",11),h("ngModelChange",function(){return n.getEstados()}),i(),t(15,"input-select",12),h("ngModelChange",function(){return n.getCidades()}),i(),f(16,"input-select",13),i(),t(17,"div",14)(18,"a",15),h("click",function(){return n.form.reset()}),o(19,"Cancelar"),i(),t(20,"button",16),h("click",function(){return n.cadastrar()}),o(21,"Cadastrar"),i()()()),a&2&&(p("formGroup",n.form),s(7),p("data$",n.policiais$),s(),p("data$",n.policiais$),s(6),p("data$",n.paises$),s(),p("data$",n.estados$),s(),p("data$",n.cidades$),s(4),p("disabled",n.form.invalid))},dependencies:[w,M,J,$,Q,ie,K,X,ne,re]});let d=l;return d})();var Ce=()=>[5,10,25];function xe(d,l){if(d&1){let c=E();t(0,"tr",36)(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td")(8,"a",37),h("click",function(){let a=b(c).$implicit,n=_(2);return g(n.editar(a))}),f(9,"i",38),i(),t(10,"a",39),h("click",function(){let a=b(c).$implicit,n=_(2);return g(n.delete(a))}),f(11,"i",40),i()()()}if(d&2){let c=l.$implicit;s(2),x(c.id),s(2),x(c.nome),s(2),x(c.abreviatura)}}function Se(d,l){d&1&&(t(0,"tr")(1,"td",22),o(2,"Sem informa\xE7\xE3o"),i()())}function Ee(d,l){if(d&1&&(t(0,"tbody"),O(1,xe,12,3,"tr",36,j,!1,Se,3,0,"tr"),i()),d&2){_();let c=R(22);s(),P(c.data)}}function ye(d,l){if(d&1){let c=E();o(0," Tem certeza que deseja excluir: "),t(1,"b"),o(2),i(),t(3,"div",41)(4,"a",42),o(5,"Cancelar"),i(),t(6,"button",43),h("click",function(){b(c);let a=_();return g(a.confirm())}),o(7," Excluir "),i()()}if(d&2){let c=_();s(2),x(c.excluir.nome)}}var ze=(()=>{let l=class l{constructor(e,a,n){this.unidadesService=e,this.toastr=a,this.sessionService=n,this.quant=10}ngOnInit(){this.sessionService.checkPermission("administrador"),this.subscription=this.unidadesService.index().subscribe({next:e=>{this.data$=e,this.temp=e}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}refresh(){this.unidadesService.index().subscribe({next:e=>{this.data$=e}})}editar(e){this.child.editar(e)}delete(e){this.excluir=e}confirm(){this.unidadesService.remove(this.excluir.id||0).subscribe({next:e=>{this.toastr.success("Exclus\xE3o realizada com sucesso!"),this.refresh()},error:e=>{this.toastr.error("Erro ao excluir, tente novamente mais tarde!")}})}pesquisar(){if(this.data$=this.temp,this.pesquisa.length>0){var e=this.pesquisa.toLocaleLowerCase();this.data$=this.data$.filter(a=>a.nome.toLocaleLowerCase().indexOf(e)!==-1||a.abreviatura.toLocaleLowerCase().indexOf(e)!==-1||!e)}}};l.\u0275fac=function(a){return new(a||l)(u(T),u(V),u(ae))},l.\u0275cmp=S({type:l,selectors:[["app-unidades"]],viewQuery:function(a,n){if(a&1&&B(I,5),a&2){let m;W(m=A())&&(n.child=m.first)}},standalone:!0,features:[y],decls:64,vars:8,consts:[["mf","mfDataTable"],[1,"content-wrapper"],["titulo","Unidades"],[1,"content"],[1,"card"],[1,"card-header","border-0"],[1,"card-title"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary"],[1,"fa","fa-plus"],[1,"card-tools"],[1,"input-group","input-group-sm",2,"width","250px"],[1,"form-control","float-right",2,"width","50px",3,"ngModelChange","ngModel"],["value","10"],["value","25"],["value","50"],["value","100"],["type","text","name","table_search","placeholder","Pesquisar...",1,"form-control","float-right",2,"width","200px",3,"ngModelChange","ngModel"],[1,"card-body","table-responsive","p-1"],[1,"table","table-hover","table-head-fixed","text-nowrap",3,"mfData","mfRowsOnPage"],["by","id"],["by","nome"],["by","abreviatura"],["colspan","100%"],[2,"display","flex","align-items","center","justify-content","center"],[3,"rowsOnPageSet"],["id","modalcad","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header","border-0"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"refresh"],["id","modaldel","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog"],[1,"optionshover"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-edit","text-primary"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-danger","ml-1"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-primary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"]],template:function(a,n){if(a&1){let m=E();t(0,"div",1),f(1,"app-title",2),t(2,"section",3)(3,"div",4)(4,"div",5)(5,"h3",6)(6,"button",7),f(7,"i",8),i()(),t(8,"div",9)(9,"div",10)(10,"select",11),k("ngModelChange",function(v){return b(m),U(n.quant,v)||(n.quant=v),g(v)}),t(11,"option",12),o(12,"10"),i(),t(13,"option",13),o(14,"25"),i(),t(15,"option",14),o(16,"50"),i(),t(17,"option",15),o(18,"100"),i()(),t(19,"input",16),k("ngModelChange",function(v){return b(m),U(n.pesquisa,v)||(n.pesquisa=v),g(v)}),h("ngModelChange",function(){return b(m),g(n.pesquisar())}),i()()()(),t(20,"div",17)(21,"table",18,0)(23,"thead")(24,"tr")(25,"th")(26,"mfDefaultSorter",19),o(27,"#"),i()(),t(28,"th")(29,"mfDefaultSorter",20),o(30,"Nome"),i()(),t(31,"th")(32,"mfDefaultSorter",21),o(33,"Abreviatura"),i()(),t(34,"th"),o(35,"Op\xE7\xF5es"),i()()(),N(36,Ee,4,1,"tbody"),t(37,"tfoot")(38,"tr")(39,"td",22)(40,"div",23),f(41,"mfBootstrapPaginator",24),i()()()()()()()(),t(42,"div",25)(43,"div",26)(44,"div",27)(45,"div",28)(46,"h4",29),o(47,"Cadastrar"),i(),t(48,"button",30)(49,"span",31),o(50,"\xD7"),i()()(),t(51,"div",32)(52,"app-unidades-form",33),h("refresh",function(){return b(m),g(n.refresh())}),i()()()()(),t(53,"div",34)(54,"div",35)(55,"div",27)(56,"div",28)(57,"h4",29),o(58,"Excluir"),i(),t(59,"button",30)(60,"span",31),o(61,"\xD7"),i()()(),t(62,"div",32),N(63,ye,8,1),i()()()()()}a&2&&(s(10),D("ngModel",n.quant),s(9),D("ngModel",n.pesquisa),s(2),p("mfData",n.data$)("mfRowsOnPage",n.quant),s(15),F(36,n.data$?36:-1),s(5),p("rowsOnPageSet",z(7,Ce)),s(22),F(63,n.excluir?63:-1))},dependencies:[w,oe,I,me,se,le,de,M,Z,ee,G,Y,$,H]});let d=l;return d})();export{ze as UnidadesComponent};
