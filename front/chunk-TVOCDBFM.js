import{a as he}from"./chunk-GOTAZHJ7.js";import{a as fe}from"./chunk-LBCJFU5D.js";import{a as T}from"./chunk-HMKSEIRC.js";import{a as ce}from"./chunk-ATLJQ2UK.js";import{a as pe}from"./chunk-NIBPGJ6J.js";import{a as ue}from"./chunk-Y64AYFHZ.js";import{h as V}from"./chunk-NFMIVN66.js";import{a as se,b as de,c as le,d as me}from"./chunk-AICVXWQ6.js";import{a as re}from"./chunk-I3SZ5FME.js";import{a as ne}from"./chunk-HYOWEGV7.js";import{a as oe}from"./chunk-3HEW5RTP.js";import{b as ae}from"./chunk-UKCOEVIY.js";import"./chunk-HDKAZCIU.js";import{$b as M,Ca as E,Ea as h,Fa as S,I as x,Ka as W,La as A,Ma as R,Na as z,Nb as Q,O as v,Oa as o,P as g,Pa as _,Pb as r,Qb as $,Rb as U,Sb as H,Tb as J,Ua as F,Va as D,Vb as K,W as O,Wa as I,Wb as X,Xb as Y,Ya as y,Yb as Z,Za as G,Zb as ee,_b as te,ac as ie,ca as s,da as c,l as q,la as N,na as p,sa as L,sb as w,ta as j,ua as P,va as B,wa as t,xa as i,ya as f}from"./chunk-OWJSVT4P.js";var k=(()=>{let l=class l{constructor(e,a,n,u,C,b,be,ve){this.formBuilder=e,this.subunidadesService=a,this.unidadesService=n,this.paisesService=u,this.estadosService=C,this.cidadesService=b,this.policiaisService=be,this.toastr=ve,this.refresh=new O}ngOnInit(){this.form=this.formBuilder.group({id:[null],nome:[null,r.compose([r.required,r.minLength(5),r.maxLength(100)])],abreviatura:[null,r.compose([r.required,r.minLength(2),r.maxLength(10)])],telefone:[null,r.compose([r.minLength(11),r.maxLength(11)])],email:[null,r.compose([r.maxLength(100),r.email])],rua:[null,r.compose([r.maxLength(100)])],numero:[null,r.compose([r.maxLength(20)])],bairro:[null,r.compose([r.maxLength(100)])],cep:[null,r.compose([r.maxLength(8)])],pais:[null],estado:[null],cidade:[null],unidade:[null,r.compose([r.required])],comandante:[null,r.compose([r.required])],subcomandante:[null,r.compose([r.required])]}),this.unidades$=this.unidadesService.index(),this.paises$=this.paisesService.index(),this.subscription=this.policiaisService.disponiveis().subscribe({next:e=>{e.forEach(a=>{a.numeral?a.nome=`${a.graduacao.abreviatura} ${a.numeral} ${a.nome_guerra}, ${a.matricula}`:a.nome=`${a.graduacao.abreviatura} ${a.nome_guerra}, ${a.matricula}`}),this.policiais$=q(e)}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}cadastrar(){delete this.form.value.pais,delete this.form.value.estado,this.form.value.id?this.subunidadesService.update(this.form.value.id,this.form.value).subscribe({next:e=>{this.toastr.success("Edi\xE7\xE3o realizada com sucesso!"),this.form.reset(),this.refresh.emit()},error:e=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}):this.subunidadesService.create(this.form.value).subscribe({next:e=>{this.toastr.success("Cadastro realizado com sucesso!"),this.form.reset(),this.refresh.emit()},error:e=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}})}editar(e){this.form.patchValue(e),e.unidade&&this.form.get("unidade")?.patchValue(e.unidade.id),e.comandante&&this.form.get("comandante")?.patchValue(e.comandante.id),e.subcomandante&&this.form.get("subcomandante")?.patchValue(e.subcomandante.id),e.cidade&&(this.form.get("pais")?.patchValue(e.cidade.estado.pais.id),this.form.get("estado")?.patchValue(e.cidade.estado.id),this.form.get("cidade")?.patchValue(e.cidade.id),this.getEstados(),this.getCidades())}getEstados(){this.estados$=this.estadosService.wherePais(this.form.get("pais")?.value)}getCidades(){this.cidades$=this.cidadesService.whereEstado(this.form.get("estado")?.value)}};l.\u0275fac=function(a){return new(a||l)(c(te),c(T),c(he),c(fe),c(pe),c(ce),c(ue),c(V))},l.\u0275cmp=x({type:l,selectors:[["app-subunidades-form"]],outputs:{refresh:"refresh"},standalone:!0,features:[y],decls:24,vars:8,consts:[[3,"formGroup"],[1,"row"],["label","Unidade","id","unidade","formControlName","unidade",1,"col-sm-4",3,"data$"],["formControlName","nome","label","Nome","id","nome","tipo","text",1,"col-sm-4"],["formControlName","abreviatura","label","Abreviatura","id","abreviatura","tipo","text",1,"col-sm-2"],["mascara","(00) 00000-0000","formControlName","telefone","label","Telefone","id","telefone","tipo","text",1,"col-sm-2"],["formControlName","email","label","E-mail","id","email","tipo","email",1,"col-sm-4"],["label","Comandante","id","comandate","formControlName","comandante",1,"col-sm-6",3,"data$"],["label","subcomandante","id","subcomandate","formControlName","subcomandante",1,"col-sm-6",3,"data$"],["formControlName","rua","label","Rua","id","rua","tipo","text",1,"col-sm-4"],["formControlName","numero","label","N\xFAmero","id","numero","tipo","text",1,"col-sm-2"],["formControlName","bairro","label","Bairro","id","bairro","tipo","text",1,"col-sm-4"],["label","Pa\xEDs","id","pais","formControlName","pais",1,"col-sm-2",3,"ngModelChange","data$"],["label","Estado","id","estado","formControlName","estado",1,"col-sm-2",3,"ngModelChange","data$"],["label","Cidade","id","cidade","formControlName","cidade",1,"col-sm-2",3,"data$"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click","disabled"]],template:function(a,n){a&1&&(t(0,"form",0)(1,"div",1),f(2,"input-select",2),i(),t(3,"div",1),f(4,"input-text",3)(5,"input-text",4)(6,"input-text",5)(7,"input-text",6),i(),t(8,"div",1),f(9,"input-select",7)(10,"input-select",8),i(),t(11,"div",1),f(12,"input-text",9)(13,"input-text",10)(14,"input-text",11),i(),t(15,"div",1)(16,"input-select",12),h("ngModelChange",function(){return n.getEstados()}),i(),t(17,"input-select",13),h("ngModelChange",function(){return n.getCidades()}),i(),f(18,"input-select",14),i(),t(19,"div",15)(20,"a",16),h("click",function(){return n.form.reset()}),o(21,"Cancelar"),i(),t(22,"button",17),h("click",function(){return n.cadastrar()}),o(23," Cadastrar "),i()()()),a&2&&(p("formGroup",n.form),s(2),p("data$",n.unidades$),s(7),p("data$",n.policiais$),s(),p("data$",n.policiais$),s(6),p("data$",n.paises$),s(),p("data$",n.estados$),s(),p("data$",n.cidades$),s(4),p("disabled",n.form.invalid))},dependencies:[w,M,J,$,U,ie,K,X,ne,re]});let d=l;return d})();var xe=()=>[5,10,25];function Ee(d,l){if(d&1){let m=E();t(0,"tr",37)(1,"td"),o(2),i(),t(3,"td"),o(4),i(),t(5,"td"),o(6),i(),t(7,"td"),o(8),i(),t(9,"td")(10,"a",38),h("click",function(){let a=v(m).$implicit,n=S(2);return g(n.editar(a))}),f(11,"i",39),i(),t(12,"a",40),h("click",function(){let a=v(m).$implicit,n=S(2);return g(n.delete(a))}),f(13,"i",41),i()()()}if(d&2){let m=l.$implicit;s(2),_(m.id),s(2),_(m.unidade.abreviatura),s(2),_(m.nome),s(2),_(m.abreviatura)}}function ye(d,l){d&1&&(t(0,"tr")(1,"td",23),o(2,"Sem informa\xE7\xE3o"),i()())}function we(d,l){if(d&1&&(t(0,"tbody"),P(1,Ee,14,4,"tr",37,j,!1,ye,3,0,"tr"),i()),d&2){S();let m=z(22);s(),B(m.data)}}function $e(d,l){if(d&1){let m=E();o(0," Tem certeza que deseja excluir: "),t(1,"b"),o(2),i(),t(3,"div",42)(4,"a",43),o(5,"Cancelar"),i(),t(6,"button",44),h("click",function(){v(m);let a=S();return g(a.confirm())}),o(7," Excluir "),i()()}if(d&2){let m=S();s(2),_(m.excluir.nome)}}var He=(()=>{let l=class l{constructor(e,a,n){this.subunidadesService=e,this.toastr=a,this.sessionService=n,this.quant=10}ngOnInit(){this.sessionService.checkPermission("administrador"),this.subscription=this.subunidadesService.index().subscribe({next:e=>{this.data$=e,this.temp=e}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}refresh(){this.subunidadesService.index().subscribe({next:e=>{this.data$=e}})}editar(e){this.child.editar(e)}delete(e){this.excluir=e}confirm(){this.subunidadesService.remove(this.excluir.id||0).subscribe({next:e=>{this.toastr.success("Exclus\xE3o realizada com sucesso!"),this.refresh()},error:e=>{this.toastr.error("Erro ao excluir, tente novamente mais tarde!")}})}pesquisar(){if(this.data$=this.temp,this.pesquisa.length>0){var e=this.pesquisa.toLocaleLowerCase();this.data$=this.data$.filter(a=>a.nome.toLocaleLowerCase().indexOf(e)!==-1||a.abreviatura.toLocaleLowerCase().indexOf(e)!==-1||a.unidade.nome.toLocaleLowerCase().indexOf(e)!==-1||a.unidade.abreviatura.toLocaleLowerCase().indexOf(e)!==-1||!e)}}};l.\u0275fac=function(a){return new(a||l)(c(T),c(V),c(ae))},l.\u0275cmp=x({type:l,selectors:[["app-subunidades"]],viewQuery:function(a,n){if(a&1&&W(k,5),a&2){let u;A(u=R())&&(n.child=u.first)}},standalone:!0,features:[y],decls:67,vars:8,consts:[["mf","mfDataTable"],[1,"content-wrapper"],["titulo","Subunidades"],[1,"content"],[1,"card"],[1,"card-header","border-0"],[1,"card-title"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary"],[1,"fa","fa-plus"],[1,"card-tools"],[1,"input-group","input-group-sm",2,"width","250px"],[1,"form-control","float-right",2,"width","50px",3,"ngModelChange","ngModel"],["value","10"],["value","25"],["value","50"],["value","100"],["type","text","name","table_search","placeholder","Pesquisar...",1,"form-control","float-right",2,"width","200px",3,"ngModelChange","ngModel"],[1,"card-body","table-responsive","p-1"],[1,"table","table-hover","table-head-fixed","text-nowrap",3,"mfData","mfRowsOnPage"],["by","id"],["by","unidade.abreviatura"],["by","nome"],["by","abreviatura"],["colspan","100%"],[2,"display","flex","align-items","center","justify-content","center"],[3,"rowsOnPageSet"],["id","modalcad","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header","border-0"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"refresh"],["id","modaldel","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog"],[1,"optionshover"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-edit","text-primary"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-danger","ml-1"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-primary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"]],template:function(a,n){if(a&1){let u=E();t(0,"div",1),f(1,"app-title",2),t(2,"section",3)(3,"div",4)(4,"div",5)(5,"h3",6)(6,"button",7),f(7,"i",8),i()(),t(8,"div",9)(9,"div",10)(10,"select",11),I("ngModelChange",function(b){return v(u),D(n.quant,b)||(n.quant=b),g(b)}),t(11,"option",12),o(12,"10"),i(),t(13,"option",13),o(14,"25"),i(),t(15,"option",14),o(16,"50"),i(),t(17,"option",15),o(18,"100"),i()(),t(19,"input",16),I("ngModelChange",function(b){return v(u),D(n.pesquisa,b)||(n.pesquisa=b),g(b)}),h("ngModelChange",function(){return v(u),g(n.pesquisar())}),i()()()(),t(20,"div",17)(21,"table",18,0)(23,"thead")(24,"tr")(25,"th")(26,"mfDefaultSorter",19),o(27,"#"),i()(),t(28,"th")(29,"mfDefaultSorter",20),o(30,"Unidade"),i()(),t(31,"th")(32,"mfDefaultSorter",21),o(33,"Nome"),i()(),t(34,"th")(35,"mfDefaultSorter",22),o(36,"Abreviatura"),i()(),t(37,"th"),o(38,"Op\xE7\xF5es"),i()()(),N(39,we,4,1,"tbody"),t(40,"tfoot")(41,"tr")(42,"td",23)(43,"div",24),f(44,"mfBootstrapPaginator",25),i()()()()()()()(),t(45,"div",26)(46,"div",27)(47,"div",28)(48,"div",29)(49,"h4",30),o(50,"Cadastrar"),i(),t(51,"button",31)(52,"span",32),o(53,"\xD7"),i()()(),t(54,"div",33)(55,"app-subunidades-form",34),h("refresh",function(){return v(u),g(n.refresh())}),i()()()()(),t(56,"div",35)(57,"div",36)(58,"div",28)(59,"div",29)(60,"h4",30),o(61,"Excluir"),i(),t(62,"button",31)(63,"span",32),o(64,"\xD7"),i()()(),t(65,"div",33),N(66,$e,8,1),i()()()()()}a&2&&(s(10),F("ngModel",n.quant),s(9),F("ngModel",n.pesquisa),s(2),p("mfData",n.data$)("mfRowsOnPage",n.quant),s(18),L(39,n.data$?39:-1),s(5),p("rowsOnPageSet",G(7,xe)),s(22),L(66,n.excluir?66:-1))},dependencies:[w,oe,k,me,se,le,de,M,Z,ee,Q,Y,$,H]});let d=l;return d})();export{He as SubunidadesComponent};
