import{a as Ee}from"./chunk-VKRGKQX6.js";import{a as ye}from"./chunk-Y64AYFHZ.js";import{h as T}from"./chunk-NFMIVN66.js";import{a as be,b as Ce,c as ge,d as Se}from"./chunk-AICVXWQ6.js";import{a as xe}from"./chunk-I3SZ5FME.js";import{a as _e}from"./chunk-HYOWEGV7.js";import{a as ve}from"./chunk-3HEW5RTP.js";import{a as pe,b as ue}from"./chunk-UKCOEVIY.js";import{a as fe,d as he}from"./chunk-HDKAZCIU.js";import{$b as L,C as q,Ca as y,Ea as x,F as G,Fa as c,I as P,Ka as H,La as U,Ma as J,Na as K,Nb as te,O as v,Oa as o,P as b,Pa as u,Pb as m,Qb as I,Ra as X,Rb as ie,Sb as ae,Tb as oe,Ua as k,Va as O,Vb as ne,W as R,Wa as N,Wb as re,Xa as Y,Xb as le,Ya as A,Yb as se,Zb as de,_b as me,ac as ce,ca as d,cb as E,da as h,eb as w,l as B,la as C,na as S,rb as Z,sa as _,sb as $,ta as W,ua as z,va as Q,vb as ee,wa as i,xa as a,ya as f}from"./chunk-OWJSVT4P.js";var D=pe.url,M="policiais-atestados",F=(()=>{let l=class l{constructor(e){this.http=e}index(){return this.http.get(`${D}/${M}`)}find(e){return this.http.get(`${D}/${M}/${e}`)}create(e){return this.http.post(`${D}/${M}`,e)}update(e,t){return this.http.put(`${D}/${M}/${e}`,t)}remove(e){return this.http.delete(`${D}/${M}/${e}`)}};l.\u0275fac=function(t){return new(t||l)(G(ee))},l.\u0275prov=q({token:l,factory:l.\u0275fac,providedIn:"root"});let n=l;return n})();function Ae(n,l){if(n&1&&f(0,"input-select",2),n&2){let s=c();S("data$",s.policiais$)}}var j=(()=>{let l=class l{constructor(e,t,r,p){this.formBuilder=e,this.policiaisAtestadosService=t,this.policiaisService=r,this.toastr=p,this.refresh=new R}ngOnInit(){this.form=this.formBuilder.group({id:[null],policial:[null,m.compose([m.required])],data_inicial:[null,m.compose([m.required])],dias:[null,m.compose([m.required,m.min(1)])],data_final:[null],cid:[null,m.compose([m.maxLength(20)])],hospital:[null,m.compose([m.maxLength(100)])],crm:[null,m.compose([m.maxLength(20)])]}),this.subscription=this.policiaisService.disponiveis().subscribe({next:e=>{e.forEach(t=>{t.numeral?t.nome=`${t.graduacao.abreviatura} ${t.numeral} ${t.nome_guerra}, ${t.matricula}`:t.nome=`${t.graduacao.abreviatura} ${t.nome_guerra}, ${t.matricula}`}),this.policiais$=B(e)}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}cadastrar(){this.form.get("data_final")?.patchValue(this.dataFinal(this.form.value.data_inicial,Number(this.form.value.dias))),this.form.value.id?this.policiaisAtestadosService.update(this.form.value.id,this.form.value).subscribe({next:e=>{this.toastr.success("Edi\xE7\xE3o realizada com sucesso!"),this.form.reset(),this.refresh.emit()},error:e=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}):this.policiaisAtestadosService.create(this.form.value).subscribe({next:e=>{this.toastr.success("Cadastro realizado com sucesso!"),this.form.reset(),this.refresh.emit()},error:e=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}})}editar(e){this.form.patchValue(e),this.form.get("policial")?.patchValue(e.policial.id)}dataFinal(e,t){let r=new Date(e);return r.setDate(r.getDate()+t),Ee(r,"yyyy-MM-dd")}};l.\u0275fac=function(t){return new(t||l)(h(me),h(F),h(ye),h(T))},l.\u0275cmp=P({type:l,selectors:[["app-policiais-atestados-form"]],outputs:{refresh:"refresh"},standalone:!0,features:[A],decls:14,vars:3,consts:[[3,"formGroup"],[1,"row"],["label","Policial","id","policial","formControlName","policial",1,"col-sm-4",3,"data$"],["formControlName","data_inicial","label","Data Inical","id","data_inicial","tipo","date",1,"col-sm-2"],["formControlName","dias","label","Dias","id","dias","tipo","number",1,"col-sm-2"],["formControlName","cid","label","CID","id","cid","tipo","text",1,"col-sm-2"],["formControlName","hospital","label","Hospital","id","hospital","tipo","text",1,"col-sm-2"],["formControlName","crm","label","CRM","id","crm","tipo","text",1,"col-sm-2"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click","disabled"]],template:function(t,r){t&1&&(i(0,"form",0)(1,"div",1),C(2,Ae,1,1,"input-select",2),f(3,"input-text",3)(4,"input-text",4),a(),i(5,"div",1),f(6,"input-text",5)(7,"input-text",6)(8,"input-text",7),a(),i(9,"div",8)(10,"a",9),x("click",function(){return r.form.reset()}),o(11,"Cancelar"),a(),i(12,"button",10),x("click",function(){return r.cadastrar()}),o(13,"Cadastrar"),a()()()),t&2&&(S("formGroup",r.form),d(2),_(2,r.policiais$?2:-1),d(10),S("disabled",r.form.invalid))},dependencies:[$,L,oe,I,ie,ce,ne,re,_e,xe]});let n=l;return n})();function $e(n,l){n&1&&(i(0,"button",7),f(1,"i",41),a())}function Ie(n,l){if(n&1&&(o(0),E(1,"mask")),n&2){let s=c().$implicit;u(w(1,1,s.policial.numeral,"00.000"))}}function Le(n,l){if(n&1){let s=y();i(0,"a",45),x("click",function(){v(s);let t=c().$implicit,r=c(2);return b(r.editar(t))}),f(1,"i",46),a()}}function Te(n,l){if(n&1){let s=y();i(0,"a",47),x("click",function(){v(s);let t=c().$implicit,r=c(2);return b(r.delete(t))}),f(1,"i",48),a()}}function Fe(n,l){if(n&1&&(i(0,"tr",42)(1,"td"),o(2),a(),i(3,"td"),o(4),a(),i(5,"td"),o(6),a(),i(7,"td"),C(8,Ie,2,4),a(),i(9,"td"),o(10),a(),i(11,"td"),o(12),E(13,"mask"),a(),i(14,"td"),o(15),E(16,"date"),a(),i(17,"td"),o(18),a(),i(19,"td"),o(20),E(21,"date"),a(),i(22,"td"),o(23),a(),i(24,"td"),C(25,Le,2,0,"a",43)(26,Te,2,0,"a",44),a()()),n&2){let s=l.$implicit,e=c(2);d(2),u(s.id),d(2),X("",s.policial.setor.subunidade.abreviatura," - ",s.policial.setor.subunidade.unidade.abreviatura,""),d(2),u(s.policial.graduacao.nome),d(2),_(8,s.policial.numeral?8:-1),d(2),u(s.policial.nome_guerra),d(2),u(w(13,13,s.policial.matricula,"000.000-0-A")),d(3),u(w(16,16,s.data_inicial,"dd/MM/yyyy")),d(3),u(s.dias),d(2),u(w(21,19,s.data_final,"dd/MM/yyyy")),d(3),u(s.cid),d(2),_(25,e.user.perfil.policiais_atestados_edt?25:-1),d(),_(26,e.user.perfil.policiais_atestados_del?26:-1)}}function Ve(n,l){n&1&&(i(0,"tr")(1,"td",28),o(2,"Sem informa\xE7\xE3o"),a()())}function ke(n,l){if(n&1&&(i(0,"tbody"),z(1,Fe,27,22,"tr",42,W,!1,Ve,3,0,"tr"),a()),n&2){c();let s=K(21);d(),Q(s.data)}}function Oe(n,l){if(n&1){let s=y();o(0," Tem certeza que deseja excluir: "),i(1,"b"),o(2),a(),i(3,"div",49)(4,"a",50),o(5,"Cancelar"),a(),i(6,"button",51),x("click",function(){v(s);let t=c();return b(t.confirm())}),o(7," Excluir "),a()()}if(n&2){let s=c();d(2),u(s.excluir.policial.nome)}}var lt=(()=>{let l=class l{constructor(e,t,r){this.policiaisAtestadosService=e,this.toastr=t,this.sessionService=r,this.quant=10}ngOnInit(){this.user=this.sessionService.getUser(),this.sessionService.checkPermission("policiais_atestados"),this.subscription=this.policiaisAtestadosService.index().subscribe({next:e=>{this.data$=e,this.temp=e}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}refresh(){this.policiaisAtestadosService.index().subscribe({next:e=>{this.data$=e}})}editar(e){this.child.editar(e)}delete(e){this.excluir=e}confirm(){this.policiaisAtestadosService.remove(this.excluir.id||0).subscribe({next:e=>{this.toastr.success("Exclus\xE3o realizada com sucesso!"),this.refresh()},error:e=>{this.toastr.error("Erro ao excluir, tente novamente mais tarde!")}})}pesquisar(){if(this.data$=this.temp,this.pesquisa.length>0){var e=this.pesquisa.toLocaleLowerCase();this.data$=this.data$.filter(t=>t.policial.numeral?t.policial.numeral?.toLocaleLowerCase().indexOf(e)!==-1||t.policial.nome.toLocaleLowerCase().indexOf(e)!==-1||t.policial.nome_guerra.toLocaleLowerCase().indexOf(e)!==-1||t.policial.matricula.toLocaleLowerCase().indexOf(e)!==-1||t.policial.graduacao.nome.toLocaleLowerCase().indexOf(e)!==-1||t.policial.graduacao.abreviatura.toLocaleLowerCase().indexOf(e)!==-1||!e:t.policial.nome.toLocaleLowerCase().indexOf(e)!==-1||t.policial.nome_guerra.toLocaleLowerCase().indexOf(e)!==-1||t.policial.matricula.toLocaleLowerCase().indexOf(e)!==-1||t.policial.graduacao.nome.toLocaleLowerCase().indexOf(e)!==-1||t.policial.graduacao.abreviatura.toLocaleLowerCase().indexOf(e)!==-1||!e)}}};l.\u0275fac=function(t){return new(t||l)(h(F),h(T),h(ue))},l.\u0275cmp=P({type:l,selectors:[["app-policiais-atestados"]],viewQuery:function(t,r){if(t&1&&H(j,5),t&2){let p;U(p=J())&&(r.child=p.first)}},standalone:!0,features:[Y([fe()]),A],decls:84,vars:9,consts:[["mf","mfDataTable"],[1,"content-wrapper"],["titulo","Atestados"],[1,"content"],[1,"card"],[1,"card-header","border-0"],[1,"card-title"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary"],[1,"card-tools"],[1,"input-group","input-group-sm",2,"width","250px"],[1,"form-control","float-right",2,"width","50px",3,"ngModelChange","ngModel"],["value","10"],["value","25"],["value","50"],["value","100"],["type","text","name","table_search","placeholder","Pesquisar...",1,"form-control","float-right",2,"width","200px",3,"ngModelChange","ngModel"],[1,"card-body","table-responsive","p-1"],[1,"table","table-hover","table-head-fixed","text-nowrap",3,"mfData","mfRowsOnPage","mfSortBy","mfSortOrder"],["by","id"],["by","policial.setor.subunidade.abreviatura"],["by","policial.graduacao.nome"],["by","policial.numeral"],["by","policial.nome_guerra"],["by","policial.matricula"],["by","data_inicial"],["by","dias"],["by","dataFinal(data_inicial, dias)"],["by","cid"],["colspan","100%"],[2,"display","flex","align-items","center","justify-content","center"],["id","modalcad","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header","border-0"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"refresh"],["id","modaldel","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog"],[1,"fa","fa-plus"],[1,"optionshover"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-edit","text-primary"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-danger","ml-1"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-primary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"]],template:function(t,r){if(t&1){let p=y();i(0,"div",1),f(1,"app-title",2),i(2,"section",3)(3,"div",4)(4,"div",5)(5,"h3",6),C(6,$e,2,0,"button",7),a(),i(7,"div",8)(8,"div",9)(9,"select",10),N("ngModelChange",function(g){return v(p),O(r.quant,g)||(r.quant=g),b(g)}),i(10,"option",11),o(11,"10"),a(),i(12,"option",12),o(13,"25"),a(),i(14,"option",13),o(15,"50"),a(),i(16,"option",14),o(17,"100"),a()(),i(18,"input",15),N("ngModelChange",function(g){return v(p),O(r.pesquisa,g)||(r.pesquisa=g),b(g)}),x("ngModelChange",function(){return v(p),b(r.pesquisar())}),a()()()(),i(19,"div",16)(20,"table",17,0)(22,"thead")(23,"tr")(24,"th")(25,"mfDefaultSorter",18),o(26,"#"),a()(),i(27,"th")(28,"mfDefaultSorter",19),o(29,"Subunidade"),a()(),i(30,"th")(31,"mfDefaultSorter",20),o(32,"Gradua\xE7\xE3o"),a()(),i(33,"th")(34,"mfDefaultSorter",21),o(35,"Numeral"),a()(),i(36,"th")(37,"mfDefaultSorter",22),o(38,"Nome Guerra"),a()(),i(39,"th")(40,"mfDefaultSorter",23),o(41,"Matr\xEDcula"),a()(),i(42,"th")(43,"mfDefaultSorter",24),o(44,"Data Inicial"),a()(),i(45,"th")(46,"mfDefaultSorter",25),o(47,"Dias"),a()(),i(48,"th")(49,"mfDefaultSorter",26),o(50,"Data Final"),a()(),i(51,"th")(52,"mfDefaultSorter",27),o(53,"CID"),a()(),i(54,"th"),o(55,"Op\xE7\xF5es"),a()()(),C(56,ke,4,1,"tbody"),i(57,"tfoot")(58,"tr")(59,"td",28)(60,"div",29),f(61,"mfBootstrapPaginator"),a()()()()()()()(),i(62,"div",30)(63,"div",31)(64,"div",32)(65,"div",33)(66,"h4",34),o(67,"Cadastrar"),a(),i(68,"button",35)(69,"span",36),o(70,"\xD7"),a()()(),i(71,"div",37)(72,"app-policiais-atestados-form",38),x("refresh",function(){return v(p),b(r.refresh())}),a()()()()(),i(73,"div",39)(74,"div",40)(75,"div",32)(76,"div",33)(77,"h4",34),o(78,"Excluir"),a(),i(79,"button",35)(80,"span",36),o(81,"\xD7"),a()()(),i(82,"div",37),C(83,Oe,8,1),a()()()()()}t&2&&(d(6),_(6,r.user.perfil.policiais_atestados_cad?6:-1),d(3),k("ngModel",r.quant),d(9),k("ngModel",r.pesquisa),d(2),S("mfData",r.data$)("mfRowsOnPage",r.quant)("mfSortBy","id")("mfSortOrder","desc"),d(36),_(56,r.data$?56:-1),d(27),_(83,r.excluir?83:-1))},dependencies:[$,Z,ve,j,Se,be,ge,Ce,L,se,de,te,le,I,ae,he]});let n=l;return n})();export{lt as PoliciaisAtestadosComponent};
