import{a as ye}from"./chunk-JKRXANFS.js";import{a as Ee}from"./chunk-P4DI7BWX.js";import{a as xe}from"./chunk-ND3MOVSE.js";import{a as Se}from"./chunk-DREWBI5U.js";import{a as ge}from"./chunk-KRDV4FRY.js";import{a as Ce}from"./chunk-A6GCQO25.js";import{h as k}from"./chunk-NFMIVN66.js";import{a as F}from"./chunk-SFM735GE.js";import{a as _e,b as he,c as ve,d as be}from"./chunk-AICVXWQ6.js";import{a as pe}from"./chunk-I3SZ5FME.js";import{a as B}from"./chunk-HYOWEGV7.js";import{a as fe}from"./chunk-3HEW5RTP.js";import{b as O}from"./chunk-UKCOEVIY.js";import"./chunk-HDKAZCIU.js";import{$b as A,Ca as E,Ea as p,Fa as _,Fb as oe,I as y,Ib as me,Ka as R,La as G,Ma as W,Na as ie,Nb as I,O as v,Oa as a,P as b,Pa as C,Pb as d,Qb as M,Ra as ae,Rb as q,Sb as le,Tb as j,Ua as z,Ub as se,Va as U,Vb as $,W as w,Wa as H,Wb as N,Xb as de,Ya as T,Yb as ce,Zb as ue,_a as ne,_b as L,ac as Q,ca as l,cb as J,da as c,eb as K,l as P,la as g,na as h,rb as re,sa as x,sb as V,ta as Z,ua as ee,va as te,wa as e,xa as t,ya as u}from"./chunk-OWJSVT4P.js";function Ie(o,s){o&1&&u(0,"input-text",8)}var X=(()=>{let s=class s{constructor(i,n,r,f,D,S,Ae,ke,Fe){this.formBuilder=i,this.armamentosService=n,this.armamentosTiposService=r,this.armamanetosTamanhosService=f,this.armamentosCalibresService=D,this.sessionService=S,this.marcasService=Ae,this.modelosService=ke,this.toastr=Fe,this.editando=!1,this.refresh=new w,this.cancel=new w}ngOnInit(){this.form=this.formBuilder.group({id:[null],serial:[null,d.compose([d.required,d.minLength(5),d.maxLength(100)])],quantidade:[null,d.compose([d.min(1),d.required])],data_validade:[null],data_baixa:[null],observacoes:[null],marca:[null,d.compose([d.required])],modelo:[null,d.compose([d.required])],armamento_tipo:[null,d.compose([d.required])],armamento_calibre:[null],armamento_tamanho:[null],subunidade:[null]}),this.marcas$=this.marcasService.marcasArmamentos(),this.armamentostipos$=this.armamentosTiposService.index()}cadastrar(){delete this.form.value.unidade,delete this.form.value.marca,this.form.value.id?(this.form.value.data_baixa||this.form.get("data_baixa")?.patchValue(null),this.form.value.data_validade||this.form.get("data_validade")?.patchValue(null),delete this.form.value.marca,this.armamentosService.update(this.form.value.id,this.form.value).subscribe({next:i=>{this.toastr.success("Edi\xE7\xE3o realizada com sucesso!"),this.form.reset(),this.refresh.emit(),this.editando=!1},error:i=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}})):(this.sessionService.getSubunidade()?this.form.get("subunidade")?.patchValue(this.sessionService.getSubunidade()):this.toastr.error("Selecione uma subunidade!"),this.armamentosService.create(this.form.value).subscribe({next:i=>{this.toastr.success("Cadastro realizado com sucesso!"),this.form.reset(),this.refresh.emit()},error:i=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}))}editar(i){this.editando=!0,this.form.patchValue(i),i.modelo&&(this.form.get("marca")?.patchValue(i.modelo.marca.id),this.form.get("modelo")?.patchValue(i.modelo.id),this.getModelos()),i.armamento_tipo&&this.form.get("armamento_tipo")?.patchValue(i.armamento_tipo.id),i.armamento_tamanho&&this.form.get("armamento_tamanho")?.patchValue(i.armamento_tamanho.id),i.armamento_calibre&&this.form.get("armamento_calibre")?.patchValue(i.armamento_calibre.id)}cancelar(){this.form.reset(),this.cancel.emit()}resetForm(){this.form.reset(),this.editando=!1}getModelos(){this.modelos$=this.modelosService.whereMarca(this.form.get("marca")?.value)}getTamCal(){this.armamentostipos$.subscribe(i=>{i.forEach(n=>{n.id==this.form.value.armamento_tipo&&(n.calibres?(this.armamentoscalibres$=this.armamentosCalibresService.index(),this.armamentostamanhos$=P()):(this.armamentostamanhos$=this.armamanetosTamanhosService.index(),this.armamentoscalibres$=P()))})})}};s.\u0275fac=function(n){return new(n||s)(c(L),c(F),c(xe),c(Se),c(ge),c(O),c(Ee),c(ye),c(k))},s.\u0275cmp=y({type:s,selectors:[["app-armamentos-form"]],outputs:{refresh:"refresh",cancel:"cancel"},standalone:!0,features:[T],decls:20,vars:8,consts:[[3,"formGroup"],[1,"row"],["label","Marca","id","marca","formControlName","marca",1,"col-sm-2",3,"ngModelChange","data$"],["label","Modelo","id","modelo","formControlName","modelo",1,"col-sm-2",3,"data$"],["label","Tipo","id","armamento_tipo","formControlName","armamento_tipo",1,"col-sm-2",3,"ngModelChange","data$"],["formControlName","serial","label","Serial","id","serial","tipo","text",1,"col-sm-2"],["label","Calibre","id","armamento_calibre","formControlName","armamento_calibre",1,"col-sm-2",3,"data$"],["label","Tamanho","id","armamento_tamanho","formControlName","armamento_tamanho",1,"col-sm-2",3,"data$"],["formControlName","quantidade","label","Quantidade","id","quantidade","tipo","number",1,"col-sm-2"],["formControlName","data_validade","label","Data Validade","id","data_validade","tipo","date",1,"col-sm-2"],["formControlName","data_baixa","label","Data Baixa","id","data_baixa","tipo","date",1,"col-sm-2"],[1,"row",2,"height","350px"],["formControlName","observacoes","label","Observa\xE7\xF5es","id","observacoes",1,"col-sm-12"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click","disabled"]],template:function(n,r){n&1&&(e(0,"form",0)(1,"div",1)(2,"input-select",2),p("ngModelChange",function(){return r.getModelos()}),t(),u(3,"input-select",3),e(4,"input-select",4),p("ngModelChange",function(){return r.getTamCal()}),t(),u(5,"input-text",5),t(),e(6,"div",1),u(7,"input-select",6)(8,"input-select",7),g(9,Ie,1,0,"input-text",8),t(),e(10,"div",1),u(11,"input-text",9)(12,"input-text",10),t(),e(13,"div",11),u(14,"input-textarea",12),t(),e(15,"div",13)(16,"a",14),p("click",function(){return r.cancelar()}),a(17,"Cancelar"),t(),e(18,"button",15),p("click",function(){return r.cadastrar()}),a(19," Cadastrar "),t()()()),n&2&&(h("formGroup",r.form),l(2),h("data$",r.marcas$),l(),h("data$",r.modelos$),l(),h("data$",r.armamentostipos$),l(3),h("data$",r.armamentoscalibres$),l(),h("data$",r.armamentostamanhos$),l(),x(9,r.editando?-1:9),l(9),h("disabled",r.form.invalid))},dependencies:[V,A,j,M,q,Q,$,N,B,pe,Ce]});let o=s;return o})();var Y=(()=>{let s=class s{constructor(i,n,r){this.formBuilder=i,this.armamentosService=n,this.toastr=r,this.editando=!1,this.refresh=new w,this.cancel=new w}ngOnInit(){this.form=this.formBuilder.group({id:[null],quantidade:[null,d.compose([d.required,d.min(1)])],tipo:[null,d.compose([d.required])]})}cadastrar(){this.form.get("id")?.patchValue(this.armamento),this.armamentosService.ajustarQuantidade(this.form.value.id,this.form.value).subscribe({next:i=>{this.toastr.success("Edi\xE7\xE3o realizada com sucesso!"),this.form.reset(),this.refresh.emit(),this.editando=!1},error:i=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}})}cancelar(){this.form.reset(),this.cancel.emit()}resetForm(){this.form.reset(),this.editando=!1}};s.\u0275fac=function(n){return new(n||s)(c(L),c(F),c(k))},s.\u0275cmp=y({type:s,selectors:[["app-armamentos-form-quantidade"]],inputs:{armamento:"armamento"},outputs:{refresh:"refresh",cancel:"cancel"},standalone:!0,features:[T],decls:21,vars:2,consts:[[3,"formGroup"],[1,"row"],["formControlName","quantidade","label","Quantidade","id","quantidade","tipo","number",1,"col-sm-2"],[1,"col-sm-4"],[1,"form-group"],["for","inputSuccess",1,"col-form-label"],[1,"form-check"],["value","1","type","radio","name","tipo","formControlName","tipo","checked","",1,"form-check-input"],[1,"form-check-label"],["value","2","type","radio","name","tipo","formControlName","tipo",1,"form-check-input"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click","disabled"]],template:function(n,r){n&1&&(e(0,"form",0)(1,"div",1),u(2,"input-text",2),e(3,"div",3)(4,"div",4)(5,"label",5),a(6,"Tipo"),t(),e(7,"div",4)(8,"div",6),u(9,"input",7),e(10,"label",8),a(11,"Para mais"),t()(),e(12,"div",6),u(13,"input",9),e(14,"label",8),a(15,"Para menos"),t()()()()()(),e(16,"div",10)(17,"a",11),p("click",function(){return r.cancelar()}),a(18,"Cancelar"),t(),e(19,"button",12),p("click",function(){return r.cadastrar()}),a(20," Cadastrar "),t()()()),n&2&&(h("formGroup",r.form),l(19),h("disabled",r.form.invalid))},dependencies:[V,A,j,I,se,M,q,Q,$,N,B]});let o=s;return o})();var qe=o=>["/Armamento",o];function je(o,s){if(o&1){let m=E();e(0,"button",45),p("click",function(){v(m);let n=_();return b(n.cadastrar())}),u(1,"i",46),t()}}function $e(o,s){if(o&1){let m=E();e(0,"a",52),p("click",function(){v(m);let n=_().$implicit,r=_(2);return b(r.ajustquant(n))}),u(1,"i",53),t()}}function Ne(o,s){if(o&1){let m=E();e(0,"a",54),p("click",function(){v(m);let n=_().$implicit,r=_(2);return b(r.editar(n))}),u(1,"i",55),t()}}function Le(o,s){if(o&1){let m=E();e(0,"a",56),p("click",function(){v(m);let n=_().$implicit,r=_(2);return b(r.delete(n))}),u(1,"i",57),t()}}function Qe(o,s){if(o&1&&(e(0,"tr",47)(1,"td"),a(2),t(),e(3,"td"),a(4),t(),e(5,"td"),a(6),t(),e(7,"td"),a(8),t(),e(9,"td"),a(10),t(),e(11,"td"),a(12),t(),e(13,"td"),a(14),t(),e(15,"td")(16,"a",48),a(17),t()(),e(18,"td"),a(19),t(),e(20,"td"),a(21),t(),e(22,"td"),a(23),J(24,"date"),t(),e(25,"td"),a(26),J(27,"date"),t(),e(28,"td"),g(29,$e,2,0,"a",49)(30,Ne,2,0,"a",50)(31,Le,2,0,"a",51),t()()),o&2){let m=s.$implicit,i=_(2);l(2),C(m.id),l(2),ae("",m.subunidade.abreviatura," - ",m.subunidade.unidade.abreviatura,""),l(2),C(m.armamento_tipo.nome),l(2),C(m.modelo.marca.nome),l(2),C(m.modelo.nome),l(2),C(m.armamento_calibre==null?null:m.armamento_calibre.nome),l(2),C(m.armamento_tamanho==null?null:m.armamento_tamanho.nome),l(2),h("routerLink",ne(23,qe,m.id)),l(),C(m.serial),l(2),C(m.quantidade),l(2),C(m.quantidade_disponivel),l(2),C(K(24,17,m.data_validade,"dd/MM/yyyy")),l(3),C(K(27,20,m.data_baixa,"dd/MM/yyyy")),l(3),x(29,i.user.perfil.armamentos_edt&&i.user.perfil.gestor?29:-1),l(),x(30,i.user.perfil.armamentos_edt?30:-1),l(),x(31,i.user.perfil.armamentos_del?31:-1)}}function Oe(o,s){o&1&&(e(0,"tr")(1,"td",30),a(2,"Sem informa\xE7\xE3o"),t()())}function Be(o,s){if(o&1&&(e(0,"tbody"),ee(1,Qe,32,25,"tr",47,Z,!1,Oe,3,0,"tr"),t()),o&2){_();let m=ie(21);l(),te(m.data)}}function Pe(o,s){if(o&1){let m=E();e(0,"app-armamentos-form",58),p("refresh",function(){v(m);let n=_();return b(n.refresh())})("cancel",function(){v(m);let n=_();return b(n.cancel())}),t()}}function Re(o,s){if(o&1){let m=E();a(0," Tem certeza que deseja excluir: "),e(1,"b"),a(2),t(),e(3,"div",59)(4,"a",60),a(5,"Cancelar"),t(),e(6,"button",61),p("click",function(){v(m);let n=_();return b(n.confirm())}),a(7," Excluir "),t()()}if(o&2){let m=_();l(2),C(m.excluir.serial)}}function Ge(o,s){if(o&1){let m=E();e(0,"app-armamentos-form-quantidade",62),p("refresh",function(){v(m);let n=_();return b(n.refresh())})("cancel",function(){v(m);let n=_();return b(n.cancel())}),t()}if(o&2){let m=_();h("armamento",m.ajustarm.id||0)}}var Mt=(()=>{let s=class s{constructor(i,n,r){this.armamentosService=i,this.toastr=n,this.sessionService=r,this.quant=10,this.cadastrando=!1}ngOnInit(){this.user=this.sessionService.getUser(),this.sessionService.checkPermission("armamentos"),this.subscription=this.armamentosService.index().subscribe({next:i=>{this.data$=i,this.temp=i}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}refresh(){this.cadastrando=!1,this.armamentosService.index().subscribe({next:i=>{this.data$=i}})}cadastrar(){this.cadastrando=!0,setTimeout(()=>{this.child.resetForm()},100)}cancel(){this.cadastrando=!1}editar(i){this.cadastrando=!0,setTimeout(()=>{this.child.editar(i)},100)}delete(i){this.excluir=i}confirm(){this.armamentosService.remove(this.excluir.id||0).subscribe({next:i=>{this.toastr.success("Exclus\xE3o realizada com sucesso!"),this.refresh()},error:i=>{this.toastr.error("Erro ao excluir, tente novamente mais tarde!")}})}ajustquant(i){this.ajustarm=i}pesquisar(){if(this.data$=this.temp,this.pesquisa.length>0){var i=this.pesquisa.toLocaleLowerCase();this.data$=this.data$.filter(n=>n.serial.toLocaleLowerCase().indexOf(i)!==-1||n.modelo.nome.toLocaleLowerCase().indexOf(i)!==-1||n.modelo.marca.nome.toLocaleLowerCase().indexOf(i)!==-1||n.armamento_tipo.nome.toLocaleLowerCase().indexOf(i)!==-1||!i)}}};s.\u0275fac=function(n){return new(n||s)(c(F),c(k),c(O))},s.\u0275cmp=y({type:s,selectors:[["app-armamentos"]],viewQuery:function(n,r){if(n&1&&(R(X,5),R(Y,5)),n&2){let f;G(f=W())&&(r.child=f.first),G(f=W())&&(r.childQuant=f.first)}},standalone:!0,features:[T],decls:101,vars:9,consts:[["mf","mfDataTable"],[1,"content-wrapper"],["titulo","Armamentos"],[1,"content"],[1,"card"],[1,"card-header","border-0"],[1,"card-title"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary"],[1,"card-tools"],[1,"input-group","input-group-sm",2,"width","250px"],[1,"form-control","float-right",2,"width","50px",3,"ngModelChange","ngModel"],["value","10"],["value","25"],["value","50"],["value","100"],["type","text","name","table_search","placeholder","Pesquisar...",1,"form-control","float-right",2,"width","200px",3,"ngModelChange","ngModel"],[1,"card-body","table-responsive","p-1"],[1,"table","table-hover","table-head-fixed","text-nowrap",3,"mfData","mfRowsOnPage"],["by","id"],["by","subunidade.abreviatura"],["by","armamento_tipo.nome"],["by","modelo.marca.nome"],["by","modelo.nome"],["by","armamento_calibre?.nome"],["by","armamento_tamanho?.nome"],["by","serial"],["by","quantidade"],["by","quantidade_disponivel"],["by","data_validade"],["by","data_baixa"],["colspan","100%"],[2,"display","flex","align-items","center","justify-content","center"],["id","modalcad","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header","border-0"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],["id","modaldel","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["id","modalajust","aria-hidden","true",1,"modal","fade",2,"display","none"],[3,"armamento"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary",3,"click"],[1,"fa","fa-plus"],[1,"optionshover"],[3,"routerLink"],["title","Ajustar Quantidade","data-bs-toggle","modal","data-bs-target","#modalajust",1,"options","point"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point","ml-1"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point","ml-1"],["title","Ajustar Quantidade","data-bs-toggle","modal","data-bs-target","#modalajust",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-refresh","text-primary"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point","ml-1",3,"click"],["aria-hidden","true",1,"fa","fa-edit","text-primary"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point","ml-1",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-danger"],[3,"refresh","cancel"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-primary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"],[3,"refresh","cancel","armamento"]],template:function(n,r){if(n&1){let f=E();e(0,"div",1),u(1,"app-title",2),e(2,"section",3)(3,"div",4)(4,"div",5)(5,"h3",6),g(6,je,2,0,"button",7),t(),e(7,"div",8)(8,"div",9)(9,"select",10),H("ngModelChange",function(S){return v(f),U(r.quant,S)||(r.quant=S),b(S)}),e(10,"option",11),a(11,"10"),t(),e(12,"option",12),a(13,"25"),t(),e(14,"option",13),a(15,"50"),t(),e(16,"option",14),a(17,"100"),t()(),e(18,"input",15),H("ngModelChange",function(S){return v(f),U(r.pesquisa,S)||(r.pesquisa=S),b(S)}),p("ngModelChange",function(){return v(f),b(r.pesquisar())}),t()()()(),e(19,"div",16)(20,"table",17,0)(22,"thead")(23,"tr")(24,"th")(25,"mfDefaultSorter",18),a(26,"#"),t()(),e(27,"th")(28,"mfDefaultSorter",19),a(29,"Subunidade"),t()(),e(30,"th")(31,"mfDefaultSorter",20),a(32,"Tipo"),t()(),e(33,"th")(34,"mfDefaultSorter",21),a(35,"Marca"),t()(),e(36,"th")(37,"mfDefaultSorter",22),a(38,"Modelo"),t()(),e(39,"th")(40,"mfDefaultSorter",23),a(41,"Calibre"),t()(),e(42,"th")(43,"mfDefaultSorter",24),a(44,"Tamanho"),t()(),e(45,"th")(46,"mfDefaultSorter",25),a(47,"Serial"),t()(),e(48,"th")(49,"mfDefaultSorter",26),a(50,"Quantidade"),t()(),e(51,"th")(52,"mfDefaultSorter",27),a(53,"Quantidade Dispon\xEDvel"),t()(),e(54,"th")(55,"mfDefaultSorter",28),a(56,"Dt. Validade"),t()(),e(57,"th")(58,"mfDefaultSorter",29),a(59,"Dt. Baixa"),t()(),e(60,"th"),a(61,"Op\xE7\xF5es"),t()()(),g(62,Be,4,1,"tbody"),e(63,"tfoot")(64,"tr")(65,"td",30)(66,"div",31),u(67,"mfBootstrapPaginator"),t()()()()()()()(),e(68,"div",32)(69,"div",33)(70,"div",34)(71,"div",35)(72,"h4",36),a(73,"Cadastrar"),t(),e(74,"button",37),p("click",function(){return v(f),b(r.cadastrando=!1)}),e(75,"span",38),a(76,"\xD7"),t()()(),e(77,"div",39),g(78,Pe,1,0,"app-armamentos-form"),t()()()(),e(79,"div",40)(80,"div",41)(81,"div",34)(82,"div",35)(83,"h4",36),a(84,"Excluir"),t(),e(85,"button",42)(86,"span",38),a(87,"\xD7"),t()()(),e(88,"div",39),g(89,Re,8,1),t()()()(),e(90,"div",43)(91,"div",33)(92,"div",34)(93,"div",35)(94,"h4",36),a(95,"Ajustar quantidade"),t(),e(96,"button",42)(97,"span",38),a(98,"\xD7"),t()()(),e(99,"div",39),g(100,Ge,1,1,"app-armamentos-form-quantidade",44),t()()()()()}n&2&&(l(6),x(6,r.user.perfil.armamentos_cad?6:-1),l(3),z("ngModel",r.quant),l(9),z("ngModel",r.pesquisa),l(2),h("mfData",r.data$)("mfRowsOnPage",r.quant),l(42),x(62,r.data$?62:-1),l(16),x(78,r.cadastrando?78:-1),l(11),x(89,r.excluir?89:-1),l(11),x(100,r.ajustarm?100:-1))},dependencies:[V,re,fe,X,Y,be,_e,ve,he,A,ce,ue,I,de,M,le,me,oe]});let o=s;return o})();export{Mt as ArmamentosComponent};
