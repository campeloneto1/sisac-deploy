import{a as be}from"./chunk-VOV5UOCH.js";import{a as k}from"./chunk-2CP3JYT6.js";import{a as xe}from"./chunk-DTE4J6WV.js";import{a as _e}from"./chunk-5OALEDWI.js";import{h as T}from"./chunk-NFMIVN66.js";import{a as fe,b as he,c as ge,d as ve}from"./chunk-AICVXWQ6.js";import{a as pe}from"./chunk-I3SZ5FME.js";import{a as ce}from"./chunk-HYOWEGV7.js";import{a as ue}from"./chunk-3HEW5RTP.js";import{b as N}from"./chunk-4366GPH2.js";import{a as me,d as de}from"./chunk-HDKAZCIU.js";import{$b as L,Ca as E,Ea as f,Fa as _,Fb as U,I as S,Ib as X,Ka as G,La as z,Ma as Q,Na as A,Nb as Y,O as v,Oa as o,P as x,Pa as b,Pb as n,Qb as M,Ra as J,Rb as Z,Sb as ee,Tb as te,Ua as F,Va as j,Vb as ie,W as q,Wa as I,Wb as re,Xa as H,Xb as ne,Ya as y,Yb as ae,Zb as oe,_a as K,_b as se,ac as le,ca as l,cb as $,da as p,eb as O,la as V,na as g,sa as D,sb as w,ta as B,ua as R,va as W,wa as e,xa as t,ya as u}from"./chunk-OWJSVT4P.js";var P=(()=>{let m=class m{constructor(i,a,r,c,C,h,Ce){this.formBuilder=i,this.paisesService=a,this.estadosService=r,this.cidadesService=c,this.empresasService=C,this.toastr=h,this.sessionService=Ce,this.refresh=new q}ngOnInit(){this.form=this.formBuilder.group({id:[null],nome:[null,n.compose([n.required,n.minLength(5),n.maxLength(100)])],nome_fantasia:[null,n.compose([n.minLength(5),n.maxLength(100)])],cnpj:[null,n.compose([n.maxLength(15),n.required])],telefone1:[null,n.compose([n.minLength(11),n.maxLength(11)])],telefone2:[null,n.compose([n.minLength(11),n.maxLength(11)])],email:[null,n.compose([n.maxLength(100),n.email])],gerente:[null,n.compose([n.minLength(5),n.maxLength(100)])],rua:[null,n.compose([n.maxLength(100)])],numero:[null,n.compose([n.maxLength(20)])],bairro:[null,n.compose([n.maxLength(100)])],cep:[null,n.compose([n.maxLength(8)])],pais:[null],estado:[null],cidade:[null],subunidade:[null]}),this.paises$=this.paisesService.index()}ngOnDestroy(){}cadastrar(){delete this.form.value.pais,delete this.form.value.estado,this.form.value.id?this.empresasService.update(this.form.value.id,this.form.value).subscribe({next:i=>{this.toastr.success("Edi\xE7\xE3o realizada com sucesso!"),this.form.reset(),this.refresh.emit()},error:i=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}):(this.sessionService.getSubunidade()?this.form.get("subunidade")?.patchValue(this.sessionService.getSubunidade()):this.toastr.error("Selecione uma subunidade!"),this.empresasService.create(this.form.value).subscribe({next:i=>{this.toastr.success("Cadastro realizado com sucesso!"),this.form.reset(),this.refresh.emit()},error:i=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}))}editar(i){this.form.patchValue(i),i.cidade&&(this.form.get("pais")?.patchValue(i.cidade.estado.pais.id),this.form.get("estado")?.patchValue(i.cidade.estado.id),this.form.get("cidade")?.patchValue(i.cidade.id),this.getEstados(),this.getCidades())}getEstados(){this.estados$=this.estadosService.wherePais(this.form.get("pais")?.value)}getCidades(){this.cidades$=this.cidadesService.whereEstado(this.form.get("estado")?.value)}};m.\u0275fac=function(a){return new(a||m)(p(se),p(be),p(_e),p(xe),p(k),p(T),p(N))},m.\u0275cmp=S({type:m,selectors:[["app-empresas-form"]],outputs:{refresh:"refresh"},standalone:!0,features:[y],decls:22,vars:5,consts:[[3,"formGroup"],[1,"row"],["formControlName","nome","label","Nome","id","nome","tipo","text",1,"col-sm-4"],["formControlName","cnpj","label","CNPJ","id","cnpj","tipo","text","mascara","00.000.000/0000-00",1,"col-sm-4"],["formControlName","gerente","label","Gerente","id","gerente","tipo","text",1,"col-sm-4"],["mascara","(00) 00000-0000","formControlName","telefone1","label","Telefone 1","id","telefone1","tipo","text",1,"col-sm-2"],["mascara","(00) 00000-0000","formControlName","telefone2","label","Telefone 2","id","telefone2","tipo","text",1,"col-sm-2"],["formControlName","email","label","E-mail","id","email","tipo","email",1,"col-sm-4"],["formControlName","rua","label","Rua","id","rua","tipo","text",1,"col-sm-4"],["formControlName","numero","label","N\xFAmero","id","numero","tipo","text",1,"col-sm-2"],["formControlName","bairro","label","Bairro","id","bairro","tipo","text",1,"col-sm-4"],["label","Pa\xEDs","id","pais","formControlName","pais",1,"col-sm-2",3,"ngModelChange","data$"],["label","Estado","id","estado","formControlName","estado",1,"col-sm-2",3,"ngModelChange","data$"],["label","Cidade","id","cidade","formControlName","cidade",1,"col-sm-2",3,"data$"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click","disabled"]],template:function(a,r){a&1&&(e(0,"form",0)(1,"div",1),u(2,"input-text",2)(3,"input-text",3),t(),e(4,"div",1),u(5,"input-text",4)(6,"input-text",5)(7,"input-text",6)(8,"input-text",7),t(),e(9,"div",1),u(10,"input-text",8)(11,"input-text",9)(12,"input-text",10),t(),e(13,"div",1)(14,"input-select",11),f("ngModelChange",function(){return r.getEstados()}),t(),e(15,"input-select",12),f("ngModelChange",function(){return r.getCidades()}),t(),u(16,"input-select",13),t(),e(17,"div",14)(18,"a",15),f("click",function(){return r.form.reset()}),o(19,"Cancelar"),t(),e(20,"button",16),f("click",function(){return r.cadastrar()}),o(21," Cadastrar "),t()()()),a&2&&(g("formGroup",r.form),l(14),g("data$",r.paises$),l(),g("data$",r.estados$),l(),g("data$",r.cidades$),l(4),g("disabled",r.form.invalid))},dependencies:[w,L,te,M,Z,le,ie,re,ce,pe]});let s=m;return s})();var Le=s=>["/Empresa",s];function Ne(s,m){if(s&1){let d=E();e(0,"tr",37)(1,"td"),o(2),t(),e(3,"td"),o(4),t(),e(5,"td")(6,"a",38),o(7),t()(),e(8,"td"),o(9),$(10,"mask"),t(),e(11,"td"),o(12),$(13,"mask"),t(),e(14,"td")(15,"a",39),f("click",function(){let a=v(d).$implicit,r=_(2);return x(r.editar(a))}),u(16,"i",40),t(),e(17,"a",41),f("click",function(){let a=v(d).$implicit,r=_(2);return x(r.delete(a))}),u(18,"i",42),t()()()}if(s&2){let d=m.$implicit;l(2),b(d.id),l(2),J("",d.subunidade.abreviatura," - ",d.subunidade.unidade.abreviatura,""),l(2),g("routerLink",K(13,Le,d.id)),l(),b(d.nome),l(2),b(O(10,7,d.cnpj,"00.000.000/0000-00")),l(3),b(O(13,10,d.telefone1,"(00) 00000-0000"))}}function Te(s,m){s&1&&(e(0,"tr")(1,"td",24),o(2,"Sem informa\xE7\xE3o"),t()())}function ke(s,m){if(s&1&&(e(0,"tbody"),R(1,Ne,19,15,"tr",37,B,!1,Te,3,0,"tr"),t()),s&2){_();let d=A(22);l(),W(d.data)}}function Ve(s,m){if(s&1){let d=E();o(0," Tem certeza que deseja excluir: "),e(1,"b"),o(2),t(),e(3,"div",43)(4,"a",44),o(5,"Cancelar"),t(),e(6,"button",45),f("click",function(){v(d);let a=_();return x(a.confirm())}),o(7," Excluir "),t()()}if(s&2){let d=_();l(2),b(d.excluir.nome)}}var Ze=(()=>{let m=class m{constructor(i,a,r){this.empresasService=i,this.toastr=a,this.sessionService=r,this.quant=10}ngOnInit(){this.sessionService.checkPermission("empresas"),this.subscription=this.empresasService.index().subscribe({next:i=>{this.data$=i,this.temp=i}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}refresh(){this.empresasService.index().subscribe({next:i=>{this.data$=i}})}editar(i){this.child.editar(i)}delete(i){this.excluir=i}confirm(){this.empresasService.remove(this.excluir.id||0).subscribe({next:i=>{this.toastr.success("Exclus\xE3o realizada com sucesso!"),this.refresh()},error:i=>{this.toastr.error("Erro ao excluir, tente novamente mais tarde!")}})}pesquisar(){if(this.data$=this.temp,this.pesquisa.length>0){var i=this.pesquisa.toLocaleLowerCase();this.data$=this.data$.filter(a=>a.nome_fantasia?a.nome.toLocaleLowerCase().indexOf(i)!==-1||a.cnpj.toLocaleLowerCase().indexOf(i)!==-1||a.nome_fantasia.toLocaleLowerCase().indexOf(i)!==-1||!i:a.nome.toLocaleLowerCase().indexOf(i)!==-1||a.cnpj.toLocaleLowerCase().indexOf(i)!==-1||!i)}}};m.\u0275fac=function(a){return new(a||m)(p(k),p(T),p(N))},m.\u0275cmp=S({type:m,selectors:[["app-empresas"]],viewQuery:function(a,r){if(a&1&&G(P,5),a&2){let c;z(c=Q())&&(r.child=c.first)}},standalone:!0,features:[H([me()]),y],decls:70,vars:6,consts:[["mf","mfDataTable"],[1,"content-wrapper"],["titulo","Empresas"],[1,"content"],[1,"card"],[1,"card-header","border-0"],[1,"card-title"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary"],[1,"fa","fa-plus"],[1,"card-tools"],[1,"input-group","input-group-sm",2,"width","250px"],[1,"form-control","float-right",2,"width","50px",3,"ngModelChange","ngModel"],["value","10"],["value","25"],["value","50"],["value","100"],["type","text","name","table_search","placeholder","Pesquisar...",1,"form-control","float-right",2,"width","200px",3,"ngModelChange","ngModel"],[1,"card-body","table-responsive","p-1"],[1,"table","table-hover","table-head-fixed","text-nowrap",3,"mfData","mfRowsOnPage"],["by","id"],["by","subunidade.abreviatura"],["by","nome"],["by","cnpj"],["by","telefone1"],["colspan","100%"],[2,"display","flex","align-items","center","justify-content","center"],["id","modalcad","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header","border-0"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"refresh"],["id","modaldel","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog"],[1,"optionshover"],[3,"routerLink"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-edit","text-primary"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-danger","ml-1"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-primary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"]],template:function(a,r){if(a&1){let c=E();e(0,"div",1),u(1,"app-title",2),e(2,"section",3)(3,"div",4)(4,"div",5)(5,"h3",6)(6,"button",7),u(7,"i",8),t()(),e(8,"div",9)(9,"div",10)(10,"select",11),I("ngModelChange",function(h){return v(c),j(r.quant,h)||(r.quant=h),x(h)}),e(11,"option",12),o(12,"10"),t(),e(13,"option",13),o(14,"25"),t(),e(15,"option",14),o(16,"50"),t(),e(17,"option",15),o(18,"100"),t()(),e(19,"input",16),I("ngModelChange",function(h){return v(c),j(r.pesquisa,h)||(r.pesquisa=h),x(h)}),f("ngModelChange",function(){return v(c),x(r.pesquisar())}),t()()()(),e(20,"div",17)(21,"table",18,0)(23,"thead")(24,"tr")(25,"th")(26,"mfDefaultSorter",19),o(27,"#"),t()(),e(28,"th")(29,"mfDefaultSorter",20),o(30,"Subunidade"),t()(),e(31,"th")(32,"mfDefaultSorter",21),o(33,"Nome"),t()(),e(34,"th")(35,"mfDefaultSorter",22),o(36,"CNPJ"),t()(),e(37,"th")(38,"mfDefaultSorter",23),o(39,"Telefone 1"),t()(),e(40,"th"),o(41,"Op\xE7\xF5es"),t()()(),V(42,ke,4,1,"tbody"),e(43,"tfoot")(44,"tr")(45,"td",24)(46,"div",25),u(47,"mfBootstrapPaginator"),t()()()()()()()(),e(48,"div",26)(49,"div",27)(50,"div",28)(51,"div",29)(52,"h4",30),o(53,"Cadastrar"),t(),e(54,"button",31)(55,"span",32),o(56,"\xD7"),t()()(),e(57,"div",33)(58,"app-empresas-form",34),f("refresh",function(){return v(c),x(r.refresh())}),t()()()()(),e(59,"div",35)(60,"div",36)(61,"div",28)(62,"div",29)(63,"h4",30),o(64,"Excluir"),t(),e(65,"button",31)(66,"span",32),o(67,"\xD7"),t()()(),e(68,"div",33),V(69,Ve,8,1),t()()()()()}a&2&&(l(10),F("ngModel",r.quant),l(9),F("ngModel",r.pesquisa),l(2),g("mfData",r.data$)("mfRowsOnPage",r.quant),l(21),D(42,r.data$?42:-1),l(27),D(69,r.excluir?69:-1))},dependencies:[w,ue,P,ve,fe,ge,he,L,ae,oe,Y,ne,M,ee,X,U,de]});let s=m;return s})();export{Ze as EmpresasComponent};
