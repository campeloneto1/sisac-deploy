import{a as Ve}from"./chunk-LXIWSDD7.js";import{a as ye}from"./chunk-LTYLTL4N.js";import{a as Ee}from"./chunk-77XLGHWE.js";import{a as q}from"./chunk-TNOIS3Y3.js";import{h as I}from"./chunk-NFMIVN66.js";import{a as xe,b as Ce,c as Se,d as ge}from"./chunk-AICVXWQ6.js";import{a as he}from"./chunk-I3SZ5FME.js";import{a as _e}from"./chunk-HYOWEGV7.js";import{a as be}from"./chunk-3HEW5RTP.js";import{a as ve,b as G}from"./chunk-4366GPH2.js";import"./chunk-HDKAZCIU.js";import{$b as F,C as Y,Ca as E,Ea as p,F as Z,Fa as m,I as O,Ka as oe,La as ne,Ma as ae,Na as re,Nb as me,O as b,Oa as a,P as x,Pa as h,Pb as C,Qb as $,Ra as le,Rb as L,Sb as de,Tb as j,Ua as W,Va as z,Vb as N,W as D,Wa as H,Wb as B,Xb as ue,Ya as w,Yb as pe,Zb as fe,_b as P,ac as R,ca as c,cb as Q,da as d,eb as K,l as X,la as g,na as v,rb as se,sa as _,sb as T,ta as ee,ua as te,va as ie,vb as ce,wa as t,xa as i,ya as u}from"./chunk-OWJSVT4P.js";var y=ve.url,V="veiculos-oficinas",M=(()=>{let r=class r{constructor(e){this.http=e}index(){return this.http.get(`${y}/${V}`)}find(e){return this.http.get(`${y}/${V}/${e}`)}create(e){return this.http.post(`${y}/${V}`,e)}update(e,o){return this.http.put(`${y}/${V}/${e}`,o)}remove(e){return this.http.delete(`${y}/${V}/${e}`)}emmanutencao(){return this.http.get(`${y}/${V}/emmanutencao`)}receber(e){return this.http.post(`${y}/${V}/receber`,e)}};r.\u0275fac=function(o){return new(o||r)(Z(ce))},r.\u0275prov=Y({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();function Ie(n,r){if(n&1&&u(0,"input-select",2),n&2){let s=m();v("data$",s.veiculos$)}}function Me(n,r){if(n&1&&u(0,"input-select",3),n&2){let s=m();v("data$",s.oficinas$)}}function ke(n,r){if(n&1&&u(0,"input-select",4),n&2){let s=m();v("data$",s.manutencoestipos$)}}var J=(()=>{let r=class r{constructor(e,o,l,f,k,S,$e){this.formBuilder=e,this.veiculosOficinasService=o,this.veiculosService=l,this.oficinasService=f,this.manutencoesTiposService=k,this.toastr=S,this.sessionService=$e,this.refresh=new D}ngOnInit(){this.form=this.formBuilder.group({id:[null],veiculo:[null,C.compose([C.required])],oficina:[null,C.compose([C.required])],manutencao_tipo:[null,C.compose([C.required])],data_inicial:[null],data_final:[null],km_inicial:[null],km_final:[null],observacoes:[null],subunidade:[null]}),this.oficinas$=this.oficinasService.index(),this.manutencoestipos$=this.manutencoesTiposService.index(),this.subscription=this.veiculosService.disponiveis().subscribe({next:e=>{e.forEach(o=>{o.placa_especial?o.nome=`${o.modelo.marca.nome} ${o.modelo.nome}, Placa: ${o.placa}, Placa Esp. ${o.placa_especial}`:o.nome=`${o.modelo.marca.nome} ${o.modelo.nome}, Placa: ${o.placa}`}),this.veiculos$=X(e)}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}cadastrar(){this.form.value.id?this.veiculosOficinasService.update(this.form.value.id,this.form.value).subscribe({next:e=>{this.toastr.success("Edi\xE7\xE3o realizada com sucesso!"),this.form.reset(),this.refresh.emit()},error:e=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}):(this.sessionService.getSubunidade()?this.form.get("subunidade")?.patchValue(this.sessionService.getSubunidade()):this.toastr.error("Selecione uma subunidade!"),this.veiculosOficinasService.create(this.form.value).subscribe({next:e=>{this.toastr.success("Cadastro realizado com sucesso!"),this.form.reset(),this.refresh.emit()},error:e=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}))}editar(e){this.form.patchValue(e),e.veiculo&&this.form.get("veiculo")?.patchValue(e.veiculo.id),e.oficina&&this.form.get("oficina")?.patchValue(e.oficina.id),e.manutencao_tipo&&this.form.get("manutencao_tipo")?.patchValue(e.manutencao_tipo.id)}};r.\u0275fac=function(o){return new(o||r)(d(P),d(M),d(Ve),d(ye),d(Ee),d(I),d(G))},r.\u0275cmp=O({type:r,selectors:[["app-veiculos-oficinas-form"]],outputs:{refresh:"refresh"},standalone:!0,features:[w],decls:12,vars:5,consts:[[3,"formGroup"],[1,"row"],["label","Ve\xEDculo","id","veiculo","formControlName","veiculo",1,"col-sm-6",3,"data$"],["label","Oficina","id","oficina","formControlName","oficina",1,"col-sm-4",3,"data$"],["label","Tipo de Manuten\xE7\xE3o","id","manutencao_tipo","formControlName","manutencao_tipo",1,"col-sm-2",3,"data$"],[1,"row",2,"height","350px"],["formControlName","observacoes","label","Observa\xE7\xF5es","id","observacoes",1,"col-sm-12"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click","disabled"]],template:function(o,l){o&1&&(t(0,"form",0)(1,"div",1),g(2,Ie,1,1,"input-select",2)(3,Me,1,1,"input-select",3)(4,ke,1,1,"input-select",4),i(),t(5,"div",5),u(6,"input-textarea",6),i(),t(7,"div",7)(8,"a",8),p("click",function(){return l.form.reset()}),a(9,"Cancelar"),i(),t(10,"button",9),p("click",function(){return l.cadastrar()}),a(11," Cadastrar "),i()()()),o&2&&(v("formGroup",l.form),c(2),_(2,l.veiculos$?2:-1),c(),_(3,l.oficinas$?3:-1),c(),_(4,l.manutencoestipos$?4:-1),c(6),v("disabled",l.form.invalid))},dependencies:[T,F,j,$,L,R,N,B,he,q]});let n=r;return n})();var Te=(()=>{let r=class r{constructor(e,o,l){this.formBuilder=e,this.veiculosOficinasService=o,this.toastr=l,this.refresh=new D}ngOnInit(){this.form=this.formBuilder.group({id:[null],km_final:[null,C.compose([C.required])],observacoes:[null]}),this.form.get("observacoes")?.patchValue(this.veiculooficina.observacoes),this.form.get("id")?.patchValue(this.veiculooficina.id)}cadastrar(){this.veiculosOficinasService.receber(this.form.value).subscribe({next:e=>{this.toastr.success("Edi\xE7\xE3o realizada com sucesso!"),this.form.reset(),this.refresh.emit()},error:e=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}})}};r.\u0275fac=function(o){return new(o||r)(d(P),d(M),d(I))},r.\u0275cmp=O({type:r,selectors:[["app-veiculos-oficinas-form-receber"]],inputs:{veiculooficina:"veiculooficina"},outputs:{refresh:"refresh"},standalone:!0,features:[w],decls:10,vars:3,consts:[[3,"formGroup"],[1,"row"],["formControlName","km_final","label","KM Final","id","km_final","tipo","number",1,"col-sm-2",3,"min"],[1,"row",2,"height","350px"],["formControlName","observacoes","label","Observa\xE7\xF5es","id","observacoes",1,"col-sm-12"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click","disabled"]],template:function(o,l){o&1&&(t(0,"form",0)(1,"div",1),u(2,"input-text",2),i(),t(3,"div",3),u(4,"input-textarea",4),i(),t(5,"div",5)(6,"a",6),p("click",function(){return l.form.reset()}),a(7,"Cancelar"),i(),t(8,"button",7),p("click",function(){return l.cadastrar()}),a(9," Cadastrar "),i()()()),o&2&&(v("formGroup",l.form),c(2),v("min",l.veiculooficina.km_inicial),c(6),v("disabled",l.form.invalid))},dependencies:[T,F,j,$,L,R,N,B,_e,q]});let n=r;return n})();function De(n,r){n&1&&(t(0,"button",7),u(1,"i",45),i())}function Le(n,r){if(n&1){let s=E();t(0,"a",50),p("click",function(){b(s);let o=m(2).$implicit,l=m(2);return x(l.receber(o))}),u(1,"i",51),i()}}function je(n,r){if(n&1){let s=E();t(0,"a",52),p("click",function(){b(s);let o=m(2).$implicit,l=m(2);return x(l.editar(o))}),u(1,"i",53),i()}}function Ne(n,r){if(n&1&&g(0,Le,2,0,"a",48)(1,je,2,0,"a",49),n&2){let s=m(3);_(0,s.user.perfil.veiculos_oficinas_cad?0:-1),c(),_(1,s.user.perfil.veiculos_oficinas_edt?1:-1)}}function Be(n,r){if(n&1){let s=E();t(0,"a",54),p("click",function(){b(s);let o=m().$implicit,l=m(2);return x(l.delete(o))}),u(1,"i",55),i()}}function Pe(n,r){if(n&1&&(t(0,"tr",46)(1,"td"),a(2),i(),t(3,"td"),a(4),i(),t(5,"td"),a(6),i(),t(7,"td"),a(8),i(),t(9,"td"),a(10),i(),t(11,"td"),a(12),i(),t(13,"td"),a(14),i(),t(15,"td"),a(16),i(),t(17,"td"),a(18),Q(19,"date"),i(),t(20,"td"),a(21),Q(22,"date"),i(),t(23,"td"),a(24),i(),t(25,"td"),a(26),i(),t(27,"td"),g(28,Ne,2,2)(29,Be,2,0,"a",47),i()()),n&2){let s=r.$implicit,e=m(2);c(2),h(s.id),c(2),le("",s.subunidade.abreviatura," - ",s.subunidade.unidade.abreviatura,""),c(2),h(s.veiculo.modelo.marca.nome),c(2),h(s.veiculo.modelo.nome),c(2),h(s.veiculo.placa),c(2),h(s.veiculo.placa_especial),c(2),h(s.oficina.nome),c(2),h(s.manutencao_tipo.nome),c(2),h(K(19,15,s.data_inicial,"dd/MM/yyyy HH:mm")),c(3),h(K(22,18,s.data_final,"dd/MM/yyyy HH:mm")),c(3),h(s.km_inicial),c(2),h(s.km_final),c(2),_(28,s.data_final?-1:28),c(),_(29,e.user.perfil.veiculos_oficinas_del?29:-1)}}function Re(n,r){n&1&&(t(0,"tr")(1,"td",30),a(2,"Sem informa\xE7\xE3o"),i()())}function Ge(n,r){if(n&1&&(t(0,"tbody"),te(1,Pe,30,21,"tr",46,ee,!1,Re,3,0,"tr"),i()),n&2){m();let s=re(21);c(),ie(s.data)}}function qe(n,r){if(n&1){let s=E();t(0,"app-veiculos-oficinas-form-receber",56),p("refresh",function(){b(s);let o=m();return x(o.refresh())}),i()}if(n&2){let s=m();v("veiculooficina",s.recebveiculo)}}function We(n,r){if(n&1){let s=E();a(0," Tem certeza que deseja excluir: "),t(1,"b"),a(2),i(),t(3,"div",57)(4,"a",58),a(5,"Cancelar"),i(),t(6,"button",59),p("click",function(){b(s);let o=m();return x(o.confirm())}),a(7," Excluir "),i()()}if(n&2){let s=m();c(2),h(s.excluir.veiculo.placa)}}var Vt=(()=>{let r=class r{constructor(e,o,l){this.veiculosOficinasService=e,this.toastr=o,this.sessionService=l,this.quant=10}ngOnInit(){this.sessionService.checkPermission("veiculos_oficinas"),this.user=this.sessionService.getUser(),this.subscription=this.veiculosOficinasService.index().subscribe({next:e=>{this.data$=e,this.temp=e}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}refresh(){this.veiculosOficinasService.index().subscribe({next:e=>{this.data$=e}})}editar(e){this.child.editar(e)}delete(e){this.excluir=e}confirm(){this.veiculosOficinasService.remove(this.excluir.id||0).subscribe({next:e=>{this.toastr.success("Exclus\xE3o realizada com sucesso!"),this.refresh()},error:e=>{this.toastr.error("Erro ao excluir, tente novamente mais tarde!")}})}receber(e){this.recebveiculo=e}pesquisar(){if(this.data$=this.temp,this.pesquisa.length>0){var e=this.pesquisa.toLocaleLowerCase();this.data$=this.data$.filter(o=>o.veiculo.placa_especial?o.veiculo.placa.toLocaleLowerCase().indexOf(e)!==-1||o.veiculo.placa_especial.toLocaleLowerCase().indexOf(e)!==-1||o.veiculo.modelo.marca.nome.toLocaleLowerCase().indexOf(e)!==-1||o.veiculo.modelo.nome.toLocaleLowerCase().indexOf(e)!==-1||o.oficina.nome.toLocaleLowerCase().indexOf(e)!==-1||o.manutencao_tipo.nome.toLocaleLowerCase().indexOf(e)!==-1||!e:o.veiculo.placa.toLocaleLowerCase().indexOf(e)!==-1||o.veiculo.modelo.marca.nome.toLocaleLowerCase().indexOf(e)!==-1||o.veiculo.modelo.nome.toLocaleLowerCase().indexOf(e)!==-1||o.oficina.nome.toLocaleLowerCase().indexOf(e)!==-1||o.manutencao_tipo.nome.toLocaleLowerCase().indexOf(e)!==-1||!e)}}};r.\u0275fac=function(o){return new(o||r)(d(M),d(I),d(G))},r.\u0275cmp=O({type:r,selectors:[["app-veiculos-oficinas"]],viewQuery:function(o,l){if(o&1&&oe(J,5),o&2){let f;ne(f=ae())&&(l.child=f.first)}},standalone:!0,features:[w],decls:101,vars:10,consts:[["mf","mfDataTable"],[1,"content-wrapper"],["titulo","Manuten\xE7\xE3o de Ve\xEDculos"],[1,"content"],[1,"card"],[1,"card-header","border-0"],[1,"card-title"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary"],[1,"card-tools"],[1,"input-group","input-group-sm",2,"width","250px"],[1,"form-control","float-right",2,"width","50px",3,"ngModelChange","ngModel"],["value","10"],["value","25"],["value","50"],["value","100"],["type","text","name","table_search","placeholder","Pesquisar...",1,"form-control","float-right",2,"width","200px",3,"ngModelChange","ngModel"],[1,"card-body","table-responsive","p-1"],[1,"table","table-hover","table-head-fixed","text-nowrap",3,"mfData","mfRowsOnPage","mfSortBy","mfSortOrder"],["by","id"],["by","subunidade.abreviatura"],["by","veiculo.modelo.marca.nome"],["by","veiculo.modelo.nome"],["by","veiculo.placa"],["by","veiculo.placa_especial"],["by","oficina.nome"],["by","manutencao_tipo.nome"],["by","data_inicial"],["by","data_final"],["by","km_inicial"],["by","km_final"],["colspan","100%"],[2,"display","flex","align-items","center","justify-content","center"],["id","modalcad","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header","border-0"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"refresh"],["id","modalreceb","aria-hidden","true",1,"modal","fade",2,"display","none"],[3,"veiculooficina"],["id","modaldel","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog"],[1,"fa","fa-plus"],[1,"optionshover"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point","ml-1"],["title","Receber","data-bs-toggle","modal","data-bs-target","#modalreceb",1,"options","point"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point","ml-1"],["title","Receber","data-bs-toggle","modal","data-bs-target","#modalreceb",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-download","text-primary"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point","ml-1",3,"click"],["aria-hidden","true",1,"fa","fa-edit","text-primary"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point","ml-1",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-danger"],[3,"refresh","veiculooficina"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-primary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"]],template:function(o,l){if(o&1){let f=E();t(0,"div",1),u(1,"app-title",2),t(2,"section",3)(3,"div",4)(4,"div",5)(5,"h3",6),g(6,De,2,0,"button",7),i(),t(7,"div",8)(8,"div",9)(9,"select",10),H("ngModelChange",function(S){return b(f),z(l.quant,S)||(l.quant=S),x(S)}),t(10,"option",11),a(11,"10"),i(),t(12,"option",12),a(13,"25"),i(),t(14,"option",13),a(15,"50"),i(),t(16,"option",14),a(17,"100"),i()(),t(18,"input",15),H("ngModelChange",function(S){return b(f),z(l.pesquisa,S)||(l.pesquisa=S),x(S)}),p("ngModelChange",function(){return b(f),x(l.pesquisar())}),i()()()(),t(19,"div",16)(20,"table",17,0)(22,"thead")(23,"tr")(24,"th")(25,"mfDefaultSorter",18),a(26,"#"),i()(),t(27,"th")(28,"mfDefaultSorter",19),a(29,"Subunidade"),i()(),t(30,"th")(31,"mfDefaultSorter",20),a(32,"Marca"),i()(),t(33,"th")(34,"mfDefaultSorter",21),a(35,"Modelo"),i()(),t(36,"th")(37,"mfDefaultSorter",22),a(38,"Placa"),i()(),t(39,"th")(40,"mfDefaultSorter",23),a(41,"Placa Especial"),i()(),t(42,"th")(43,"mfDefaultSorter",24),a(44,"Oficina"),i()(),t(45,"th")(46,"mfDefaultSorter",25),a(47,"Manuten\xE7\xE3o"),i()(),t(48,"th")(49,"mfDefaultSorter",26),a(50,"Data Inicial"),i()(),t(51,"th")(52,"mfDefaultSorter",27),a(53,"Data Final"),i()(),t(54,"th")(55,"mfDefaultSorter",28),a(56,"KM Inicial"),i()(),t(57,"th")(58,"mfDefaultSorter",29),a(59,"KM Final"),i()(),t(60,"th"),a(61,"Op\xE7\xF5es"),i()()(),g(62,Ge,4,1,"tbody"),t(63,"tfoot")(64,"tr")(65,"td",30)(66,"div",31),u(67,"mfBootstrapPaginator"),i()()()()()()()(),t(68,"div",32)(69,"div",33)(70,"div",34)(71,"div",35)(72,"h4",36),a(73,"Cadastrar"),i(),t(74,"button",37)(75,"span",38),a(76,"\xD7"),i()()(),t(77,"div",39)(78,"app-veiculos-oficinas-form",40),p("refresh",function(){return b(f),x(l.refresh())}),i()()()()(),t(79,"div",41)(80,"div",33)(81,"div",34)(82,"div",35)(83,"h4",36),a(84,"Receber ve\xEDculo"),i(),t(85,"button",37)(86,"span",38),a(87,"\xD7"),i()()(),t(88,"div",39),g(89,qe,1,1,"app-veiculos-oficinas-form-receber",42),i()()()(),t(90,"div",43)(91,"div",44)(92,"div",34)(93,"div",35)(94,"h4",36),a(95,"Excluir"),i(),t(96,"button",37)(97,"span",38),a(98,"\xD7"),i()()(),t(99,"div",39),g(100,We,8,1),i()()()()()}o&2&&(c(6),_(6,l.user.perfil.veiculos_oficinas_cad?6:-1),c(3),W("ngModel",l.quant),c(9),W("ngModel",l.pesquisa),c(2),v("mfData",l.data$)("mfRowsOnPage",l.quant)("mfSortBy","id")("mfSortOrder","desc"),c(42),_(62,l.data$?62:-1),c(27),_(89,l.recebveiculo?89:-1),c(11),_(100,l.excluir?100:-1))},dependencies:[T,se,be,J,Te,ge,xe,Se,Ce,F,pe,fe,me,ue,$,de]});let n=r;return n})();export{Vt as VeiculosOficinasComponent};
