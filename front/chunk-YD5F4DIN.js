import{a as I}from"./chunk-ODYZMRBW.js";import{a as be}from"./chunk-M4ZXLS2S.js";import{a as xe}from"./chunk-7UROPAQM.js";import{a as ve}from"./chunk-R4NLVNIH.js";import{a as he}from"./chunk-TNOIS3Y3.js";import{h as k}from"./chunk-NFMIVN66.js";import{a as ue,b as pe,c as fe,d as _e}from"./chunk-AICVXWQ6.js";import{a as me}from"./chunk-I3SZ5FME.js";import{a as de}from"./chunk-HYOWEGV7.js";import{a as ce}from"./chunk-3HEW5RTP.js";import{b as F}from"./chunk-4366GPH2.js";import"./chunk-HDKAZCIU.js";import{$b as D,Ca as M,Ea as p,Fa as f,Fb as K,I as y,Ib as X,Ka as W,La as z,Ma as G,Na as A,Nb as Y,O as _,Oa as a,P as h,Pa as x,Pb as m,Qb as V,Ra as U,Rb as Z,Sb as ee,Tb as te,Ua as q,Va as $,Vb as ie,W as L,Wa as N,Wb as ae,Xb as re,Ya as w,Yb as ne,Zb as oe,_a as H,_b as le,ac as se,ca as l,cb as O,da as u,eb as j,la as g,na as C,rb as J,sa as S,sb as T,ta as P,ua as Q,va as R,wa as e,xa as t,ya as v}from"./chunk-OWJSVT4P.js";function we(o,d){o&1&&v(0,"input-text",6)}var B=(()=>{let d=class d{constructor(i,r,n,c,E,b,Ce){this.formBuilder=i,this.materiaisService=r,this.materiaisTiposService=n,this.marcasService=c,this.modelosService=E,this.toastr=b,this.sessionService=Ce,this.editando=!1,this.refresh=new L,this.cancel=new L}ngOnInit(){this.form=this.formBuilder.group({id:[null],serial:[null,m.compose([m.minLength(5),m.maxLength(100)])],quantidade:[null,m.compose([m.min(1),m.required])],data_validade:[null],data_baixa:[null],observacoes:[null],marca:[null,m.compose([m.required])],modelo:[null,m.compose([m.required])],material_tipo:[null,m.compose([m.required])],subunidade:[null]}),this.marcas$=this.marcasService.marcasLogistica(),this.materiaistipos$=this.materiaisTiposService.index()}cadastrar(){this.form.value.id?(this.form.value.data_baixa||this.form.get("data_baixa")?.patchValue(null),this.form.value.data_validade||this.form.get("data_validade")?.patchValue(null),delete this.form.value.marca,this.materiaisService.update(this.form.value.id,this.form.value).subscribe({next:i=>{this.toastr.success("Edi\xE7\xE3o realizada com sucesso!"),this.form.reset(),this.refresh.emit(),this.editando=!1},error:i=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}})):(this.sessionService.getSubunidade()?this.form.get("subunidade")?.patchValue(this.sessionService.getSubunidade()):this.toastr.error("Selecione uma subunidade!"),delete this.form.value.marca,this.materiaisService.create(this.form.value).subscribe({next:i=>{this.toastr.success("Cadastro realizado com sucesso!"),this.form.reset(),this.refresh.emit()},error:i=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}))}editar(i){this.editando=!0,this.form.patchValue(i),i.modelo&&(this.form.get("marca")?.patchValue(i.modelo.marca.id),this.form.get("modelo")?.patchValue(i.modelo.id),this.getModelos()),i.material_tipo&&this.form.get("material_tipo")?.patchValue(i.material_tipo.id)}cancelar(){this.editando=!1,this.cancel.emit(),this.form.reset()}resetForm(){this.editando=!1,this.form.reset()}getModelos(){this.modelos$=this.modelosService.whereMarca(this.form.get("marca")?.value)}};d.\u0275fac=function(r){return new(r||d)(u(le),u(I),u(be),u(ve),u(xe),u(k),u(F))},d.\u0275cmp=y({type:d,selectors:[["app-materiais-form"]],outputs:{refresh:"refresh",cancel:"cancel"},standalone:!0,features:[w],decls:17,vars:6,consts:[[3,"formGroup"],[1,"row"],["label","Marca","id","marca","formControlName","marca",1,"col-sm-2",3,"ngModelChange","data$"],["label","Modelo","id","modelo","formControlName","modelo",1,"col-sm-2",3,"data$"],["label","Tipo","id","material_tipo","formControlName","material_tipo",1,"col-sm-2",3,"data$"],["formControlName","serial","label","Serial","id","serial","tipo","text",1,"col-sm-2"],["formControlName","quantidade","label","Quantidade","id","quantidade","tipo","number",1,"col-sm-2"],["formControlName","data_validade","label","Data Validade","id","data_validade","tipo","date",1,"col-sm-2"],["formControlName","data_baixa","label","Data Baixa","id","data_baixa","tipo","date",1,"col-sm-2"],[1,"row",2,"height","350px"],["formControlName","observacoes","label","Observa\xE7\xF5es","id","observacoes",1,"col-sm-12"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click","disabled"]],template:function(r,n){r&1&&(e(0,"form",0)(1,"div",1)(2,"input-select",2),p("ngModelChange",function(){return n.getModelos()}),t(),v(3,"input-select",3)(4,"input-select",4)(5,"input-text",5),g(6,we,1,0,"input-text",6),t(),e(7,"div",1),v(8,"input-text",7)(9,"input-text",8),t(),e(10,"div",9),v(11,"input-textarea",10),t(),e(12,"div",11)(13,"a",12),p("click",function(){return n.cancelar()}),a(14,"Cancelar"),t(),e(15,"button",13),p("click",function(){return n.cadastrar()}),a(16," Cadastrar "),t()()()),r&2&&(C("formGroup",n.form),l(2),C("data$",n.marcas$),l(),C("data$",n.modelos$),l(),C("data$",n.materiaistipos$),l(2),S(6,n.editando?-1:6),l(9),C("disabled",n.form.invalid))},dependencies:[T,D,te,V,Z,se,ie,ae,de,me,he]});let o=d;return o})();var Te=o=>["/Material",o];function Ve(o,d){if(o&1){let s=M();e(0,"button",41),p("click",function(){_(s);let r=f();return h(r.cadastrar())}),v(1,"i",42),t()}}function De(o,d){if(o&1){let s=M();e(0,"a",47),p("click",function(){_(s);let r=f().$implicit,n=f(2);return h(n.editar(r))}),v(1,"i",48),t()}}function Fe(o,d){if(o&1){let s=M();e(0,"a",49),p("click",function(){_(s);let r=f().$implicit,n=f(2);return h(n.delete(r))}),v(1,"i",50),t()}}function ke(o,d){if(o&1&&(e(0,"tr",43)(1,"td"),a(2),t(),e(3,"td"),a(4),t(),e(5,"td")(6,"a",44),a(7),t()(),e(8,"td"),a(9),t(),e(10,"td"),a(11),t(),e(12,"td"),a(13),t(),e(14,"td"),a(15),t(),e(16,"td"),a(17),t(),e(18,"td"),a(19),O(20,"date"),t(),e(21,"td"),a(22),O(23,"date"),t(),e(24,"td"),g(25,De,2,0,"a",45)(26,Fe,2,0,"a",46),t()()),o&2){let s=d.$implicit,i=f(2);l(2),x(s.id),l(2),U("",s.subunidade.abreviatura," - ",s.subunidade.unidade.abreviatura,""),l(2),C("routerLink",H(20,Te,s.id)),l(),x(s.material_tipo.nome),l(2),x(s.modelo.marca.nome),l(2),x(s.modelo.nome),l(2),x(s.serial),l(2),x(s.quantidade),l(2),x(s.quantidade_disponivel),l(2),x(j(20,14,s.data_validade,"dd/MM/yyyy")),l(3),x(j(23,17,s.data_baixa,"dd/MM/yyyy")),l(3),S(25,i.user.perfil.materiais_edt?25:-1),l(),S(26,i.user.perfil.materiais_del?26:-1)}}function Ie(o,d){o&1&&(e(0,"tr")(1,"td",28),a(2,"Sem informa\xE7\xE3o"),t()())}function Le(o,d){if(o&1&&(e(0,"tbody"),Q(1,ke,27,22,"tr",43,P,!1,Ie,3,0,"tr"),t()),o&2){f();let s=A(21);l(),R(s.data)}}function qe(o,d){if(o&1){let s=M();e(0,"app-materiais-form",51),p("refresh",function(){_(s);let r=f();return h(r.refresh())})("cancel",function(){_(s);let r=f();return h(r.resetForm())}),t()}}function $e(o,d){if(o&1){let s=M();a(0," Tem certeza que deseja excluir: "),e(1,"b"),a(2),t(),e(3,"div",52)(4,"a",53),a(5,"Cancelar"),t(),e(6,"button",54),p("click",function(){_(s);let r=f();return h(r.confirm())}),a(7," Excluir "),t()()}if(o&2){let s=f();l(2),x(s.excluir.serial)}}var at=(()=>{let d=class d{constructor(i,r,n){this.materiaisService=i,this.toastr=r,this.sessionService=n,this.quant=10,this.cadastrando=!1}ngOnInit(){this.user=this.sessionService.getUser(),this.sessionService.checkPermission("materiais"),this.subscription=this.materiaisService.index().subscribe({next:i=>{this.data$=i,this.temp=i}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}refresh(){this.materiaisService.index().subscribe({next:i=>{this.data$=i}})}cadastrar(){this.cadastrando=!0,setTimeout(()=>{this.child.resetForm()},100)}editar(i){this.cadastrando=!0,setTimeout(()=>{this.child.editar(i)},100)}delete(i){this.excluir=i}confirm(){this.materiaisService.remove(this.excluir.id||0).subscribe({next:i=>{this.toastr.success("Exclus\xE3o realizada com sucesso!"),this.refresh()},error:i=>{this.toastr.error("Erro ao excluir, tente novamente mais tarde!")}})}resetForm(){this.child.resetForm(),this.cadastrando=!1}pesquisar(){if(this.data$=this.temp,this.pesquisa.length>0){var i=this.pesquisa.toLocaleLowerCase();this.data$=this.data$.filter(r=>r.serial?r.serial.toLocaleLowerCase().indexOf(i)!==-1||r.modelo.nome.toLocaleLowerCase().indexOf(i)!==-1||r.modelo.marca.nome.toLocaleLowerCase().indexOf(i)!==-1||r.material_tipo.nome.toLocaleLowerCase().indexOf(i)!==-1||!i:r.modelo.nome.toLocaleLowerCase().indexOf(i)!==-1||r.modelo.marca.nome.toLocaleLowerCase().indexOf(i)!==-1||r.material_tipo.nome.toLocaleLowerCase().indexOf(i)!==-1||!i)}}};d.\u0275fac=function(r){return new(r||d)(u(I),u(k),u(F))},d.\u0275cmp=y({type:d,selectors:[["app-materiais"]],viewQuery:function(r,n){if(r&1&&W(B,5),r&2){let c;z(c=G())&&(n.child=c.first)}},standalone:!0,features:[w],decls:84,vars:8,consts:[["mf","mfDataTable"],[1,"content-wrapper"],["titulo","Materiais"],[1,"content"],[1,"card"],[1,"card-header","border-0"],[1,"card-title"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary"],[1,"card-tools"],[1,"input-group","input-group-sm",2,"width","250px"],[1,"form-control","float-right",2,"width","50px",3,"ngModelChange","ngModel"],["value","10"],["value","25"],["value","50"],["value","100"],["type","text","name","table_search","placeholder","Pesquisar...",1,"form-control","float-right",2,"width","200px",3,"ngModelChange","ngModel"],[1,"card-body","table-responsive","p-1"],[1,"table","table-hover","table-head-fixed","text-nowrap",3,"mfData","mfRowsOnPage"],["by","id"],["by","subunidade.abreviatura"],["by","material_tipo.nome"],["by","modelo.marca.nome"],["by","modelo.nome"],["by","serial"],["by","quantidade"],["by","quantidade_disponivel"],["by","data_validade"],["by","data_baixa"],["colspan","100%"],[2,"display","flex","align-items","center","justify-content","center"],["id","modalcad","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header","border-0"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],["id","modaldel","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary",3,"click"],[1,"fa","fa-plus"],[1,"optionshover"],[3,"routerLink"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-edit","text-primary"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-danger","ml-1"],[3,"refresh","cancel"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-primary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"]],template:function(r,n){if(r&1){let c=M();e(0,"div",1),v(1,"app-title",2),e(2,"section",3)(3,"div",4)(4,"div",5)(5,"h3",6),g(6,Ve,2,0,"button",7),t(),e(7,"div",8)(8,"div",9)(9,"select",10),N("ngModelChange",function(b){return _(c),$(n.quant,b)||(n.quant=b),h(b)}),e(10,"option",11),a(11,"10"),t(),e(12,"option",12),a(13,"25"),t(),e(14,"option",13),a(15,"50"),t(),e(16,"option",14),a(17,"100"),t()(),e(18,"input",15),N("ngModelChange",function(b){return _(c),$(n.pesquisa,b)||(n.pesquisa=b),h(b)}),p("ngModelChange",function(){return _(c),h(n.pesquisar())}),t()()()(),e(19,"div",16)(20,"table",17,0)(22,"thead")(23,"tr")(24,"th")(25,"mfDefaultSorter",18),a(26,"#"),t()(),e(27,"th")(28,"mfDefaultSorter",19),a(29,"Subunidade"),t()(),e(30,"th")(31,"mfDefaultSorter",20),a(32,"Tipo"),t()(),e(33,"th")(34,"mfDefaultSorter",21),a(35,"Marca"),t()(),e(36,"th")(37,"mfDefaultSorter",22),a(38,"Modelo"),t()(),e(39,"th")(40,"mfDefaultSorter",23),a(41,"Serial"),t()(),e(42,"th")(43,"mfDefaultSorter",24),a(44,"Quantidade"),t()(),e(45,"th")(46,"mfDefaultSorter",25),a(47,"Quantidade Dispon\xEDvel"),t()(),e(48,"th")(49,"mfDefaultSorter",26),a(50,"Dt. Validade"),t()(),e(51,"th")(52,"mfDefaultSorter",27),a(53,"Dt. Baixa"),t()(),e(54,"th"),a(55,"Op\xE7\xF5es"),t()()(),g(56,Le,4,1,"tbody"),e(57,"tfoot")(58,"tr")(59,"td",28)(60,"div",29),v(61,"mfBootstrapPaginator"),t()()()()()()()(),e(62,"div",30)(63,"div",31)(64,"div",32)(65,"div",33)(66,"h4",34),a(67,"Cadastrar"),t(),e(68,"button",35),p("click",function(){return _(c),h(n.resetForm())}),e(69,"span",36),a(70,"\xD7"),t()()(),e(71,"div",37),g(72,qe,1,0,"app-materiais-form"),t()()()(),e(73,"div",38)(74,"div",39)(75,"div",32)(76,"div",33)(77,"h4",34),a(78,"Excluir"),t(),e(79,"button",40)(80,"span",36),a(81,"\xD7"),t()()(),e(82,"div",37),g(83,$e,8,1),t()()()()()}r&2&&(l(6),S(6,n.user.perfil.materiais_cad?6:-1),l(3),q("ngModel",n.quant),l(9),q("ngModel",n.pesquisa),l(2),C("mfData",n.data$)("mfRowsOnPage",n.quant),l(36),S(56,n.data$?56:-1),l(16),S(72,n.cadastrando?72:-1),l(11),S(83,n.excluir?83:-1))},dependencies:[T,J,ce,B,_e,ue,fe,pe,D,ne,oe,Y,re,V,ee,X,K]});let o=d;return o})();export{at as MateriaisComponent};
