import{a as we}from"./chunk-V6XFRZGW.js";import{a as Ee}from"./chunk-GOTAZHJ7.js";import{a as ye}from"./chunk-6NUUBV4I.js";import{a as ge}from"./chunk-HMKSEIRC.js";import{a as Se}from"./chunk-JKRXANFS.js";import{a as Ce}from"./chunk-P4DI7BWX.js";import{a as ve}from"./chunk-A6GCQO25.js";import{h as I}from"./chunk-NFMIVN66.js";import{a as he,b as _e,c as xe,d as be}from"./chunk-AICVXWQ6.js";import{a as pe}from"./chunk-I3SZ5FME.js";import{a as ue}from"./chunk-HYOWEGV7.js";import{a as fe}from"./chunk-3HEW5RTP.js";import{a as de,b as ce}from"./chunk-UKCOEVIY.js";import"./chunk-HDKAZCIU.js";import{$b as V,C as j,Ca as S,Ea as x,F as B,Fa as c,I as L,Ka as G,La as Q,Ma as A,Na as q,Nb as Z,O as f,Oa as s,P as h,Pa as g,Pb as d,Qb as P,Rb as ee,Sa as H,Sb as te,Tb as ie,Ua as D,Va as O,Vb as oe,W as U,Wa as k,Wb as ne,Xb as re,Ya as T,Yb as ae,Zb as se,_b as le,ac as me,ca as m,cb as J,da as u,eb as K,la as w,na as C,rb as X,sa as b,sb as M,ta as W,ua as R,va as z,vb as Y,wa as i,xa as o,ya as _}from"./chunk-OWJSVT4P.js";var E=de.url,y="patrimonios",F=(()=>{let r=class r{constructor(e){this.http=e}index(){return this.http.get(`${E}/${y}`)}find(e){return this.http.get(`${E}/${y}/${e}`)}create(e){return this.http.post(`${E}/${y}`,e)}update(e,t){return this.http.put(`${E}/${y}/${e}`,t)}remove(e){return this.http.delete(`${E}/${y}/${e}`)}disponiveis(){return this.http.get(`${E}/${y}/disponiveis`)}};r.\u0275fac=function(t){return new(t||r)(B(Y))},r.\u0275prov=j({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();function Fe(n,r){if(n&1){let l=S();i(0,"input-select",15),x("ngModelChange",function(){f(l);let t=c();return h(t.getSubunidades())}),o()}if(n&2){let l=c();C("data$",l.unidades$)}}function De(n,r){if(n&1){let l=S();i(0,"input-select",16),x("ngModelChange",function(){f(l);let t=c();return h(t.getSetores())}),o()}if(n&2){let l=c();C("data$",l.subunidades$)}}function Oe(n,r){if(n&1&&_(0,"input-select",4),n&2){let l=c();C("data$",l.setores$)}}var N=(()=>{let r=class r{constructor(e,t,a,p,$,v,Te,Me,Pe){this.formBuilder=e,this.patrimoniosService=t,this.patrimoniosTiposService=a,this.unidadesService=p,this.subunidadesService=$,this.setoresService=v,this.marcasService=Te,this.modelosService=Me,this.toastr=Pe,this.refresh=new U}ngOnInit(){this.form=this.formBuilder.group({id:[null],nome:[null,d.compose([d.minLength(2),d.maxLength(50)])],serial:[null,d.compose([d.minLength(2),d.maxLength(50)])],tombo:[null,d.compose([d.required,d.minLength(2),d.maxLength(50)])],data_baixa:[null],observacoes:[null],unidade:[null,d.compose([d.required])],subunidade:[null,d.compose([d.required])],setor:[null,d.compose([d.required])],patrimonio_tipo:[null,d.compose([d.required])]}),this.marcas$=this.marcasService.marcasArmamentos(),this.patrimoniostipos$=this.patrimoniosTiposService.index(),this.unidades$=this.unidadesService.index()}cadastrar(){delete this.form.value.unidade,delete this.form.value.subunidade,this.form.value.id?this.patrimoniosService.update(this.form.value.id,this.form.value).subscribe({next:e=>{this.toastr.success("Edi\xE7\xE3o realizada com sucesso!"),this.form.reset(),this.refresh.emit()},error:e=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}}):this.patrimoniosService.create(this.form.value).subscribe({next:e=>{this.toastr.success("Cadastro realizado com sucesso!"),this.form.reset(),this.refresh.emit()},error:e=>{this.toastr.error("Erro ao cadastrar, tente novamente mais tarde!")}})}editar(e){this.form.patchValue(e),e.setor&&(this.form.get("setor")?.patchValue(e.setor.id),this.form.get("subunidade")?.patchValue(e.setor.subunidade.id),this.form.get("unidade")?.patchValue(e.setor.subunidade.unidade.id),this.getSubunidades(),this.getSetores()),e.patrimonio_tipo&&this.form.get("patrimonio_tipo")?.patchValue(e.patrimonio_tipo.id)}getSubunidades(){this.subunidades$=this.subunidadesService.whereUnidade(this.form.get("unidade")?.value)}getSetores(){this.setores$=this.setoresService.whereSubunidade(this.form.get("subunidade")?.value)}getModelos(){this.modelos$=this.modelosService.whereMarca(this.form.get("marca")?.value)}};r.\u0275fac=function(t){return new(t||r)(u(le),u(F),u(we),u(Ee),u(ge),u(ye),u(Ce),u(Se),u(I))},r.\u0275cmp=L({type:r,selectors:[["app-patrimonios-form"]],outputs:{refresh:"refresh"},standalone:!0,features:[T],decls:19,vars:6,consts:[[3,"formGroup"],[1,"row"],["label","Unidade","id","unidade","formControlName","unidade",1,"col-sm-2",3,"data$"],["label","Subunidade","id","subunidade","formControlName","subunidade",1,"col-sm-4",3,"data$"],["label","Setor","id","setor","formControlName","setor",1,"col-sm-2",3,"data$"],["label","Tipo","id","patrimonio_tipo","formControlName","patrimonio_tipo",1,"col-sm-2",3,"data$"],["formControlName","nome","label","Descri\xE7\xE3o","id","nome","tipo","text",1,"col-sm-4"],["formControlName","serial","label","Serial","id","serial","tipo","text",1,"col-sm-2"],["formControlName","tombo","label","Tombo","id","tombo","tipo","text",1,"col-sm-2"],["formControlName","data_baixa","label","Data Baixa","id","data_baixa","tipo","date",1,"col-sm-2"],[1,"row",2,"height","350px"],["formControlName","observacoes","label","Observa\xE7\xF5es","id","observacoes",1,"col-sm-12"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-danger",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-primary",3,"click","disabled"],["label","Unidade","id","unidade","formControlName","unidade",1,"col-sm-2",3,"ngModelChange","data$"],["label","Subunidade","id","subunidade","formControlName","subunidade",1,"col-sm-4",3,"ngModelChange","data$"]],template:function(t,a){t&1&&(i(0,"form",0)(1,"div",1),w(2,Fe,1,1,"input-select",2)(3,De,1,1,"input-select",3)(4,Oe,1,1,"input-select",4),o(),i(5,"div",1),_(6,"input-select",5)(7,"input-text",6)(8,"input-text",7)(9,"input-text",8),o(),i(10,"div",1),_(11,"input-text",9),o(),i(12,"div",10),_(13,"input-textarea",11),o(),i(14,"div",12)(15,"a",13),x("click",function(){return a.form.reset()}),s(16,"Cancelar"),o(),i(17,"button",14),x("click",function(){return a.cadastrar()}),s(18," Cadastrar "),o()()()),t&2&&(C("formGroup",a.form),m(2),b(2,a.unidades$?2:-1),m(),b(3,a.subunidades$?3:-1),m(),b(4,a.setores$?4:-1),m(2),C("data$",a.patrimoniostipos$),m(11),C("disabled",a.form.invalid))},dependencies:[M,V,ie,P,ee,me,oe,ne,ue,pe,ve]});let n=r;return n})();function ke(n,r){n&1&&(i(0,"button",7),_(1,"i",38),o())}function Ne(n,r){if(n&1){let l=S();i(0,"a",42),x("click",function(){f(l);let t=c().$implicit,a=c(2);return h(a.editar(t))}),_(1,"i",43),o()}}function je(n,r){if(n&1){let l=S();i(0,"a",44),x("click",function(){f(l);let t=c().$implicit,a=c(2);return h(a.delete(t))}),_(1,"i",45),o()}}function Be(n,r){if(n&1&&(i(0,"tr",39)(1,"td"),s(2),o(),i(3,"td"),s(4),o(),i(5,"td"),s(6),o(),i(7,"td"),s(8),o(),i(9,"td"),s(10),o(),i(11,"td"),s(12),o(),i(13,"td"),s(14),J(15,"date"),o(),i(16,"td"),w(17,Ne,2,0,"a",40)(18,je,2,0,"a",41),o()()),n&2){let l=r.$implicit,e=c(2);m(2),g(l.id),m(2),H("",l.setor.nome," - ",l.setor.subunidade.abreviatura," - ",l.setor.subunidade.unidade.abreviatura,""),m(2),g(l.patrimonio_tipo.nome),m(2),g(l.nome),m(2),g(l.serial),m(2),g(l.tombo),m(2),g(K(15,11,l.data_baixa,"dd/MM/yyyy")),m(3),b(17,e.user.perfil.patrimonios_edt?17:-1),m(),b(18,e.user.perfil.patrimonios_del?18:-1)}}function Ue(n,r){n&1&&(i(0,"tr")(1,"td",25),s(2,"Sem informa\xE7\xE3o"),o()())}function We(n,r){if(n&1&&(i(0,"tbody"),R(1,Be,19,14,"tr",39,W,!1,Ue,3,0,"tr"),o()),n&2){c();let l=q(21);m(),z(l.data)}}function Re(n,r){if(n&1){let l=S();s(0," Tem certeza que deseja excluir: "),i(1,"b"),s(2),o(),i(3,"div",46)(4,"a",47),s(5,"Cancelar"),o(),i(6,"button",48),x("click",function(){f(l);let t=c();return h(t.confirm())}),s(7," Excluir "),o()()}if(n&2){let l=c();m(2),g(l.excluir.serial)}}var ft=(()=>{let r=class r{constructor(e,t,a){this.patrimoniosService=e,this.toastr=t,this.sessionService=a,this.quant=10}ngOnInit(){this.user=this.sessionService.getUser(),this.sessionService.checkPermission("patrimonios"),this.subscription=this.patrimoniosService.index().subscribe({next:e=>{this.data$=e,this.temp=e}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}refresh(){this.patrimoniosService.index().subscribe({next:e=>{this.data$=e}})}editar(e){this.child.editar(e)}delete(e){this.excluir=e}confirm(){this.patrimoniosService.remove(this.excluir.id||0).subscribe({next:e=>{this.toastr.success("Exclus\xE3o realizada com sucesso!"),this.refresh()},error:e=>{this.toastr.error("Erro ao excluir, tente novamente mais tarde!")}})}pesquisar(){if(this.data$=this.temp,this.pesquisa.length>0){var e=this.pesquisa.toLocaleLowerCase();this.data$=this.data$.filter(t=>t.nome&&t.serial?t.nome.toLocaleLowerCase().indexOf(e)!==-1||t.serial.toLocaleLowerCase().indexOf(e)!==-1||t.tombo.toLocaleLowerCase().indexOf(e)!==-1||t.setor.nome.toLocaleLowerCase().indexOf(e)!==-1||t.patrimonio_tipo.nome.toLocaleLowerCase().indexOf(e)!==-1||!e:t.nome?t.nome.toLocaleLowerCase().indexOf(e)!==-1||t.tombo.toLocaleLowerCase().indexOf(e)!==-1||t.setor.nome.toLocaleLowerCase().indexOf(e)!==-1||t.patrimonio_tipo.nome.toLocaleLowerCase().indexOf(e)!==-1||!e:t.serial?t.serial.toLocaleLowerCase().indexOf(e)!==-1||t.tombo.toLocaleLowerCase().indexOf(e)!==-1||t.setor.nome.toLocaleLowerCase().indexOf(e)!==-1||t.patrimonio_tipo.nome.toLocaleLowerCase().indexOf(e)!==-1||!e:t.tombo.toLocaleLowerCase().indexOf(e)!==-1||t.setor.nome.toLocaleLowerCase().indexOf(e)!==-1||t.patrimonio_tipo.nome.toLocaleLowerCase().indexOf(e)!==-1||!e)}}};r.\u0275fac=function(t){return new(t||r)(u(F),u(I),u(ce))},r.\u0275cmp=L({type:r,selectors:[["app-patrimonios"]],viewQuery:function(t,a){if(t&1&&G(N,5),t&2){let p;Q(p=A())&&(a.child=p.first)}},standalone:!0,features:[T],decls:75,vars:7,consts:[["mf","mfDataTable"],[1,"content-wrapper"],["titulo","Patrim\xF4nios"],[1,"content"],[1,"card"],[1,"card-header","border-0"],[1,"card-title"],["data-bs-toggle","modal","data-bs-target","#modalcad","title","Cadastrar",1,"btn","btn-outline-primary"],[1,"card-tools"],[1,"input-group","input-group-sm",2,"width","250px"],[1,"form-control","float-right",2,"width","50px",3,"ngModelChange","ngModel"],["value","10"],["value","25"],["value","50"],["value","100"],["type","text","name","table_search","placeholder","Pesquisar...",1,"form-control","float-right",2,"width","200px",3,"ngModelChange","ngModel"],[1,"card-body","table-responsive","p-1"],[1,"table","table-hover","table-head-fixed","text-nowrap",3,"mfData","mfRowsOnPage"],["by","id"],["by","setor.nome"],["by","patrimonios_tipo.nome"],["by","nome"],["by","serial"],["by","tombo"],["by","data_baixa"],["colspan","100%"],[2,"display","flex","align-items","center","justify-content","center"],["id","modalcad","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog","modal-xl"],[1,"modal-content"],[1,"modal-header","border-0"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"refresh"],["id","modaldel","aria-hidden","true",1,"modal","fade",2,"display","none"],[1,"modal-dialog"],[1,"fa","fa-plus"],[1,"optionshover"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point"],["title","Editar","data-bs-toggle","modal","data-bs-target","#modalcad",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-edit","text-primary"],["title","Excluir","data-bs-toggle","modal","data-bs-target","#modaldel",1,"options","point",3,"click"],["aria-hidden","true",1,"fa","fa-trash","text-danger","ml-1"],[1,"d-flex","justify-content-end"],["data-bs-dismiss","modal",1,"btn","btn-link","text-primary"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger",3,"click"]],template:function(t,a){if(t&1){let p=S();i(0,"div",1),_(1,"app-title",2),i(2,"section",3)(3,"div",4)(4,"div",5)(5,"h3",6),w(6,ke,2,0,"button",7),o(),i(7,"div",8)(8,"div",9)(9,"select",10),k("ngModelChange",function(v){return f(p),O(a.quant,v)||(a.quant=v),h(v)}),i(10,"option",11),s(11,"10"),o(),i(12,"option",12),s(13,"25"),o(),i(14,"option",13),s(15,"50"),o(),i(16,"option",14),s(17,"100"),o()(),i(18,"input",15),k("ngModelChange",function(v){return f(p),O(a.pesquisa,v)||(a.pesquisa=v),h(v)}),x("ngModelChange",function(){return f(p),h(a.pesquisar())}),o()()()(),i(19,"div",16)(20,"table",17,0)(22,"thead")(23,"tr")(24,"th")(25,"mfDefaultSorter",18),s(26,"#"),o()(),i(27,"th")(28,"mfDefaultSorter",19),s(29,"Setor"),o()(),i(30,"th")(31,"mfDefaultSorter",20),s(32,"Tipo"),o()(),i(33,"th")(34,"mfDefaultSorter",21),s(35,"Descri\xE7\xE3o"),o()(),i(36,"th")(37,"mfDefaultSorter",22),s(38,"Serial"),o()(),i(39,"th")(40,"mfDefaultSorter",23),s(41,"Tombo"),o()(),i(42,"th")(43,"mfDefaultSorter",24),s(44,"Dt. Baixa"),o()(),i(45,"th"),s(46,"Op\xE7\xF5es"),o()()(),w(47,We,4,1,"tbody"),i(48,"tfoot")(49,"tr")(50,"td",25)(51,"div",26),_(52,"mfBootstrapPaginator"),o()()()()()()()(),i(53,"div",27)(54,"div",28)(55,"div",29)(56,"div",30)(57,"h4",31),s(58,"Cadastrar"),o(),i(59,"button",32)(60,"span",33),s(61,"\xD7"),o()()(),i(62,"div",34)(63,"app-patrimonios-form",35),x("refresh",function(){return f(p),h(a.refresh())}),o()()()()(),i(64,"div",36)(65,"div",37)(66,"div",29)(67,"div",30)(68,"h4",31),s(69,"Excluir"),o(),i(70,"button",32)(71,"span",33),s(72,"\xD7"),o()()(),i(73,"div",34),w(74,Re,8,1),o()()()()()}t&2&&(m(6),b(6,a.user.perfil.patrimonios_cad?6:-1),m(3),D("ngModel",a.quant),m(9),D("ngModel",a.pesquisa),m(2),C("mfData",a.data$)("mfRowsOnPage",a.quant),m(27),b(47,a.data$?47:-1),m(27),b(74,a.excluir?74:-1))},dependencies:[M,X,fe,N,be,he,xe,_e,V,ae,se,Z,re,P,te]});let n=r;return n})();export{ft as PatrimoniosComponent};
